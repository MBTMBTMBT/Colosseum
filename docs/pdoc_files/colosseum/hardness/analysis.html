<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 12.2.0"/>
    <title>colosseum.hardness.analysis API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent }nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .pdoc-alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:1rem center;margin-bottom:1rem;}.pdoc .pdoc-alert > *:last-child{margin-bottom:0;}.pdoc .pdoc-alert-note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--code);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style><script>
    window.MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\\(', '\\)']]
        }
    };
</script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script>
    /* Re-invoke MathJax when DOM content changes, for example during search. */
    document.addEventListener("DOMContentLoaded", () => {
        new MutationObserver(() => MathJax.typeset()).observe(
            document.querySelector("main.pdoc").parentNode,
            {childList: true}
        );
    })
</script></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../hardness.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;colosseum.hardness</a>

<a href="../intro.html">            <img src="https://raw.githubusercontent.com/MichelangeloConserva/Colosseum/ff24d5ab71602dd2185b3e932f732900822c5300/imgs/colosseum_banner.svg" class="logo" alt="project logo"/>
</a>
            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>



        <h2>API Documentation</h2>
            <ul class="memberlist">
            <li>
                    <a class="class" href="#SingleInstanceHyperOptConfig">SingleInstanceHyperOptConfig</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#SingleInstanceHyperOptConfig.__init__">SingleInstanceHyperOptConfig</a>
                        </li>
                        <li>
                                <a class="variable" href="#SingleInstanceHyperOptConfig.mdp_class">mdp_class</a>
                        </li>
                        <li>
                                <a class="variable" href="#SingleInstanceHyperOptConfig.mdp_parameters">mdp_parameters</a>
                        </li>
                        <li>
                                <a class="variable" href="#SingleInstanceHyperOptConfig.n_seed">n_seed</a>
                        </li>
                        <li>
                                <a class="variable" href="#SingleInstanceHyperOptConfig.optimization_horizon">optimization_horizon</a>
                        </li>
                        <li>
                                <a class="variable" href="#SingleInstanceHyperOptConfig.num_samples">num_samples</a>
                        </li>
                        <li>
                                <a class="variable" href="#SingleInstanceHyperOptConfig.max_interaction_s">max_interaction_s</a>
                        </li>
                        <li>
                                <a class="variable" href="#SingleInstanceHyperOptConfig.log_every">log_every</a>
                        </li>
                        <li>
                                <a class="class" href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class">SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class</a>
                        </li>
                        <li>
                                <a class="class" href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class">SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#HardnessAnalysisParams">HardnessAnalysisParams</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#HardnessAnalysisParams.__init__">HardnessAnalysisParams</a>
                        </li>
                        <li>
                                <a class="variable" href="#HardnessAnalysisParams.mdp_class">mdp_class</a>
                        </li>
                        <li>
                                <a class="variable" href="#HardnessAnalysisParams.varying_params_name">varying_params_name</a>
                        </li>
                        <li>
                                <a class="variable" href="#HardnessAnalysisParams.varying_params_values">varying_params_values</a>
                        </li>
                        <li>
                                <a class="variable" href="#HardnessAnalysisParams.fixed_params">fixed_params</a>
                        </li>
                        <li>
                                <a class="variable" href="#HardnessAnalysisParams.n_seeds_mdp">n_seeds_mdp</a>
                        </li>
                        <li>
                                <a class="variable" href="#HardnessAnalysisParams.hardness_measures">hardness_measures</a>
                        </li>
                        <li>
                                <a class="variable" href="#HardnessAnalysisParams.near_optimal_agent_hyperopt_config">near_optimal_agent_hyperopt_config</a>
                        </li>
                        <li>
                                <a class="variable" href="#HardnessAnalysisParams.varying_params_name_clean">varying_params_name_clean</a>
                        </li>
                        <li>
                                <a class="variable" href="#HardnessAnalysisParams.retrieve_from_cache">retrieve_from_cache</a>
                        </li>
                        <li>
                                <a class="variable" href="#HardnessAnalysisParams.clean_varying_prm_name">clean_varying_prm_name</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="function" href="#run_scenario_analysis">run_scenario_analysis</a>
            </li>
            <li>
                    <a class="function" href="#get_varying_parameter_dfs">get_varying_parameter_dfs</a>
            </li>
            <li>
                    <a class="function" href="#compute_hardness_measure_for_varying_prm">compute_hardness_measure_for_varying_prm</a>
            </li>
            <li>
                    <a class="function" href="#compute_hardness_measure">compute_hardness_measure</a>
            </li>
    </ul>


            <footer>By Michelangelo Conserva.</footer>

        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
<a href="./../../colosseum.html">colosseum</a><wbr>.<a href="./../hardness.html">hardness</a><wbr>.analysis    </h1>

                
                        <input id="mod-analysis-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-analysis-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">  1</span></a><span class="kn">import</span> <span class="nn">os</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">  2</span></a><span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">deepcopy</span>
</span><span id="L-3"><a href="#L-3"><span class="linenos">  3</span></a><span class="kn">from</span> <span class="nn">dataclasses</span> <span class="kn">import</span> <span class="n">dataclass</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos">  4</span></a><span class="kn">from</span> <span class="nn">multiprocessing</span> <span class="kn">import</span> <span class="n">Pool</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos">  5</span></a><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="p">(</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos">  6</span></a>    <span class="n">TYPE_CHECKING</span><span class="p">,</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos">  7</span></a>    <span class="n">Any</span><span class="p">,</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos">  8</span></a>    <span class="n">Dict</span><span class="p">,</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos">  9</span></a>    <span class="n">Iterable</span><span class="p">,</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos"> 10</span></a>    <span class="n">Type</span><span class="p">,</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos"> 11</span></a>    <span class="n">Tuple</span><span class="p">,</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos"> 12</span></a>    <span class="n">Callable</span><span class="p">,</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos"> 13</span></a>    <span class="n">Union</span><span class="p">,</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos"> 14</span></a>    <span class="n">Collection</span><span class="p">,</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos"> 15</span></a><span class="p">)</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos"> 16</span></a>
</span><span id="L-17"><a href="#L-17"><span class="linenos"> 17</span></a><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos"> 18</span></a><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
</span><span id="L-19"><a href="#L-19"><span class="linenos"> 19</span></a><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos"> 20</span></a>
</span><span id="L-21"><a href="#L-21"><span class="linenos"> 21</span></a><span class="kn">from</span> <span class="nn">colosseum</span> <span class="kn">import</span> <span class="n">config</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos"> 22</span></a><span class="kn">from</span> <span class="nn">colosseum.agent.agents.episodic</span> <span class="kn">import</span> <span class="n">PSRLEpisodic</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos"> 23</span></a><span class="kn">from</span> <span class="nn">colosseum.agent.agents.infinite_horizon</span> <span class="kn">import</span> <span class="n">UCRL2Continuous</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos"> 24</span></a><span class="kn">from</span> <span class="nn">colosseum.mdp.base</span> <span class="kn">import</span> <span class="n">BaseMDP</span>
</span><span id="L-25"><a href="#L-25"><span class="linenos"> 25</span></a>
</span><span id="L-26"><a href="#L-26"><span class="linenos"> 26</span></a><span class="n">sns</span><span class="o">.</span><span class="n">set_theme</span><span class="p">()</span>
</span><span id="L-27"><a href="#L-27"><span class="linenos"> 27</span></a>
</span><span id="L-28"><a href="#L-28"><span class="linenos"> 28</span></a><span class="k">if</span> <span class="n">TYPE_CHECKING</span><span class="p">:</span>
</span><span id="L-29"><a href="#L-29"><span class="linenos"> 29</span></a>    <span class="kn">from</span> <span class="nn">colosseum.agent.agents.base</span> <span class="kn">import</span> <span class="n">BaseAgent</span>
</span><span id="L-30"><a href="#L-30"><span class="linenos"> 30</span></a>
</span><span id="L-31"><a href="#L-31"><span class="linenos"> 31</span></a>
</span><span id="L-32"><a href="#L-32"><span class="linenos"> 32</span></a><span class="nd">@dataclass</span><span class="p">()</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos"> 33</span></a><span class="k">class</span> <span class="nc">SingleInstanceHyperOptConfig</span><span class="p">:</span>
</span><span id="L-34"><a href="#L-34"><span class="linenos"> 34</span></a>    <span class="n">mdp_class</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="s2">&quot;BaseMDP&quot;</span><span class="p">]</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos"> 35</span></a>    <span class="sd">&quot;&quot;&quot;The class of the MDP with respect to whom we are performing the parameters optimization.&quot;&quot;&quot;</span>
</span><span id="L-36"><a href="#L-36"><span class="linenos"> 36</span></a>    <span class="n">mdp_parameters</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
</span><span id="L-37"><a href="#L-37"><span class="linenos"> 37</span></a>    <span class="sd">&quot;&quot;&quot;The dictionary containing the parameters for the MDP class with respect to whom we are performing the parameters optimization.&quot;&quot;&quot;</span>
</span><span id="L-38"><a href="#L-38"><span class="linenos"> 38</span></a>    <span class="n">n_seed</span><span class="p">:</span> <span class="nb">int</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos"> 39</span></a>    <span class="sd">&quot;&quot;&quot;The number of seed the agent/MDP interaction is repeated.&quot;&quot;&quot;</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos"> 40</span></a>    <span class="n">optimization_horizon</span><span class="p">:</span> <span class="nb">int</span>
</span><span id="L-41"><a href="#L-41"><span class="linenos"> 41</span></a>    <span class="sd">&quot;&quot;&quot;The optimization horizon of the agent/MDP interaction.&quot;&quot;&quot;</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos"> 42</span></a>    <span class="n">num_samples</span><span class="p">:</span> <span class="nb">int</span>
</span><span id="L-43"><a href="#L-43"><span class="linenos"> 43</span></a>    <span class="sd">&quot;&quot;&quot;The number of samples of the agent parameters.&quot;&quot;&quot;</span>
</span><span id="L-44"><a href="#L-44"><span class="linenos"> 44</span></a>    <span class="n">max_interaction_s</span><span class="p">:</span> <span class="nb">float</span>
</span><span id="L-45"><a href="#L-45"><span class="linenos"> 45</span></a>    <span class="sd">&quot;&quot;&quot;The maximum amount of seconds allocated to training the agent.&quot;&quot;&quot;</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos"> 46</span></a>    <span class="n">log_every</span><span class="p">:</span> <span class="nb">int</span>
</span><span id="L-47"><a href="#L-47"><span class="linenos"> 47</span></a>    <span class="sd">&quot;&quot;&quot;The length of the interval between logging of the performance indicators.&quot;&quot;&quot;</span>
</span><span id="L-48"><a href="#L-48"><span class="linenos"> 48</span></a>    <span class="n">episodic_near_optimal_agent_class</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="s2">&quot;BaseAgent&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">PSRLEpisodic</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos"> 49</span></a>    <span class="sd">&quot;&quot;&quot;The class of the near optimal agent for the episodic setting. By default, it is ``PSRLEpisodic``.&quot;&quot;&quot;</span>
</span><span id="L-50"><a href="#L-50"><span class="linenos"> 50</span></a>    <span class="n">continuous_near_optimal_agent_class</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="s2">&quot;BaseAgent&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">UCRL2Continuous</span>
</span><span id="L-51"><a href="#L-51"><span class="linenos"> 51</span></a>    <span class="sd">&quot;&quot;&quot;The class of the near optimal agent for the continuous setting. By default, it is ``UCRL2Continuous``.&quot;&quot;&quot;</span>
</span><span id="L-52"><a href="#L-52"><span class="linenos"> 52</span></a>
</span><span id="L-53"><a href="#L-53"><span class="linenos"> 53</span></a>
</span><span id="L-54"><a href="#L-54"><span class="linenos"> 54</span></a><span class="nd">@dataclass</span><span class="p">()</span>
</span><span id="L-55"><a href="#L-55"><span class="linenos"> 55</span></a><span class="k">class</span> <span class="nc">HardnessAnalysisParams</span><span class="p">:</span>
</span><span id="L-56"><a href="#L-56"><span class="linenos"> 56</span></a>    <span class="n">mdp_class</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="s2">&quot;BaseMDP&quot;</span><span class="p">]</span>
</span><span id="L-57"><a href="#L-57"><span class="linenos"> 57</span></a>    <span class="sd">&quot;&quot;&quot;The class of the MDP whose hardness we are studying.&quot;&quot;&quot;</span>
</span><span id="L-58"><a href="#L-58"><span class="linenos"> 58</span></a>    <span class="n">varying_params_name</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="L-59"><a href="#L-59"><span class="linenos"> 59</span></a>    <span class="sd">&quot;&quot;&quot;The name of the parameter being varied.&quot;&quot;&quot;</span>
</span><span id="L-60"><a href="#L-60"><span class="linenos"> 60</span></a>    <span class="n">varying_params_values</span><span class="p">:</span> <span class="n">Iterable</span>
</span><span id="L-61"><a href="#L-61"><span class="linenos"> 61</span></a>    <span class="sd">&quot;&quot;&quot;The values of the parameter being varied.&quot;&quot;&quot;</span>
</span><span id="L-62"><a href="#L-62"><span class="linenos"> 62</span></a>    <span class="n">fixed_params</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
</span><span id="L-63"><a href="#L-63"><span class="linenos"> 63</span></a>    <span class="sd">&quot;&quot;&quot;The dictionary containing the names and values for the parameters being kept fixed.&quot;&quot;&quot;</span>
</span><span id="L-64"><a href="#L-64"><span class="linenos"> 64</span></a>    <span class="n">n_seeds_mdp</span><span class="p">:</span> <span class="nb">int</span>
</span><span id="L-65"><a href="#L-65"><span class="linenos"> 65</span></a>    <span class="sd">&quot;&quot;&quot;The number of seeds used when instantiating the MDP.&quot;&quot;&quot;</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos"> 66</span></a>    <span class="n">hardness_measures</span><span class="p">:</span> <span class="n">Collection</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Type</span><span class="p">[</span><span class="s2">&quot;BaseMDP&quot;</span><span class="p">]],</span> <span class="nb">float</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-67"><a href="#L-67"><span class="linenos"> 67</span></a>        <span class="s2">&quot;diameter&quot;</span><span class="p">,</span>
</span><span id="L-68"><a href="#L-68"><span class="linenos"> 68</span></a>        <span class="s2">&quot;value_norm&quot;</span><span class="p">,</span>
</span><span id="L-69"><a href="#L-69"><span class="linenos"> 69</span></a>    <span class="p">)</span>
</span><span id="L-70"><a href="#L-70"><span class="linenos"> 70</span></a>    <span class="sd">&quot;&quot;&quot;An iterable containing either the code name of an available measure of hardness or a function that takes an MDP</span>
</span><span id="L-71"><a href="#L-71"><span class="linenos"> 71</span></a><span class="sd">    object as input and returns a value.&quot;&quot;&quot;</span>
</span><span id="L-72"><a href="#L-72"><span class="linenos"> 72</span></a>    <span class="n">near_optimal_agent_hyperopt_config</span><span class="p">:</span> <span class="n">SingleInstanceHyperOptConfig</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-73"><a href="#L-73"><span class="linenos"> 73</span></a>    <span class="sd">&quot;&quot;&quot;The parameters optimization configuration for the near optimal agent. By default, it is None, which means</span>
</span><span id="L-74"><a href="#L-74"><span class="linenos"> 74</span></a><span class="sd">    that the regret of the near optimal agent with tuned parameters is not computed and used as proxy for a </span>
</span><span id="L-75"><a href="#L-75"><span class="linenos"> 75</span></a><span class="sd">    complete measure of hardness.&quot;&quot;&quot;</span>
</span><span id="L-76"><a href="#L-76"><span class="linenos"> 76</span></a>    <span class="n">varying_params_name_clean</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos"> 77</span></a>    <span class="sd">&quot;&quot;&quot;The name of the parameter being varied in a clean format.&quot;&quot;&quot;</span>
</span><span id="L-78"><a href="#L-78"><span class="linenos"> 78</span></a>    <span class="n">retrieve_from_cache</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos"> 79</span></a>    <span class="sd">&quot;&quot;&quot;If ture, the ``config.get_hardness_measures_cache_folder()`` is searched for a cached value of the measure.</span>
</span><span id="L-80"><a href="#L-80"><span class="linenos"> 80</span></a><span class="sd">    By default, it is True.&quot;&quot;&quot;</span>
</span><span id="L-81"><a href="#L-81"><span class="linenos"> 81</span></a>
</span><span id="L-82"><a href="#L-82"><span class="linenos"> 82</span></a>    <span class="nd">@property</span>
</span><span id="L-83"><a href="#L-83"><span class="linenos"> 83</span></a>    <span class="k">def</span> <span class="nf">clean_varying_prm_name</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-84"><a href="#L-84"><span class="linenos"> 84</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-85"><a href="#L-85"><span class="linenos"> 85</span></a><span class="sd">        Returns</span>
</span><span id="L-86"><a href="#L-86"><span class="linenos"> 86</span></a><span class="sd">        -------</span>
</span><span id="L-87"><a href="#L-87"><span class="linenos"> 87</span></a><span class="sd">        str</span>
</span><span id="L-88"><a href="#L-88"><span class="linenos"> 88</span></a><span class="sd">            A nicely formatted name for the varying parameter.</span>
</span><span id="L-89"><a href="#L-89"><span class="linenos"> 89</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-90"><a href="#L-90"><span class="linenos"> 90</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">varying_params_name_clean</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-91"><a href="#L-91"><span class="linenos"> 91</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">varying_params_name</span>
</span><span id="L-92"><a href="#L-92"><span class="linenos"> 92</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">varying_params_name_clean</span>
</span><span id="L-93"><a href="#L-93"><span class="linenos"> 93</span></a>
</span><span id="L-94"><a href="#L-94"><span class="linenos"> 94</span></a>
</span><span id="L-95"><a href="#L-95"><span class="linenos"> 95</span></a><span class="k">def</span> <span class="nf">run_scenario_analysis</span><span class="p">(</span>
</span><span id="L-96"><a href="#L-96"><span class="linenos"> 96</span></a>    <span class="n">hap</span><span class="p">:</span> <span class="n">HardnessAnalysisParams</span><span class="p">,</span>
</span><span id="L-97"><a href="#L-97"><span class="linenos"> 97</span></a>    <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-98"><a href="#L-98"><span class="linenos"> 98</span></a><span class="p">):</span>
</span><span id="L-99"><a href="#L-99"><span class="linenos"> 99</span></a>    <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-100"><a href="#L-100"><span class="linenos">100</span></a><span class="sd">    runs a hardness analysis scenario.</span>
</span><span id="L-101"><a href="#L-101"><span class="linenos">101</span></a>
</span><span id="L-102"><a href="#L-102"><span class="linenos">102</span></a><span class="sd">    Parameters</span>
</span><span id="L-103"><a href="#L-103"><span class="linenos">103</span></a><span class="sd">    ----------</span>
</span><span id="L-104"><a href="#L-104"><span class="linenos">104</span></a><span class="sd">    hap : HardnessAnalysisParams</span>
</span><span id="L-105"><a href="#L-105"><span class="linenos">105</span></a><span class="sd">        The hardness analysis scenario to run.</span>
</span><span id="L-106"><a href="#L-106"><span class="linenos">106</span></a><span class="sd">    ax : plt.Axes</span>
</span><span id="L-107"><a href="#L-107"><span class="linenos">107</span></a><span class="sd">        The ax object where the plot will be put. By default, a new axis is created.</span>
</span><span id="L-108"><a href="#L-108"><span class="linenos">108</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-109"><a href="#L-109"><span class="linenos">109</span></a>
</span><span id="L-110"><a href="#L-110"><span class="linenos">110</span></a>    <span class="n">show</span> <span class="o">=</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span>
</span><span id="L-111"><a href="#L-111"><span class="linenos">111</span></a>    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-112"><a href="#L-112"><span class="linenos">112</span></a>        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
</span><span id="L-113"><a href="#L-113"><span class="linenos">113</span></a>
</span><span id="L-114"><a href="#L-114"><span class="linenos">114</span></a>    <span class="n">dfs</span> <span class="o">=</span> <span class="n">get_varying_parameter_dfs</span><span class="p">(</span><span class="n">hap</span><span class="p">,</span> <span class="n">normalize_measures</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-115"><a href="#L-115"><span class="linenos">115</span></a>
</span><span id="L-116"><a href="#L-116"><span class="linenos">116</span></a>    <span class="k">for</span> <span class="n">measure_name</span><span class="p">,</span> <span class="n">df</span> <span class="ow">in</span> <span class="n">dfs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="L-117"><a href="#L-117"><span class="linenos">117</span></a>        <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span>
</span><span id="L-118"><a href="#L-118"><span class="linenos">118</span></a>            <span class="n">x</span><span class="o">=</span><span class="n">hap</span><span class="o">.</span><span class="n">clean_varying_prm_name</span><span class="p">,</span>
</span><span id="L-119"><a href="#L-119"><span class="linenos">119</span></a>            <span class="n">y</span><span class="o">=</span><span class="n">measure_name</span><span class="p">,</span>
</span><span id="L-120"><a href="#L-120"><span class="linenos">120</span></a>            <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
</span><span id="L-121"><a href="#L-121"><span class="linenos">121</span></a>            <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
</span><span id="L-122"><a href="#L-122"><span class="linenos">122</span></a>            <span class="n">label</span><span class="o">=</span><span class="n">measure_name</span><span class="p">,</span>
</span><span id="L-123"><a href="#L-123"><span class="linenos">123</span></a>        <span class="p">)</span>
</span><span id="L-124"><a href="#L-124"><span class="linenos">124</span></a>    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Hardness measure value&quot;</span><span class="p">)</span>
</span><span id="L-125"><a href="#L-125"><span class="linenos">125</span></a>    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</span><span id="L-126"><a href="#L-126"><span class="linenos">126</span></a>
</span><span id="L-127"><a href="#L-127"><span class="linenos">127</span></a>    <span class="k">if</span> <span class="n">show</span><span class="p">:</span>
</span><span id="L-128"><a href="#L-128"><span class="linenos">128</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span><span id="L-129"><a href="#L-129"><span class="linenos">129</span></a>
</span><span id="L-130"><a href="#L-130"><span class="linenos">130</span></a>
</span><span id="L-131"><a href="#L-131"><span class="linenos">131</span></a><span class="k">def</span> <span class="nf">get_varying_parameter_dfs</span><span class="p">(</span>
</span><span id="L-132"><a href="#L-132"><span class="linenos">132</span></a>    <span class="n">hap</span><span class="p">:</span> <span class="n">HardnessAnalysisParams</span><span class="p">,</span>
</span><span id="L-133"><a href="#L-133"><span class="linenos">133</span></a>    <span class="n">normalize_measures</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="L-134"><a href="#L-134"><span class="linenos">134</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]:</span>
</span><span id="L-135"><a href="#L-135"><span class="linenos">135</span></a>    <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-136"><a href="#L-136"><span class="linenos">136</span></a><span class="sd">    computes the hardness measures for the scenarios and stored them in a `pd.DataFrame`s.</span>
</span><span id="L-137"><a href="#L-137"><span class="linenos">137</span></a>
</span><span id="L-138"><a href="#L-138"><span class="linenos">138</span></a><span class="sd">    Parameters</span>
</span><span id="L-139"><a href="#L-139"><span class="linenos">139</span></a><span class="sd">    ----------</span>
</span><span id="L-140"><a href="#L-140"><span class="linenos">140</span></a><span class="sd">    hap : HardnessAnalysisParams</span>
</span><span id="L-141"><a href="#L-141"><span class="linenos">141</span></a><span class="sd">        The hardness analysis scenario to run.</span>
</span><span id="L-142"><a href="#L-142"><span class="linenos">142</span></a><span class="sd">    normalize_measures : bool</span>
</span><span id="L-143"><a href="#L-143"><span class="linenos">143</span></a><span class="sd">        If True, the values of the hardness measures are normalized.</span>
</span><span id="L-144"><a href="#L-144"><span class="linenos">144</span></a>
</span><span id="L-145"><a href="#L-145"><span class="linenos">145</span></a><span class="sd">    Returns</span>
</span><span id="L-146"><a href="#L-146"><span class="linenos">146</span></a><span class="sd">    -------</span>
</span><span id="L-147"><a href="#L-147"><span class="linenos">147</span></a><span class="sd">    Dict[str, pd.DataFrame]</span>
</span><span id="L-148"><a href="#L-148"><span class="linenos">148</span></a><span class="sd">        A dictionary that associated the name of a hardness measure to its corresponding pd.DataFrame.</span>
</span><span id="L-149"><a href="#L-149"><span class="linenos">149</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-150"><a href="#L-150"><span class="linenos">150</span></a>
</span><span id="L-151"><a href="#L-151"><span class="linenos">151</span></a>    <span class="k">if</span> <span class="n">hap</span><span class="o">.</span><span class="n">near_optimal_agent_hyperopt_config</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-152"><a href="#L-152"><span class="linenos">152</span></a>        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
</span><span id="L-153"><a href="#L-153"><span class="linenos">153</span></a>            <span class="s2">&quot;The computation of the regret of the near optimal agent as a proxy for a complete measure of hardness is &quot;</span>
</span><span id="L-154"><a href="#L-154"><span class="linenos">154</span></a>            <span class="s2">&quot;being refactored at the moment.&quot;</span>
</span><span id="L-155"><a href="#L-155"><span class="linenos">155</span></a>        <span class="p">)</span>
</span><span id="L-156"><a href="#L-156"><span class="linenos">156</span></a>
</span><span id="L-157"><a href="#L-157"><span class="linenos">157</span></a>    <span class="n">measure_results</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</span><span id="L-158"><a href="#L-158"><span class="linenos">158</span></a>    <span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">get_available_cores</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-159"><a href="#L-159"><span class="linenos">159</span></a>        <span class="n">inputs</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-160"><a href="#L-160"><span class="linenos">160</span></a>            <span class="p">(</span>
</span><span id="L-161"><a href="#L-161"><span class="linenos">161</span></a>                <span class="n">hap</span><span class="o">.</span><span class="n">mdp_class</span><span class="p">,</span>
</span><span id="L-162"><a href="#L-162"><span class="linenos">162</span></a>                <span class="n">hap</span><span class="o">.</span><span class="n">fixed_params</span><span class="p">,</span>
</span><span id="L-163"><a href="#L-163"><span class="linenos">163</span></a>                <span class="n">hap</span><span class="o">.</span><span class="n">varying_params_name</span><span class="p">,</span>
</span><span id="L-164"><a href="#L-164"><span class="linenos">164</span></a>                <span class="n">varying_value</span><span class="p">,</span>
</span><span id="L-165"><a href="#L-165"><span class="linenos">165</span></a>                <span class="n">seed</span><span class="p">,</span>
</span><span id="L-166"><a href="#L-166"><span class="linenos">166</span></a>                <span class="n">measure</span><span class="p">,</span>
</span><span id="L-167"><a href="#L-167"><span class="linenos">167</span></a>                <span class="n">hap</span><span class="o">.</span><span class="n">retrieve_from_cache</span><span class="p">,</span>
</span><span id="L-168"><a href="#L-168"><span class="linenos">168</span></a>            <span class="p">)</span>
</span><span id="L-169"><a href="#L-169"><span class="linenos">169</span></a>            <span class="k">for</span> <span class="n">varying_value</span> <span class="ow">in</span> <span class="n">hap</span><span class="o">.</span><span class="n">varying_params_values</span>
</span><span id="L-170"><a href="#L-170"><span class="linenos">170</span></a>            <span class="k">for</span> <span class="n">measure</span> <span class="ow">in</span> <span class="n">hap</span><span class="o">.</span><span class="n">hardness_measures</span>
</span><span id="L-171"><a href="#L-171"><span class="linenos">171</span></a>            <span class="k">for</span> <span class="n">seed</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">hap</span><span class="o">.</span><span class="n">n_seeds_mdp</span><span class="p">)</span>
</span><span id="L-172"><a href="#L-172"><span class="linenos">172</span></a>        <span class="p">]</span>
</span><span id="L-173"><a href="#L-173"><span class="linenos">173</span></a>
</span><span id="L-174"><a href="#L-174"><span class="linenos">174</span></a>        <span class="k">with</span> <span class="n">Pool</span><span class="p">(</span><span class="n">processes</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">get_available_cores</span><span class="p">())</span> <span class="k">as</span> <span class="n">p</span><span class="p">:</span>
</span><span id="L-175"><a href="#L-175"><span class="linenos">175</span></a>            <span class="k">for</span> <span class="n">measure_name</span><span class="p">,</span> <span class="n">varying_value</span><span class="p">,</span> <span class="n">seed</span><span class="p">,</span> <span class="n">measure_value</span> <span class="ow">in</span> <span class="n">p</span><span class="o">.</span><span class="n">starmap_async</span><span class="p">(</span>
</span><span id="L-176"><a href="#L-176"><span class="linenos">176</span></a>                <span class="n">_compute_hardness_measure</span><span class="p">,</span> <span class="n">inputs</span>
</span><span id="L-177"><a href="#L-177"><span class="linenos">177</span></a>            <span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
</span><span id="L-178"><a href="#L-178"><span class="linenos">178</span></a>                <span class="n">_add_result</span><span class="p">(</span>
</span><span id="L-179"><a href="#L-179"><span class="linenos">179</span></a>                    <span class="n">measure_results</span><span class="p">,</span> <span class="n">measure_name</span><span class="p">,</span> <span class="n">varying_value</span><span class="p">,</span> <span class="n">seed</span><span class="p">,</span> <span class="n">measure_value</span>
</span><span id="L-180"><a href="#L-180"><span class="linenos">180</span></a>                <span class="p">)</span>
</span><span id="L-181"><a href="#L-181"><span class="linenos">181</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="L-182"><a href="#L-182"><span class="linenos">182</span></a>        <span class="k">for</span> <span class="n">seed</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">hap</span><span class="o">.</span><span class="n">n_seeds_mdp</span><span class="p">):</span>
</span><span id="L-183"><a href="#L-183"><span class="linenos">183</span></a>            <span class="k">for</span> <span class="n">measure</span> <span class="ow">in</span> <span class="n">hap</span><span class="o">.</span><span class="n">hardness_measures</span><span class="p">:</span>
</span><span id="L-184"><a href="#L-184"><span class="linenos">184</span></a>                <span class="k">for</span> <span class="n">varying_value</span> <span class="ow">in</span> <span class="n">hap</span><span class="o">.</span><span class="n">varying_params_values</span><span class="p">:</span>
</span><span id="L-185"><a href="#L-185"><span class="linenos">185</span></a>                    <span class="n">out</span> <span class="o">=</span> <span class="n">compute_hardness_measure_for_varying_prm</span><span class="p">(</span>
</span><span id="L-186"><a href="#L-186"><span class="linenos">186</span></a>                        <span class="n">hap</span><span class="o">.</span><span class="n">mdp_class</span><span class="p">,</span>
</span><span id="L-187"><a href="#L-187"><span class="linenos">187</span></a>                        <span class="n">hap</span><span class="o">.</span><span class="n">fixed_params</span><span class="p">,</span>
</span><span id="L-188"><a href="#L-188"><span class="linenos">188</span></a>                        <span class="n">hap</span><span class="o">.</span><span class="n">varying_params_name</span><span class="p">,</span>
</span><span id="L-189"><a href="#L-189"><span class="linenos">189</span></a>                        <span class="n">varying_value</span><span class="p">,</span>
</span><span id="L-190"><a href="#L-190"><span class="linenos">190</span></a>                        <span class="n">seed</span><span class="p">,</span>
</span><span id="L-191"><a href="#L-191"><span class="linenos">191</span></a>                        <span class="n">measure</span><span class="p">,</span>
</span><span id="L-192"><a href="#L-192"><span class="linenos">192</span></a>                        <span class="n">force_single_core</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="L-193"><a href="#L-193"><span class="linenos">193</span></a>                        <span class="n">retrieve_from_cache</span><span class="o">=</span><span class="n">hap</span><span class="o">.</span><span class="n">retrieve_from_cache</span><span class="p">,</span>
</span><span id="L-194"><a href="#L-194"><span class="linenos">194</span></a>                        <span class="n">return_n_states</span><span class="o">=</span><span class="n">hap</span><span class="o">.</span><span class="n">varying_params_name</span> <span class="o">==</span> <span class="s2">&quot;size&quot;</span><span class="p">,</span>
</span><span id="L-195"><a href="#L-195"><span class="linenos">195</span></a>                    <span class="p">)</span>
</span><span id="L-196"><a href="#L-196"><span class="linenos">196</span></a>                    <span class="k">if</span> <span class="n">hap</span><span class="o">.</span><span class="n">varying_params_name</span> <span class="o">==</span> <span class="s2">&quot;size&quot;</span><span class="p">:</span>
</span><span id="L-197"><a href="#L-197"><span class="linenos">197</span></a>                        <span class="n">measure_name</span><span class="p">,</span> <span class="n">measure_value</span><span class="p">,</span> <span class="n">n_states</span> <span class="o">=</span> <span class="n">out</span>
</span><span id="L-198"><a href="#L-198"><span class="linenos">198</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="L-199"><a href="#L-199"><span class="linenos">199</span></a>                        <span class="n">measure_name</span><span class="p">,</span> <span class="n">measure_value</span> <span class="o">=</span> <span class="n">out</span>
</span><span id="L-200"><a href="#L-200"><span class="linenos">200</span></a>
</span><span id="L-201"><a href="#L-201"><span class="linenos">201</span></a>                    <span class="n">_add_result</span><span class="p">(</span>
</span><span id="L-202"><a href="#L-202"><span class="linenos">202</span></a>                        <span class="n">measure_results</span><span class="p">,</span>
</span><span id="L-203"><a href="#L-203"><span class="linenos">203</span></a>                        <span class="n">measure_name</span><span class="p">,</span>
</span><span id="L-204"><a href="#L-204"><span class="linenos">204</span></a>                        <span class="n">varying_value</span>
</span><span id="L-205"><a href="#L-205"><span class="linenos">205</span></a>                        <span class="k">if</span> <span class="n">hap</span><span class="o">.</span><span class="n">varying_params_name</span> <span class="o">!=</span> <span class="s2">&quot;size&quot;</span>
</span><span id="L-206"><a href="#L-206"><span class="linenos">206</span></a>                        <span class="k">else</span> <span class="n">n_states</span><span class="p">,</span>
</span><span id="L-207"><a href="#L-207"><span class="linenos">207</span></a>                        <span class="n">seed</span><span class="p">,</span>
</span><span id="L-208"><a href="#L-208"><span class="linenos">208</span></a>                        <span class="n">measure_value</span><span class="p">,</span>
</span><span id="L-209"><a href="#L-209"><span class="linenos">209</span></a>                    <span class="p">)</span>
</span><span id="L-210"><a href="#L-210"><span class="linenos">210</span></a>
</span><span id="L-211"><a href="#L-211"><span class="linenos">211</span></a>    <span class="k">for</span> <span class="n">measure_name</span> <span class="ow">in</span> <span class="n">measure_results</span><span class="p">:</span>
</span><span id="L-212"><a href="#L-212"><span class="linenos">212</span></a>        <span class="c1"># Create a Pandas DataFrame</span>
</span><span id="L-213"><a href="#L-213"><span class="linenos">213</span></a>        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">measure_results</span><span class="p">[</span><span class="n">measure_name</span><span class="p">])</span>
</span><span id="L-214"><a href="#L-214"><span class="linenos">214</span></a>
</span><span id="L-215"><a href="#L-215"><span class="linenos">215</span></a>        <span class="c1"># Normalize the values if required</span>
</span><span id="L-216"><a href="#L-216"><span class="linenos">216</span></a>        <span class="k">if</span> <span class="n">normalize_measures</span><span class="p">:</span>
</span><span id="L-217"><a href="#L-217"><span class="linenos">217</span></a>            <span class="n">min_value</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">measure_name</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
</span><span id="L-218"><a href="#L-218"><span class="linenos">218</span></a>            <span class="n">max_value</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">measure_name</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</span><span id="L-219"><a href="#L-219"><span class="linenos">219</span></a>            <span class="k">if</span> <span class="n">max_value</span> <span class="o">&gt;</span> <span class="n">min_value</span> <span class="o">+</span> <span class="mf">1e-4</span><span class="p">:</span>
</span><span id="L-220"><a href="#L-220"><span class="linenos">220</span></a>                <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">measure_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">measure_name</span><span class="p">]</span> <span class="o">-</span> <span class="n">min_value</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span>
</span><span id="L-221"><a href="#L-221"><span class="linenos">221</span></a>                    <span class="n">max_value</span> <span class="o">-</span> <span class="n">min_value</span>
</span><span id="L-222"><a href="#L-222"><span class="linenos">222</span></a>                <span class="p">)</span>
</span><span id="L-223"><a href="#L-223"><span class="linenos">223</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-224"><a href="#L-224"><span class="linenos">224</span></a>                <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">measure_name</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span>
</span><span id="L-225"><a href="#L-225"><span class="linenos">225</span></a>
</span><span id="L-226"><a href="#L-226"><span class="linenos">226</span></a>        <span class="c1"># Clean the varying parameter name</span>
</span><span id="L-227"><a href="#L-227"><span class="linenos">227</span></a>        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Varying value&quot;</span><span class="p">:</span> <span class="n">hap</span><span class="o">.</span><span class="n">clean_varying_prm_name</span><span class="p">})</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span>
</span><span id="L-228"><a href="#L-228"><span class="linenos">228</span></a>            <span class="n">hap</span><span class="o">.</span><span class="n">clean_varying_prm_name</span>
</span><span id="L-229"><a href="#L-229"><span class="linenos">229</span></a>        <span class="p">)</span>
</span><span id="L-230"><a href="#L-230"><span class="linenos">230</span></a>
</span><span id="L-231"><a href="#L-231"><span class="linenos">231</span></a>        <span class="n">measure_results</span><span class="p">[</span><span class="n">measure_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span>
</span><span id="L-232"><a href="#L-232"><span class="linenos">232</span></a>
</span><span id="L-233"><a href="#L-233"><span class="linenos">233</span></a>    <span class="k">return</span> <span class="n">measure_results</span>
</span><span id="L-234"><a href="#L-234"><span class="linenos">234</span></a>
</span><span id="L-235"><a href="#L-235"><span class="linenos">235</span></a>
</span><span id="L-236"><a href="#L-236"><span class="linenos">236</span></a><span class="k">def</span> <span class="nf">_compute_hardness_measure</span><span class="p">(</span>
</span><span id="L-237"><a href="#L-237"><span class="linenos">237</span></a>    <span class="n">mdp_class</span><span class="p">,</span>
</span><span id="L-238"><a href="#L-238"><span class="linenos">238</span></a>    <span class="n">fixed_params</span><span class="p">,</span>
</span><span id="L-239"><a href="#L-239"><span class="linenos">239</span></a>    <span class="n">varying_params_name</span><span class="p">,</span>
</span><span id="L-240"><a href="#L-240"><span class="linenos">240</span></a>    <span class="n">varying_value</span><span class="p">,</span>
</span><span id="L-241"><a href="#L-241"><span class="linenos">241</span></a>    <span class="n">seed</span><span class="p">,</span>
</span><span id="L-242"><a href="#L-242"><span class="linenos">242</span></a>    <span class="n">measure</span><span class="p">,</span>
</span><span id="L-243"><a href="#L-243"><span class="linenos">243</span></a>    <span class="n">retrieve_from_cache</span><span class="p">,</span>
</span><span id="L-244"><a href="#L-244"><span class="linenos">244</span></a>    <span class="n">return_n_states</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="L-245"><a href="#L-245"><span class="linenos">245</span></a><span class="p">):</span>
</span><span id="L-246"><a href="#L-246"><span class="linenos">246</span></a>    <span class="n">measure_name</span><span class="p">,</span> <span class="n">measure_value</span> <span class="o">=</span> <span class="n">compute_hardness_measure_for_varying_prm</span><span class="p">(</span>
</span><span id="L-247"><a href="#L-247"><span class="linenos">247</span></a>        <span class="n">mdp_class</span><span class="p">,</span>
</span><span id="L-248"><a href="#L-248"><span class="linenos">248</span></a>        <span class="n">fixed_params</span><span class="p">,</span>
</span><span id="L-249"><a href="#L-249"><span class="linenos">249</span></a>        <span class="n">varying_params_name</span><span class="p">,</span>
</span><span id="L-250"><a href="#L-250"><span class="linenos">250</span></a>        <span class="n">varying_value</span><span class="p">,</span>
</span><span id="L-251"><a href="#L-251"><span class="linenos">251</span></a>        <span class="n">seed</span><span class="p">,</span>
</span><span id="L-252"><a href="#L-252"><span class="linenos">252</span></a>        <span class="n">measure</span><span class="p">,</span>
</span><span id="L-253"><a href="#L-253"><span class="linenos">253</span></a>        <span class="n">force_single_core</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="L-254"><a href="#L-254"><span class="linenos">254</span></a>        <span class="n">retrieve_from_cache</span><span class="o">=</span><span class="n">retrieve_from_cache</span><span class="p">,</span>
</span><span id="L-255"><a href="#L-255"><span class="linenos">255</span></a>    <span class="p">)</span>
</span><span id="L-256"><a href="#L-256"><span class="linenos">256</span></a>    <span class="k">return</span> <span class="n">measure_name</span><span class="p">,</span> <span class="n">varying_value</span><span class="p">,</span> <span class="n">seed</span><span class="p">,</span> <span class="n">measure_value</span>
</span><span id="L-257"><a href="#L-257"><span class="linenos">257</span></a>
</span><span id="L-258"><a href="#L-258"><span class="linenos">258</span></a>
</span><span id="L-259"><a href="#L-259"><span class="linenos">259</span></a><span class="k">def</span> <span class="nf">compute_hardness_measure_for_varying_prm</span><span class="p">(</span>
</span><span id="L-260"><a href="#L-260"><span class="linenos">260</span></a>    <span class="n">mdp_class</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="s2">&quot;BaseMDP&quot;</span><span class="p">],</span>
</span><span id="L-261"><a href="#L-261"><span class="linenos">261</span></a>    <span class="n">fixed_params</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
</span><span id="L-262"><a href="#L-262"><span class="linenos">262</span></a>    <span class="n">varying_params_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="L-263"><a href="#L-263"><span class="linenos">263</span></a>    <span class="n">varying_value</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
</span><span id="L-264"><a href="#L-264"><span class="linenos">264</span></a>    <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="L-265"><a href="#L-265"><span class="linenos">265</span></a>    <span class="n">measure</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">BaseMDP</span><span class="p">],</span> <span class="nb">float</span><span class="p">]],</span>
</span><span id="L-266"><a href="#L-266"><span class="linenos">266</span></a>    <span class="n">force_single_core</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="L-267"><a href="#L-267"><span class="linenos">267</span></a>    <span class="n">retrieve_from_cache</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="L-268"><a href="#L-268"><span class="linenos">268</span></a>    <span class="n">folder</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-269"><a href="#L-269"><span class="linenos">269</span></a>    <span class="n">return_n_states</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="L-270"><a href="#L-270"><span class="linenos">270</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
</span><span id="L-271"><a href="#L-271"><span class="linenos">271</span></a>    <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-272"><a href="#L-272"><span class="linenos">272</span></a><span class="sd">    computes the hardness measure for varying values of the parameter.</span>
</span><span id="L-273"><a href="#L-273"><span class="linenos">273</span></a>
</span><span id="L-274"><a href="#L-274"><span class="linenos">274</span></a><span class="sd">    Parameters</span>
</span><span id="L-275"><a href="#L-275"><span class="linenos">275</span></a><span class="sd">    ----------</span>
</span><span id="L-276"><a href="#L-276"><span class="linenos">276</span></a><span class="sd">    mdp_class : Type[&quot;BaseMDP&quot;]</span>
</span><span id="L-277"><a href="#L-277"><span class="linenos">277</span></a><span class="sd">        The MDP class for which the measures will be computed.</span>
</span><span id="L-278"><a href="#L-278"><span class="linenos">278</span></a><span class="sd">    fixed_params : Dict[str, Any]</span>
</span><span id="L-279"><a href="#L-279"><span class="linenos">279</span></a><span class="sd">        The parameters of the MDP that are being kept fixed.</span>
</span><span id="L-280"><a href="#L-280"><span class="linenos">280</span></a><span class="sd">    varying_params_name : str</span>
</span><span id="L-281"><a href="#L-281"><span class="linenos">281</span></a><span class="sd">        The name of the varying parameter.</span>
</span><span id="L-282"><a href="#L-282"><span class="linenos">282</span></a><span class="sd">    varying_value : Any</span>
</span><span id="L-283"><a href="#L-283"><span class="linenos">283</span></a><span class="sd">        The value of the parameter that is varying.</span>
</span><span id="L-284"><a href="#L-284"><span class="linenos">284</span></a><span class="sd">    seed : int</span>
</span><span id="L-285"><a href="#L-285"><span class="linenos">285</span></a><span class="sd">        The random seed.</span>
</span><span id="L-286"><a href="#L-286"><span class="linenos">286</span></a><span class="sd">    measure : Union[str, Callable[[BaseMDP], float]]</span>
</span><span id="L-287"><a href="#L-287"><span class="linenos">287</span></a><span class="sd">        The measure to be computed. It can be given as a function from MDP instances to float or as a string. If given</span>
</span><span id="L-288"><a href="#L-288"><span class="linenos">288</span></a><span class="sd">        as a string, it will be looked for in the ones available in the package</span>
</span><span id="L-289"><a href="#L-289"><span class="linenos">289</span></a><span class="sd">    force_single_core : bool</span>
</span><span id="L-290"><a href="#L-290"><span class="linenos">290</span></a><span class="sd">        If True, the computation of the measure is forced to use only a single core. Note that this is not enforced when</span>
</span><span id="L-291"><a href="#L-291"><span class="linenos">291</span></a><span class="sd">        the measure is given as a function. By default, single processing is not enforced.</span>
</span><span id="L-292"><a href="#L-292"><span class="linenos">292</span></a><span class="sd">    retrieve_from_cache : bool</span>
</span><span id="L-293"><a href="#L-293"><span class="linenos">293</span></a><span class="sd">        If True, the function will look for cached values of the measure. Note that this also hold if the measure is</span>
</span><span id="L-294"><a href="#L-294"><span class="linenos">294</span></a><span class="sd">        given as a function.</span>
</span><span id="L-295"><a href="#L-295"><span class="linenos">295</span></a><span class="sd">    folder : str</span>
</span><span id="L-296"><a href="#L-296"><span class="linenos">296</span></a><span class="sd">        The folder where cached values are looked for. By default, it is the `config.get_hardness_measures_cache_folder()`.</span>
</span><span id="L-297"><a href="#L-297"><span class="linenos">297</span></a><span class="sd">    return_n_states : bool</span>
</span><span id="L-298"><a href="#L-298"><span class="linenos">298</span></a><span class="sd">        If True, the number of states is returned.</span>
</span><span id="L-299"><a href="#L-299"><span class="linenos">299</span></a>
</span><span id="L-300"><a href="#L-300"><span class="linenos">300</span></a><span class="sd">    Returns</span>
</span><span id="L-301"><a href="#L-301"><span class="linenos">301</span></a><span class="sd">    -------</span>
</span><span id="L-302"><a href="#L-302"><span class="linenos">302</span></a><span class="sd">    str</span>
</span><span id="L-303"><a href="#L-303"><span class="linenos">303</span></a><span class="sd">        The nicely formatted name of the measure.</span>
</span><span id="L-304"><a href="#L-304"><span class="linenos">304</span></a><span class="sd">    float</span>
</span><span id="L-305"><a href="#L-305"><span class="linenos">305</span></a><span class="sd">        The value of the measure.</span>
</span><span id="L-306"><a href="#L-306"><span class="linenos">306</span></a><span class="sd">    int, optional</span>
</span><span id="L-307"><a href="#L-307"><span class="linenos">307</span></a><span class="sd">        The number of states.</span>
</span><span id="L-308"><a href="#L-308"><span class="linenos">308</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-309"><a href="#L-309"><span class="linenos">309</span></a>
</span><span id="L-310"><a href="#L-310"><span class="linenos">310</span></a>    <span class="c1"># Instantiate the MDP parameters</span>
</span><span id="L-311"><a href="#L-311"><span class="linenos">311</span></a>    <span class="n">mdp_kwargs</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">fixed_params</span><span class="p">)</span>
</span><span id="L-312"><a href="#L-312"><span class="linenos">312</span></a>    <span class="n">mdp_kwargs</span><span class="p">[</span><span class="s2">&quot;seed&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">seed</span>
</span><span id="L-313"><a href="#L-313"><span class="linenos">313</span></a>    <span class="n">mdp_kwargs</span><span class="p">[</span><span class="n">varying_params_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">varying_value</span>
</span><span id="L-314"><a href="#L-314"><span class="linenos">314</span></a>
</span><span id="L-315"><a href="#L-315"><span class="linenos">315</span></a>    <span class="k">return</span> <span class="n">compute_hardness_measure</span><span class="p">(</span>
</span><span id="L-316"><a href="#L-316"><span class="linenos">316</span></a>        <span class="n">mdp_class</span><span class="p">,</span>
</span><span id="L-317"><a href="#L-317"><span class="linenos">317</span></a>        <span class="n">mdp_kwargs</span><span class="p">,</span>
</span><span id="L-318"><a href="#L-318"><span class="linenos">318</span></a>        <span class="n">measure</span><span class="p">,</span>
</span><span id="L-319"><a href="#L-319"><span class="linenos">319</span></a>        <span class="n">force_single_core</span><span class="p">,</span>
</span><span id="L-320"><a href="#L-320"><span class="linenos">320</span></a>        <span class="n">retrieve_from_cache</span><span class="p">,</span>
</span><span id="L-321"><a href="#L-321"><span class="linenos">321</span></a>        <span class="n">folder</span><span class="p">,</span>
</span><span id="L-322"><a href="#L-322"><span class="linenos">322</span></a>        <span class="kc">True</span><span class="p">,</span>
</span><span id="L-323"><a href="#L-323"><span class="linenos">323</span></a>        <span class="n">return_n_states</span><span class="p">,</span>
</span><span id="L-324"><a href="#L-324"><span class="linenos">324</span></a>    <span class="p">)</span>
</span><span id="L-325"><a href="#L-325"><span class="linenos">325</span></a>
</span><span id="L-326"><a href="#L-326"><span class="linenos">326</span></a>
</span><span id="L-327"><a href="#L-327"><span class="linenos">327</span></a><span class="k">def</span> <span class="nf">compute_hardness_measure</span><span class="p">(</span>
</span><span id="L-328"><a href="#L-328"><span class="linenos">328</span></a>    <span class="n">mdp_class</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="s2">&quot;BaseMDP&quot;</span><span class="p">],</span>
</span><span id="L-329"><a href="#L-329"><span class="linenos">329</span></a>    <span class="n">mdp_params</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
</span><span id="L-330"><a href="#L-330"><span class="linenos">330</span></a>    <span class="n">measure</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">BaseMDP</span><span class="p">],</span> <span class="nb">float</span><span class="p">]],</span>
</span><span id="L-331"><a href="#L-331"><span class="linenos">331</span></a>    <span class="n">force_single_core</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="L-332"><a href="#L-332"><span class="linenos">332</span></a>    <span class="n">retrieve_from_cache</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="L-333"><a href="#L-333"><span class="linenos">333</span></a>    <span class="n">folder</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-334"><a href="#L-334"><span class="linenos">334</span></a>    <span class="n">return_measure_name</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="L-335"><a href="#L-335"><span class="linenos">335</span></a>    <span class="n">return_n_states</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="L-336"><a href="#L-336"><span class="linenos">336</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]:</span>
</span><span id="L-337"><a href="#L-337"><span class="linenos">337</span></a>    <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-338"><a href="#L-338"><span class="linenos">338</span></a>
</span><span id="L-339"><a href="#L-339"><span class="linenos">339</span></a><span class="sd">    Parameters</span>
</span><span id="L-340"><a href="#L-340"><span class="linenos">340</span></a><span class="sd">    ----------</span>
</span><span id="L-341"><a href="#L-341"><span class="linenos">341</span></a><span class="sd">    mdp_class : Type[&quot;BaseMDP&quot;]</span>
</span><span id="L-342"><a href="#L-342"><span class="linenos">342</span></a><span class="sd">        The MDP class for which the measures will be computed.</span>
</span><span id="L-343"><a href="#L-343"><span class="linenos">343</span></a><span class="sd">    mdp_params : Dict[str, Any]</span>
</span><span id="L-344"><a href="#L-344"><span class="linenos">344</span></a><span class="sd">        The parameters for the MDP.</span>
</span><span id="L-345"><a href="#L-345"><span class="linenos">345</span></a><span class="sd">    measure : Union[str, Callable[[BaseMDP], float]]</span>
</span><span id="L-346"><a href="#L-346"><span class="linenos">346</span></a><span class="sd">        The measure to be computed. It can be given as a function from MDP instances to float or as a string. If given</span>
</span><span id="L-347"><a href="#L-347"><span class="linenos">347</span></a><span class="sd">        as a string, it will be looked for in the ones available in the package</span>
</span><span id="L-348"><a href="#L-348"><span class="linenos">348</span></a><span class="sd">    force_single_core : bool</span>
</span><span id="L-349"><a href="#L-349"><span class="linenos">349</span></a><span class="sd">        If True, the computation of the measure is forced to use only a single core. Note that this is not enforced when</span>
</span><span id="L-350"><a href="#L-350"><span class="linenos">350</span></a><span class="sd">        the measure is given as a function. By default, single processing is not enforced.</span>
</span><span id="L-351"><a href="#L-351"><span class="linenos">351</span></a><span class="sd">    retrieve_from_cache : bool</span>
</span><span id="L-352"><a href="#L-352"><span class="linenos">352</span></a><span class="sd">        If True, the function will look for cached values of the measure. Note that this also hold if the measure is</span>
</span><span id="L-353"><a href="#L-353"><span class="linenos">353</span></a><span class="sd">        given as a function.</span>
</span><span id="L-354"><a href="#L-354"><span class="linenos">354</span></a><span class="sd">    folder : str</span>
</span><span id="L-355"><a href="#L-355"><span class="linenos">355</span></a><span class="sd">        The folder where cached values are looked for. By default, it is the `config.get_hardness_measures_cache_folder()`.</span>
</span><span id="L-356"><a href="#L-356"><span class="linenos">356</span></a><span class="sd">    return_measure_name : bool</span>
</span><span id="L-357"><a href="#L-357"><span class="linenos">357</span></a><span class="sd">        If True, a nicely formatted name for the measure is returned.</span>
</span><span id="L-358"><a href="#L-358"><span class="linenos">358</span></a><span class="sd">    return_n_states : bool</span>
</span><span id="L-359"><a href="#L-359"><span class="linenos">359</span></a><span class="sd">        If True, the number of states is returned.</span>
</span><span id="L-360"><a href="#L-360"><span class="linenos">360</span></a>
</span><span id="L-361"><a href="#L-361"><span class="linenos">361</span></a><span class="sd">    Returns</span>
</span><span id="L-362"><a href="#L-362"><span class="linenos">362</span></a><span class="sd">    -------</span>
</span><span id="L-363"><a href="#L-363"><span class="linenos">363</span></a><span class="sd">    str, optional</span>
</span><span id="L-364"><a href="#L-364"><span class="linenos">364</span></a><span class="sd">        The nicely formatted name of the measure.</span>
</span><span id="L-365"><a href="#L-365"><span class="linenos">365</span></a><span class="sd">    float</span>
</span><span id="L-366"><a href="#L-366"><span class="linenos">366</span></a><span class="sd">        The value of the measure.</span>
</span><span id="L-367"><a href="#L-367"><span class="linenos">367</span></a><span class="sd">    int, optional</span>
</span><span id="L-368"><a href="#L-368"><span class="linenos">368</span></a><span class="sd">        The number of states.</span>
</span><span id="L-369"><a href="#L-369"><span class="linenos">369</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-370"><a href="#L-370"><span class="linenos">370</span></a>
</span><span id="L-371"><a href="#L-371"><span class="linenos">371</span></a>    <span class="c1"># Obtain the name of the measure and the function to compute it</span>
</span><span id="L-372"><a href="#L-372"><span class="linenos">372</span></a>    <span class="n">measure_name</span><span class="p">,</span> <span class="n">measure_f</span> <span class="o">=</span> <span class="n">_process_measure</span><span class="p">(</span><span class="n">measure</span><span class="p">)</span>
</span><span id="L-373"><a href="#L-373"><span class="linenos">373</span></a>
</span><span id="L-374"><a href="#L-374"><span class="linenos">374</span></a>    <span class="c1"># Check if the measure has already been computed</span>
</span><span id="L-375"><a href="#L-375"><span class="linenos">375</span></a>    <span class="k">if</span> <span class="n">retrieve_from_cache</span><span class="p">:</span>
</span><span id="L-376"><a href="#L-376"><span class="linenos">376</span></a>        <span class="n">mdp_shell</span> <span class="o">=</span> <span class="n">mdp_class</span><span class="p">(</span>
</span><span id="L-377"><a href="#L-377"><span class="linenos">377</span></a>            <span class="o">**</span><span class="n">mdp_params</span><span class="p">,</span> <span class="n">instantiate_mdp</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">exclude_horizon_from_parameters</span><span class="o">=</span><span class="kc">True</span>
</span><span id="L-378"><a href="#L-378"><span class="linenos">378</span></a>        <span class="p">)</span>
</span><span id="L-379"><a href="#L-379"><span class="linenos">379</span></a>        <span class="k">if</span> <span class="n">folder</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-380"><a href="#L-380"><span class="linenos">380</span></a>            <span class="n">folder</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-381"><a href="#L-381"><span class="linenos">381</span></a>                <span class="n">config</span><span class="o">.</span><span class="n">get_hardness_measures_cache_folder</span><span class="p">()</span>
</span><span id="L-382"><a href="#L-382"><span class="linenos">382</span></a>                <span class="o">+</span> <span class="n">mdp_class</span><span class="o">.</span><span class="vm">__name__</span>
</span><span id="L-383"><a href="#L-383"><span class="linenos">383</span></a>                <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span>
</span><span id="L-384"><a href="#L-384"><span class="linenos">384</span></a>            <span class="p">)</span>
</span><span id="L-385"><a href="#L-385"><span class="linenos">385</span></a>
</span><span id="L-386"><a href="#L-386"><span class="linenos">386</span></a>        <span class="n">measure_file_path</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">folder</span><span class="si">}{</span><span class="n">measure_name</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">mdp_shell</span><span class="o">.</span><span class="n">hash</span><span class="si">}</span><span class="s2">.txt&quot;</span>
</span><span id="L-387"><a href="#L-387"><span class="linenos">387</span></a>        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">measure_file_path</span><span class="p">):</span>
</span><span id="L-388"><a href="#L-388"><span class="linenos">388</span></a>            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">measure_file_path</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="L-389"><a href="#L-389"><span class="linenos">389</span></a>                <span class="n">measure_value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
</span><span id="L-390"><a href="#L-390"><span class="linenos">390</span></a>
</span><span id="L-391"><a href="#L-391"><span class="linenos">391</span></a>            <span class="n">out</span> <span class="o">=</span> <span class="p">[</span><span class="n">measure_value</span><span class="p">]</span>
</span><span id="L-392"><a href="#L-392"><span class="linenos">392</span></a>            <span class="k">if</span> <span class="n">return_measure_name</span><span class="p">:</span>
</span><span id="L-393"><a href="#L-393"><span class="linenos">393</span></a>                <span class="n">out</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">measure_name</span><span class="p">)</span>
</span><span id="L-394"><a href="#L-394"><span class="linenos">394</span></a>            <span class="k">if</span> <span class="n">return_n_states</span><span class="p">:</span>
</span><span id="L-395"><a href="#L-395"><span class="linenos">395</span></a>                <span class="n">mdp_shell</span><span class="o">.</span><span class="n">instantiate_MDP</span><span class="p">()</span>
</span><span id="L-396"><a href="#L-396"><span class="linenos">396</span></a>                <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mdp_shell</span><span class="o">.</span><span class="n">n_states</span><span class="p">)</span>
</span><span id="L-397"><a href="#L-397"><span class="linenos">397</span></a>            <span class="k">return</span> <span class="n">out</span>
</span><span id="L-398"><a href="#L-398"><span class="linenos">398</span></a>
</span><span id="L-399"><a href="#L-399"><span class="linenos">399</span></a>    <span class="c1"># Possible forcing the computation to avoid using multiple cores</span>
</span><span id="L-400"><a href="#L-400"><span class="linenos">400</span></a>    <span class="k">if</span> <span class="n">force_single_core</span> <span class="ow">and</span> <span class="n">config</span><span class="o">.</span><span class="n">get_available_cores</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-401"><a href="#L-401"><span class="linenos">401</span></a>        <span class="n">available_cores</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get_available_cores</span><span class="p">()</span>
</span><span id="L-402"><a href="#L-402"><span class="linenos">402</span></a>        <span class="n">config</span><span class="o">.</span><span class="n">disable_multiprocessing</span><span class="p">()</span>
</span><span id="L-403"><a href="#L-403"><span class="linenos">403</span></a>        <span class="n">mdp</span> <span class="o">=</span> <span class="n">mdp_class</span><span class="p">(</span><span class="o">**</span><span class="n">mdp_params</span><span class="p">)</span>
</span><span id="L-404"><a href="#L-404"><span class="linenos">404</span></a>        <span class="n">measure_value</span> <span class="o">=</span> <span class="n">measure_f</span><span class="p">(</span><span class="n">mdp</span><span class="p">)</span>
</span><span id="L-405"><a href="#L-405"><span class="linenos">405</span></a>        <span class="n">config</span><span class="o">.</span><span class="n">set_available_cores</span><span class="p">(</span><span class="n">available_cores</span><span class="p">)</span>
</span><span id="L-406"><a href="#L-406"><span class="linenos">406</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="L-407"><a href="#L-407"><span class="linenos">407</span></a>        <span class="n">mdp</span> <span class="o">=</span> <span class="n">mdp_class</span><span class="p">(</span><span class="o">**</span><span class="n">mdp_params</span><span class="p">)</span>
</span><span id="L-408"><a href="#L-408"><span class="linenos">408</span></a>        <span class="n">measure_value</span> <span class="o">=</span> <span class="n">measure_f</span><span class="p">(</span><span class="n">mdp</span><span class="p">)</span>
</span><span id="L-409"><a href="#L-409"><span class="linenos">409</span></a>
</span><span id="L-410"><a href="#L-410"><span class="linenos">410</span></a>    <span class="c1"># Caching the value of the measure (only in case we were supposed to look for it in the first place)</span>
</span><span id="L-411"><a href="#L-411"><span class="linenos">411</span></a>    <span class="k">if</span> <span class="n">retrieve_from_cache</span><span class="p">:</span>
</span><span id="L-412"><a href="#L-412"><span class="linenos">412</span></a>        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">measure_file_path</span><span class="p">),</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-413"><a href="#L-413"><span class="linenos">413</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">measure_file_path</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="L-414"><a href="#L-414"><span class="linenos">414</span></a>            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">measure_value</span><span class="p">))</span>
</span><span id="L-415"><a href="#L-415"><span class="linenos">415</span></a>
</span><span id="L-416"><a href="#L-416"><span class="linenos">416</span></a>    <span class="n">out</span> <span class="o">=</span> <span class="p">[</span><span class="n">measure_value</span><span class="p">]</span>
</span><span id="L-417"><a href="#L-417"><span class="linenos">417</span></a>    <span class="k">if</span> <span class="n">return_measure_name</span><span class="p">:</span>
</span><span id="L-418"><a href="#L-418"><span class="linenos">418</span></a>        <span class="n">out</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">measure_name</span><span class="p">)</span>
</span><span id="L-419"><a href="#L-419"><span class="linenos">419</span></a>    <span class="k">if</span> <span class="n">return_n_states</span><span class="p">:</span>
</span><span id="L-420"><a href="#L-420"><span class="linenos">420</span></a>        <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mdp</span><span class="o">.</span><span class="n">n_states</span><span class="p">)</span>
</span><span id="L-421"><a href="#L-421"><span class="linenos">421</span></a>    <span class="k">return</span> <span class="n">out</span>
</span><span id="L-422"><a href="#L-422"><span class="linenos">422</span></a>
</span><span id="L-423"><a href="#L-423"><span class="linenos">423</span></a>
</span><span id="L-424"><a href="#L-424"><span class="linenos">424</span></a><span class="k">def</span> <span class="nf">_process_measure</span><span class="p">(</span>
</span><span id="L-425"><a href="#L-425"><span class="linenos">425</span></a>    <span class="n">measure</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">BaseMDP</span><span class="p">],</span> <span class="nb">float</span><span class="p">]]</span>
</span><span id="L-426"><a href="#L-426"><span class="linenos">426</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">BaseMDP</span><span class="p">],</span> <span class="nb">float</span><span class="p">]]:</span>
</span><span id="L-427"><a href="#L-427"><span class="linenos">427</span></a>    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">measure</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-428"><a href="#L-428"><span class="linenos">428</span></a>        <span class="n">measure_name</span> <span class="o">=</span> <span class="n">measure</span>
</span><span id="L-429"><a href="#L-429"><span class="linenos">429</span></a>        <span class="k">if</span> <span class="n">measure_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">BaseMDP</span><span class="o">.</span><span class="n">get_available_hardness_measures</span><span class="p">():</span>
</span><span id="L-430"><a href="#L-430"><span class="linenos">430</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="L-431"><a href="#L-431"><span class="linenos">431</span></a>                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">measure</span><span class="si">}</span><span class="s2"> is not a valid hardness measure, the available ones are: &quot;</span>
</span><span id="L-432"><a href="#L-432"><span class="linenos">432</span></a>                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">BaseMDP</span><span class="o">.</span><span class="n">get_available_hardness_measures</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-433"><a href="#L-433"><span class="linenos">433</span></a>            <span class="p">)</span>
</span><span id="L-434"><a href="#L-434"><span class="linenos">434</span></a>        <span class="k">return</span> <span class="n">measure</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">mdp</span><span class="p">:</span> <span class="n">mdp</span><span class="o">.</span><span class="n">get_measure_from_name</span><span class="p">(</span><span class="n">measure</span><span class="p">)</span>
</span><span id="L-435"><a href="#L-435"><span class="linenos">435</span></a>    <span class="k">elif</span> <span class="n">callable</span><span class="p">(</span><span class="n">measure</span><span class="p">):</span>
</span><span id="L-436"><a href="#L-436"><span class="linenos">436</span></a>        <span class="k">return</span> <span class="n">measure</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">measure</span>
</span><span id="L-437"><a href="#L-437"><span class="linenos">437</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="L-438"><a href="#L-438"><span class="linenos">438</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="L-439"><a href="#L-439"><span class="linenos">439</span></a>            <span class="sa">f</span><span class="s2">&quot;The measure should either be a string or a Callable, </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">measure</span><span class="p">)</span><span class="si">}</span><span class="s2"> received.&quot;</span>
</span><span id="L-440"><a href="#L-440"><span class="linenos">440</span></a>        <span class="p">)</span>
</span><span id="L-441"><a href="#L-441"><span class="linenos">441</span></a>
</span><span id="L-442"><a href="#L-442"><span class="linenos">442</span></a>
</span><span id="L-443"><a href="#L-443"><span class="linenos">443</span></a><span class="k">def</span> <span class="nf">_add_result</span><span class="p">(</span><span class="n">measure_results</span><span class="p">,</span> <span class="n">measure_name</span><span class="p">,</span> <span class="n">varying_value</span><span class="p">,</span> <span class="n">seed</span><span class="p">,</span> <span class="n">measure_value</span><span class="p">):</span>
</span><span id="L-444"><a href="#L-444"><span class="linenos">444</span></a>    <span class="n">measure_name</span> <span class="o">=</span> <span class="n">measure_name</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">)</span>
</span><span id="L-445"><a href="#L-445"><span class="linenos">445</span></a>
</span><span id="L-446"><a href="#L-446"><span class="linenos">446</span></a>    <span class="k">if</span> <span class="n">measure_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">measure_results</span><span class="p">:</span>
</span><span id="L-447"><a href="#L-447"><span class="linenos">447</span></a>        <span class="n">measure_results</span><span class="p">[</span><span class="n">measure_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-448"><a href="#L-448"><span class="linenos">448</span></a>            <span class="s2">&quot;Varying value&quot;</span><span class="p">:</span> <span class="p">[],</span>
</span><span id="L-449"><a href="#L-449"><span class="linenos">449</span></a>            <span class="n">measure_name</span><span class="p">:</span> <span class="p">[],</span>
</span><span id="L-450"><a href="#L-450"><span class="linenos">450</span></a>            <span class="s2">&quot;Seed&quot;</span><span class="p">:</span> <span class="p">[],</span>
</span><span id="L-451"><a href="#L-451"><span class="linenos">451</span></a>        <span class="p">}</span>
</span><span id="L-452"><a href="#L-452"><span class="linenos">452</span></a>    <span class="n">measure_results</span><span class="p">[</span><span class="n">measure_name</span><span class="p">][</span><span class="s2">&quot;Varying value&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">varying_value</span><span class="p">)</span>
</span><span id="L-453"><a href="#L-453"><span class="linenos">453</span></a>    <span class="n">measure_results</span><span class="p">[</span><span class="n">measure_name</span><span class="p">][</span><span class="s2">&quot;Seed&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
</span><span id="L-454"><a href="#L-454"><span class="linenos">454</span></a>    <span class="n">measure_results</span><span class="p">[</span><span class="n">measure_name</span><span class="p">][</span><span class="n">measure_name</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">measure_value</span><span class="p">)</span>
</span></pre></div>


            </section>
                <section id="SingleInstanceHyperOptConfig">
                            <input id="SingleInstanceHyperOptConfig-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator">@dataclass()</div>

    <span class="def">class</span>
    <span class="name">SingleInstanceHyperOptConfig</span>:

                <label class="view-source-button" for="SingleInstanceHyperOptConfig-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SingleInstanceHyperOptConfig"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SingleInstanceHyperOptConfig-33"><a href="#SingleInstanceHyperOptConfig-33"><span class="linenos">33</span></a><span class="nd">@dataclass</span><span class="p">()</span>
</span><span id="SingleInstanceHyperOptConfig-34"><a href="#SingleInstanceHyperOptConfig-34"><span class="linenos">34</span></a><span class="k">class</span> <span class="nc">SingleInstanceHyperOptConfig</span><span class="p">:</span>
</span><span id="SingleInstanceHyperOptConfig-35"><a href="#SingleInstanceHyperOptConfig-35"><span class="linenos">35</span></a>    <span class="n">mdp_class</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="s2">&quot;BaseMDP&quot;</span><span class="p">]</span>
</span><span id="SingleInstanceHyperOptConfig-36"><a href="#SingleInstanceHyperOptConfig-36"><span class="linenos">36</span></a>    <span class="sd">&quot;&quot;&quot;The class of the MDP with respect to whom we are performing the parameters optimization.&quot;&quot;&quot;</span>
</span><span id="SingleInstanceHyperOptConfig-37"><a href="#SingleInstanceHyperOptConfig-37"><span class="linenos">37</span></a>    <span class="n">mdp_parameters</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
</span><span id="SingleInstanceHyperOptConfig-38"><a href="#SingleInstanceHyperOptConfig-38"><span class="linenos">38</span></a>    <span class="sd">&quot;&quot;&quot;The dictionary containing the parameters for the MDP class with respect to whom we are performing the parameters optimization.&quot;&quot;&quot;</span>
</span><span id="SingleInstanceHyperOptConfig-39"><a href="#SingleInstanceHyperOptConfig-39"><span class="linenos">39</span></a>    <span class="n">n_seed</span><span class="p">:</span> <span class="nb">int</span>
</span><span id="SingleInstanceHyperOptConfig-40"><a href="#SingleInstanceHyperOptConfig-40"><span class="linenos">40</span></a>    <span class="sd">&quot;&quot;&quot;The number of seed the agent/MDP interaction is repeated.&quot;&quot;&quot;</span>
</span><span id="SingleInstanceHyperOptConfig-41"><a href="#SingleInstanceHyperOptConfig-41"><span class="linenos">41</span></a>    <span class="n">optimization_horizon</span><span class="p">:</span> <span class="nb">int</span>
</span><span id="SingleInstanceHyperOptConfig-42"><a href="#SingleInstanceHyperOptConfig-42"><span class="linenos">42</span></a>    <span class="sd">&quot;&quot;&quot;The optimization horizon of the agent/MDP interaction.&quot;&quot;&quot;</span>
</span><span id="SingleInstanceHyperOptConfig-43"><a href="#SingleInstanceHyperOptConfig-43"><span class="linenos">43</span></a>    <span class="n">num_samples</span><span class="p">:</span> <span class="nb">int</span>
</span><span id="SingleInstanceHyperOptConfig-44"><a href="#SingleInstanceHyperOptConfig-44"><span class="linenos">44</span></a>    <span class="sd">&quot;&quot;&quot;The number of samples of the agent parameters.&quot;&quot;&quot;</span>
</span><span id="SingleInstanceHyperOptConfig-45"><a href="#SingleInstanceHyperOptConfig-45"><span class="linenos">45</span></a>    <span class="n">max_interaction_s</span><span class="p">:</span> <span class="nb">float</span>
</span><span id="SingleInstanceHyperOptConfig-46"><a href="#SingleInstanceHyperOptConfig-46"><span class="linenos">46</span></a>    <span class="sd">&quot;&quot;&quot;The maximum amount of seconds allocated to training the agent.&quot;&quot;&quot;</span>
</span><span id="SingleInstanceHyperOptConfig-47"><a href="#SingleInstanceHyperOptConfig-47"><span class="linenos">47</span></a>    <span class="n">log_every</span><span class="p">:</span> <span class="nb">int</span>
</span><span id="SingleInstanceHyperOptConfig-48"><a href="#SingleInstanceHyperOptConfig-48"><span class="linenos">48</span></a>    <span class="sd">&quot;&quot;&quot;The length of the interval between logging of the performance indicators.&quot;&quot;&quot;</span>
</span><span id="SingleInstanceHyperOptConfig-49"><a href="#SingleInstanceHyperOptConfig-49"><span class="linenos">49</span></a>    <span class="n">episodic_near_optimal_agent_class</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="s2">&quot;BaseAgent&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">PSRLEpisodic</span>
</span><span id="SingleInstanceHyperOptConfig-50"><a href="#SingleInstanceHyperOptConfig-50"><span class="linenos">50</span></a>    <span class="sd">&quot;&quot;&quot;The class of the near optimal agent for the episodic setting. By default, it is ``PSRLEpisodic``.&quot;&quot;&quot;</span>
</span><span id="SingleInstanceHyperOptConfig-51"><a href="#SingleInstanceHyperOptConfig-51"><span class="linenos">51</span></a>    <span class="n">continuous_near_optimal_agent_class</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="s2">&quot;BaseAgent&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">UCRL2Continuous</span>
</span><span id="SingleInstanceHyperOptConfig-52"><a href="#SingleInstanceHyperOptConfig-52"><span class="linenos">52</span></a>    <span class="sd">&quot;&quot;&quot;The class of the near optimal agent for the continuous setting. By default, it is ``UCRL2Continuous``.&quot;&quot;&quot;</span>
</span></pre></div>


    

                            <div id="SingleInstanceHyperOptConfig.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">SingleInstanceHyperOptConfig</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">mdp_class</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n"><a href="../mdp/base.html#BaseMDP">colosseum.mdp.base.BaseMDP</a></span><span class="p">]</span>,</span><span class="param">	<span class="n">mdp_parameters</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>,</span><span class="param">	<span class="n">n_seed</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">optimization_horizon</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">num_samples</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">max_interaction_s</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">log_every</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	episodic_near_optimal_agent_class: Type[<a href="../agent/agents/base.html#BaseAgent">colosseum.agent.agents.base.BaseAgent</a>] = &lt;class &#x27;<a href="../agent/agents/episodic/posterior_sampling.html#PSRLEpisodic">colosseum.agent.agents.episodic.posterior_sampling.PSRLEpisodic</a>&#x27;&gt;,</span><span class="param">	continuous_near_optimal_agent_class: Type[<a href="../agent/agents/base.html#BaseAgent">colosseum.agent.agents.base.BaseAgent</a>] = &lt;class &#x27;<a href="../agent/agents/infinite_horizon/ucrl2.html#UCRL2Continuous">colosseum.agent.agents.infinite_horizon.ucrl2.UCRL2Continuous</a>&#x27;&gt;</span>)</span>

        
    </div>
    <a class="headerlink" href="#SingleInstanceHyperOptConfig.__init__"></a>
    
    

                            </div>
                            <div id="SingleInstanceHyperOptConfig.mdp_class" class="classattr">
                                <div class="attr variable">
            <span class="name">mdp_class</span><span class="annotation">: Type[<a href="../mdp/base.html#BaseMDP">colosseum.mdp.base.BaseMDP</a>]</span>

        
    </div>
    <a class="headerlink" href="#SingleInstanceHyperOptConfig.mdp_class"></a>
    
            <div class="docstring"><p>The class of the MDP with respect to whom we are performing the parameters optimization.</p>
</div>


                            </div>
                            <div id="SingleInstanceHyperOptConfig.mdp_parameters" class="classattr">
                                <div class="attr variable">
            <span class="name">mdp_parameters</span><span class="annotation">: Dict[str, Any]</span>

        
    </div>
    <a class="headerlink" href="#SingleInstanceHyperOptConfig.mdp_parameters"></a>
    
            <div class="docstring"><p>The dictionary containing the parameters for the MDP class with respect to whom we are performing the parameters optimization.</p>
</div>


                            </div>
                            <div id="SingleInstanceHyperOptConfig.n_seed" class="classattr">
                                <div class="attr variable">
            <span class="name">n_seed</span><span class="annotation">: int</span>

        
    </div>
    <a class="headerlink" href="#SingleInstanceHyperOptConfig.n_seed"></a>
    
            <div class="docstring"><p>The number of seed the agent/MDP interaction is repeated.</p>
</div>


                            </div>
                            <div id="SingleInstanceHyperOptConfig.optimization_horizon" class="classattr">
                                <div class="attr variable">
            <span class="name">optimization_horizon</span><span class="annotation">: int</span>

        
    </div>
    <a class="headerlink" href="#SingleInstanceHyperOptConfig.optimization_horizon"></a>
    
            <div class="docstring"><p>The optimization horizon of the agent/MDP interaction.</p>
</div>


                            </div>
                            <div id="SingleInstanceHyperOptConfig.num_samples" class="classattr">
                                <div class="attr variable">
            <span class="name">num_samples</span><span class="annotation">: int</span>

        
    </div>
    <a class="headerlink" href="#SingleInstanceHyperOptConfig.num_samples"></a>
    
            <div class="docstring"><p>The number of samples of the agent parameters.</p>
</div>


                            </div>
                            <div id="SingleInstanceHyperOptConfig.max_interaction_s" class="classattr">
                                <div class="attr variable">
            <span class="name">max_interaction_s</span><span class="annotation">: float</span>

        
    </div>
    <a class="headerlink" href="#SingleInstanceHyperOptConfig.max_interaction_s"></a>
    
            <div class="docstring"><p>The maximum amount of seconds allocated to training the agent.</p>
</div>


                            </div>
                            <div id="SingleInstanceHyperOptConfig.log_every" class="classattr">
                                <div class="attr variable">
            <span class="name">log_every</span><span class="annotation">: int</span>

        
    </div>
    <a class="headerlink" href="#SingleInstanceHyperOptConfig.log_every"></a>
    
            <div class="docstring"><p>The length of the interval between logging of the performance indicators.</p>
</div>


                            </div>
                </section>
                <section id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class">
                            <input id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator">@gin.configurable</div>

    <span class="def">class</span>
    <span class="name">SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class</span><wbr>(<span class="base"><a href="../agent/agents/base.html#BaseAgent">colosseum.agent.agents.base.BaseAgent</a></span>):

                <label class="view-source-button" for="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-20"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-20"><span class="linenos"> 20</span></a><span class="nd">@gin</span><span class="o">.</span><span class="n">configurable</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-21"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-21"><span class="linenos"> 21</span></a><span class="k">class</span> <span class="nc">PSRLEpisodic</span><span class="p">(</span><span class="n">BaseAgent</span><span class="p">):</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-22"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-22"><span class="linenos"> 22</span></a>    <span class="sd">&quot;&quot;&quot;</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-23"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-23"><span class="linenos"> 23</span></a><span class="sd">    The posterior sampling for reinforcement learning algorithm.</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-24"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-24"><span class="linenos"> 24</span></a>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-25"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-25"><span class="linenos"> 25</span></a><span class="sd">    Osband, Ian, Daniel Russo, and Benjamin Van Roy. &quot;(More) efficient reinforcement learning via posterior sampling.&quot;</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-26"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-26"><span class="linenos"> 26</span></a><span class="sd">    Advances in Neural Information Processing Systems 26 (2013).</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-27"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-27"><span class="linenos"> 27</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-28"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-28"><span class="linenos"> 28</span></a>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-29"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-29"><span class="linenos"> 29</span></a>    <span class="k">def</span> <span class="nf">step_update</span><span class="p">(</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-30"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-30"><span class="linenos"> 30</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-31"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-31"><span class="linenos"> 31</span></a>        <span class="n">ts_t</span><span class="p">:</span> <span class="n">dm_env</span><span class="o">.</span><span class="n">TimeStep</span><span class="p">,</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-32"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-32"><span class="linenos"> 32</span></a>        <span class="n">a_t</span><span class="p">:</span> <span class="s2">&quot;ACTION_TYPE&quot;</span><span class="p">,</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-33"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-33"><span class="linenos"> 33</span></a>        <span class="n">ts_tp1</span><span class="p">:</span> <span class="n">dm_env</span><span class="o">.</span><span class="n">TimeStep</span><span class="p">,</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-34"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-34"><span class="linenos"> 34</span></a>        <span class="n">time</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-35"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-35"><span class="linenos"> 35</span></a>    <span class="p">):</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-36"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-36"><span class="linenos"> 36</span></a>        <span class="nb">super</span><span class="p">(</span><span class="n">PSRLEpisodic</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">step_update</span><span class="p">(</span><span class="n">ts_t</span><span class="p">,</span> <span class="n">a_t</span><span class="p">,</span> <span class="n">ts_tp1</span><span class="p">,</span> <span class="n">time</span><span class="p">)</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-37"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-37"><span class="linenos"> 37</span></a>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-38"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-38"><span class="linenos"> 38</span></a>    <span class="nd">@staticmethod</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-39"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-39"><span class="linenos"> 39</span></a>    <span class="k">def</span> <span class="nf">is_emission_map_accepted</span><span class="p">(</span><span class="n">emission_map</span><span class="p">:</span> <span class="s2">&quot;EmissionMap&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-40"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-40"><span class="linenos"> 40</span></a>        <span class="k">return</span> <span class="n">emission_map</span><span class="o">.</span><span class="n">is_tabular</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-41"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-41"><span class="linenos"> 41</span></a>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-42"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-42"><span class="linenos"> 42</span></a>    <span class="nd">@staticmethod</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-43"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-43"><span class="linenos"> 43</span></a>    <span class="k">def</span> <span class="nf">produce_gin_file_from_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-44"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-44"><span class="linenos"> 44</span></a>        <span class="k">return</span> <span class="p">(</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-45"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-45"><span class="linenos"> 45</span></a>            <span class="s2">&quot;from colosseum.agent.mdp_models import bayesian_models</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-46"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-46"><span class="linenos"> 46</span></a>            <span class="sa">f</span><span class="s2">&quot;prms_</span><span class="si">{</span><span class="n">index</span><span class="si">}</span><span class="s2">/PSRLEpisodic.reward_prior_model = %bayesian_models.RewardsConjugateModel.N_NIG</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-47"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-47"><span class="linenos"> 47</span></a>            <span class="sa">f</span><span class="s2">&quot;prms_</span><span class="si">{</span><span class="n">index</span><span class="si">}</span><span class="s2">/PSRLEpisodic.transitions_prior_model = %bayesian_models.TransitionsConjugateModel.M_DIR</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-48"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-48"><span class="linenos"> 48</span></a>            <span class="sa">f</span><span class="s2">&quot;prms_</span><span class="si">{</span><span class="n">index</span><span class="si">}</span><span class="s2">/PSRLEpisodic.rewards_prior_prms = [</span><span class="si">{</span><span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;prior_mean&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">, 1, 1, 1]</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-49"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-49"><span class="linenos"> 49</span></a>            <span class="sa">f</span><span class="s2">&quot;prms_</span><span class="si">{</span><span class="n">index</span><span class="si">}</span><span class="s2">/PSRLEpisodic.transitions_prior_prms = [</span><span class="si">{</span><span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;transition_prior&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">]&quot;</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-50"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-50"><span class="linenos"> 50</span></a>        <span class="p">)</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-51"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-51"><span class="linenos"> 51</span></a>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-52"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-52"><span class="linenos"> 52</span></a>    <span class="nd">@staticmethod</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-53"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-53"><span class="linenos"> 53</span></a>    <span class="k">def</span> <span class="nf">is_episodic</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-54"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-54"><span class="linenos"> 54</span></a>        <span class="k">return</span> <span class="kc">True</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-55"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-55"><span class="linenos"> 55</span></a>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-56"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-56"><span class="linenos"> 56</span></a>    <span class="nd">@staticmethod</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-57"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-57"><span class="linenos"> 57</span></a>    <span class="k">def</span> <span class="nf">get_hyperparameters_search_spaces</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">tune</span><span class="o">.</span><span class="n">sample</span><span class="o">.</span><span class="n">Domain</span><span class="p">]:</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-58"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-58"><span class="linenos"> 58</span></a>        <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-59"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-59"><span class="linenos"> 59</span></a>            <span class="n">prior_mean</span><span class="o">=</span><span class="n">tune</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">),</span> <span class="n">transition_prior</span><span class="o">=</span><span class="n">tune</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mf">0.001</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-60"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-60"><span class="linenos"> 60</span></a>        <span class="p">)</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-61"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-61"><span class="linenos"> 61</span></a>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-62"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-62"><span class="linenos"> 62</span></a>    <span class="nd">@staticmethod</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-63"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-63"><span class="linenos"> 63</span></a>    <span class="k">def</span> <span class="nf">get_agent_instance_from_parameters</span><span class="p">(</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-64"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-64"><span class="linenos"> 64</span></a>        <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-65"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-65"><span class="linenos"> 65</span></a>        <span class="n">optimization_horizon</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-66"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-66"><span class="linenos"> 66</span></a>        <span class="n">mdp_specs</span><span class="p">:</span> <span class="n">MDPSpec</span><span class="p">,</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-67"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-67"><span class="linenos"> 67</span></a>        <span class="n">parameters</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-68"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-68"><span class="linenos"> 68</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;BaseAgent&quot;</span><span class="p">:</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-69"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-69"><span class="linenos"> 69</span></a>        <span class="k">return</span> <span class="n">PSRLEpisodic</span><span class="p">(</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-70"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-70"><span class="linenos"> 70</span></a>            <span class="n">mdp_specs</span><span class="o">=</span><span class="n">mdp_specs</span><span class="p">,</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-71"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-71"><span class="linenos"> 71</span></a>            <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-72"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-72"><span class="linenos"> 72</span></a>            <span class="n">optimization_horizon</span><span class="o">=</span><span class="n">optimization_horizon</span><span class="p">,</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-73"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-73"><span class="linenos"> 73</span></a>            <span class="n">reward_prior_model</span><span class="o">=</span><span class="n">RewardsConjugateModel</span><span class="o">.</span><span class="n">N_NIG</span><span class="p">,</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-74"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-74"><span class="linenos"> 74</span></a>            <span class="n">transitions_prior_model</span><span class="o">=</span><span class="n">TransitionsConjugateModel</span><span class="o">.</span><span class="n">M_DIR</span><span class="p">,</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-75"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-75"><span class="linenos"> 75</span></a>            <span class="n">rewards_prior_prms</span><span class="o">=</span><span class="p">[</span><span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;prior_mean&quot;</span><span class="p">],</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-76"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-76"><span class="linenos"> 76</span></a>            <span class="n">transitions_prior_prms</span><span class="o">=</span><span class="p">[</span><span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;transition_prior&quot;</span><span class="p">]],</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-77"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-77"><span class="linenos"> 77</span></a>        <span class="p">)</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-78"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-78"><span class="linenos"> 78</span></a>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-79"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-79"><span class="linenos"> 79</span></a>    <span class="nd">@property</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-80"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-80"><span class="linenos"> 80</span></a>    <span class="k">def</span> <span class="nf">current_optimal_stochastic_policy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-81"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-81"><span class="linenos"> 81</span></a>        <span class="n">T_map</span><span class="p">,</span> <span class="n">R_map</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mdp_model</span><span class="o">.</span><span class="n">get_map_estimate</span><span class="p">()</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-82"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-82"><span class="linenos"> 82</span></a>        <span class="n">Q</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">episodic_value_iteration</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_time_horizon</span><span class="p">,</span> <span class="n">T_map</span><span class="p">,</span> <span class="n">R_map</span><span class="p">)</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-83"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-83"><span class="linenos"> 83</span></a>        <span class="k">return</span> <span class="n">get_policy_from_q_values</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-84"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-84"><span class="linenos"> 84</span></a>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-85"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-85"><span class="linenos"> 85</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-86"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-86"><span class="linenos"> 86</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-87"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-87"><span class="linenos"> 87</span></a>        <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-88"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-88"><span class="linenos"> 88</span></a>        <span class="n">mdp_specs</span><span class="p">:</span> <span class="n">MDPSpec</span><span class="p">,</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-89"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-89"><span class="linenos"> 89</span></a>        <span class="n">optimization_horizon</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-90"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-90"><span class="linenos"> 90</span></a>        <span class="c1"># MDP model parameters</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-91"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-91"><span class="linenos"> 91</span></a>        <span class="n">reward_prior_model</span><span class="p">:</span> <span class="n">RewardsConjugateModel</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-92"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-92"><span class="linenos"> 92</span></a>        <span class="n">transitions_prior_model</span><span class="p">:</span> <span class="n">TransitionsConjugateModel</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-93"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-93"><span class="linenos"> 93</span></a>        <span class="n">rewards_prior_prms</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-94"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-94"><span class="linenos"> 94</span></a>        <span class="n">transitions_prior_prms</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-95"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-95"><span class="linenos"> 95</span></a>        <span class="c1"># Actor parameters</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-96"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-96"><span class="linenos"> 96</span></a>        <span class="n">epsilon_greedy</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-97"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-97"><span class="linenos"> 97</span></a>        <span class="n">boltzmann_temperature</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-98"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-98"><span class="linenos"> 98</span></a>    <span class="p">):</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-99"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-99"><span class="linenos"> 99</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-100"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-100"><span class="linenos">100</span></a>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-101"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-101"><span class="linenos">101</span></a><span class="sd">        Parameters</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-102"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-102"><span class="linenos">102</span></a><span class="sd">        ----------</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-103"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-103"><span class="linenos">103</span></a><span class="sd">        seed : int</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-104"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-104"><span class="linenos">104</span></a><span class="sd">            The random seed.</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-105"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-105"><span class="linenos">105</span></a><span class="sd">        mdp_specs : MDPSpec</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-106"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-106"><span class="linenos">106</span></a><span class="sd">            The full specification of the MDP.</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-107"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-107"><span class="linenos">107</span></a><span class="sd">        optimization_horizon : int</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-108"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-108"><span class="linenos">108</span></a><span class="sd">            The total number of interactions that the agent is expected to have with the MDP.</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-109"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-109"><span class="linenos">109</span></a><span class="sd">        reward_prior_model : RewardsConjugateModel, optional</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-110"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-110"><span class="linenos">110</span></a><span class="sd">            The reward priors.</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-111"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-111"><span class="linenos">111</span></a><span class="sd">        transitions_prior_model : TransitionsConjugateModel, optional</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-112"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-112"><span class="linenos">112</span></a><span class="sd">            The transitions priors.</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-113"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-113"><span class="linenos">113</span></a><span class="sd">        rewards_prior_prms : Any</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-114"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-114"><span class="linenos">114</span></a><span class="sd">            The reward prior parameters.</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-115"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-115"><span class="linenos">115</span></a><span class="sd">        transitions_prior_prms : Any</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-116"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-116"><span class="linenos">116</span></a><span class="sd">            The transitions prior parameters.</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-117"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-117"><span class="linenos">117</span></a><span class="sd">        epsilon_greedy : Union[float, Callable], optional</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-118"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-118"><span class="linenos">118</span></a><span class="sd">            The probability of selecting an action at random. It can be provided as a float or as a function of the</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-119"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-119"><span class="linenos">119</span></a><span class="sd">            total number of interactions. By default, the probability is set to zero.</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-120"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-120"><span class="linenos">120</span></a><span class="sd">        boltzmann_temperature : Union[float, Callable], optional</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-121"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-121"><span class="linenos">121</span></a><span class="sd">            The parameter that controls the Boltzmann exploration. It can be provided as a float or as a function of</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-122"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-122"><span class="linenos">122</span></a><span class="sd">            the total number of interactions. By default, Boltzmann exploration is disabled.</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-123"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-123"><span class="linenos">123</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-124"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-124"><span class="linenos">124</span></a>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-125"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-125"><span class="linenos">125</span></a>        <span class="n">mdp_model</span> <span class="o">=</span> <span class="n">BayesianMDPModel</span><span class="p">(</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-126"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-126"><span class="linenos">126</span></a>            <span class="n">seed</span><span class="p">,</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-127"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-127"><span class="linenos">127</span></a>            <span class="n">mdp_specs</span><span class="p">,</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-128"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-128"><span class="linenos">128</span></a>            <span class="n">reward_prior_model</span><span class="o">=</span><span class="n">reward_prior_model</span><span class="p">,</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-129"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-129"><span class="linenos">129</span></a>            <span class="n">transitions_prior_model</span><span class="o">=</span><span class="n">transitions_prior_model</span><span class="p">,</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-130"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-130"><span class="linenos">130</span></a>            <span class="n">rewards_prior_prms</span><span class="o">=</span><span class="n">rewards_prior_prms</span><span class="p">,</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-131"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-131"><span class="linenos">131</span></a>            <span class="n">transitions_prior_prms</span><span class="o">=</span><span class="n">transitions_prior_prms</span><span class="p">,</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-132"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-132"><span class="linenos">132</span></a>        <span class="p">)</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-133"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-133"><span class="linenos">133</span></a>        <span class="n">actor</span> <span class="o">=</span> <span class="n">QValuesActor</span><span class="p">(</span><span class="n">seed</span><span class="p">,</span> <span class="n">mdp_specs</span><span class="p">,</span> <span class="n">epsilon_greedy</span><span class="p">,</span> <span class="n">boltzmann_temperature</span><span class="p">)</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-134"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-134"><span class="linenos">134</span></a>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-135"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-135"><span class="linenos">135</span></a>        <span class="nb">super</span><span class="p">(</span><span class="n">PSRLEpisodic</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-136"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-136"><span class="linenos">136</span></a>            <span class="n">seed</span><span class="p">,</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-137"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-137"><span class="linenos">137</span></a>            <span class="n">mdp_specs</span><span class="p">,</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-138"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-138"><span class="linenos">138</span></a>            <span class="n">mdp_model</span><span class="p">,</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-139"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-139"><span class="linenos">139</span></a>            <span class="n">actor</span><span class="p">,</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-140"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-140"><span class="linenos">140</span></a>            <span class="n">optimization_horizon</span><span class="p">,</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-141"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-141"><span class="linenos">141</span></a>        <span class="p">)</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-142"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-142"><span class="linenos">142</span></a>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-143"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-143"><span class="linenos">143</span></a>    <span class="k">def</span> <span class="nf">episode_end_update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-144"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-144"><span class="linenos">144</span></a>        <span class="n">Q</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">episodic_value_iteration</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_time_horizon</span><span class="p">,</span> <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_mdp_model</span><span class="o">.</span><span class="n">sample</span><span class="p">())</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-145"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-145"><span class="linenos">145</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_actor</span><span class="o">.</span><span class="n">set_q_values</span><span class="p">(</span><span class="n">Q</span><span class="p">)</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-146"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-146"><span class="linenos">146</span></a>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-147"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-147"><span class="linenos">147</span></a>    <span class="k">def</span> <span class="nf">before_start_interacting</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-148"><a href="#SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class-148"><span class="linenos">148</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">episode_end_update</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>The class of the near optimal agent for the episodic setting. By default, it is <code>PSRLEpisodic</code>.</p>
</div>


                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="../agent/agents/episodic/posterior_sampling.html#PSRLEpisodic">colosseum.agent.agents.episodic.posterior_sampling.PSRLEpisodic</a></dt>
                                <dd id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class.__init__" class="function"><a href="../agent/agents/episodic/posterior_sampling.html#PSRLEpisodic.__init__">PSRLEpisodic</a></dd>
                <dd id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class.step_update" class="function"><a href="../agent/agents/episodic/posterior_sampling.html#PSRLEpisodic.step_update">step_update</a></dd>
                <dd id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class.is_emission_map_accepted" class="function"><a href="../agent/agents/episodic/posterior_sampling.html#PSRLEpisodic.is_emission_map_accepted">is_emission_map_accepted</a></dd>
                <dd id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class.produce_gin_file_from_parameters" class="function"><a href="../agent/agents/episodic/posterior_sampling.html#PSRLEpisodic.produce_gin_file_from_parameters">produce_gin_file_from_parameters</a></dd>
                <dd id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class.is_episodic" class="function"><a href="../agent/agents/episodic/posterior_sampling.html#PSRLEpisodic.is_episodic">is_episodic</a></dd>
                <dd id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class.get_hyperparameters_search_spaces" class="function"><a href="../agent/agents/episodic/posterior_sampling.html#PSRLEpisodic.get_hyperparameters_search_spaces">get_hyperparameters_search_spaces</a></dd>
                <dd id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class.get_agent_instance_from_parameters" class="function"><a href="../agent/agents/episodic/posterior_sampling.html#PSRLEpisodic.get_agent_instance_from_parameters">get_agent_instance_from_parameters</a></dd>
                <dd id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class.current_optimal_stochastic_policy" class="variable"><a href="../agent/agents/episodic/posterior_sampling.html#PSRLEpisodic.current_optimal_stochastic_policy">current_optimal_stochastic_policy</a></dd>
                <dd id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class.episode_end_update" class="function"><a href="../agent/agents/episodic/posterior_sampling.html#PSRLEpisodic.episode_end_update">episode_end_update</a></dd>
                <dd id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class.before_start_interacting" class="function"><a href="../agent/agents/episodic/posterior_sampling.html#PSRLEpisodic.before_start_interacting">before_start_interacting</a></dd>

            </div>
            <div><dt><a href="../agent/agents/base.html#BaseAgent">colosseum.agent.agents.base.BaseAgent</a></dt>
                                <dd id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class.is_episode_end" class="function"><a href="../agent/agents/base.html#BaseAgent.is_episode_end">is_episode_end</a></dd>
                <dd id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class.select_action" class="function"><a href="../agent/agents/base.html#BaseAgent.select_action">select_action</a></dd>
                <dd id="SingleInstanceHyperOptConfig.episodic_near_optimal_agent_class.agent_logs" class="function"><a href="../agent/agents/base.html#BaseAgent.agent_logs">agent_logs</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class">
                            <input id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator">@gin.configurable</div>

    <span class="def">class</span>
    <span class="name">SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class</span><wbr>(<span class="base"><a href="../agent/agents/base.html#BaseAgent">colosseum.agent.agents.base.BaseAgent</a></span>):

                <label class="view-source-button" for="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-34"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-34"><span class="linenos"> 34</span></a><span class="nd">@gin</span><span class="o">.</span><span class="n">configurable</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-35"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-35"><span class="linenos"> 35</span></a><span class="k">class</span> <span class="nc">UCRL2Continuous</span><span class="p">(</span><span class="n">BaseAgent</span><span class="p">):</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-36"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-36"><span class="linenos"> 36</span></a>    <span class="sd">&quot;&quot;&quot;</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-37"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-37"><span class="linenos"> 37</span></a><span class="sd">    The second version of upper confidence for reinforcement learning algorithm.</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-38"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-38"><span class="linenos"> 38</span></a>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-39"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-39"><span class="linenos"> 39</span></a><span class="sd">    Auer, Peter, Thomas Jaksch, and Ronald Ortner. &quot;Near-optimal regret bounds for reinforcement learning.&quot; Advances in</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-40"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-40"><span class="linenos"> 40</span></a><span class="sd">    neural information processing systems 21 (2008).</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-41"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-41"><span class="linenos"> 41</span></a>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-42"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-42"><span class="linenos"> 42</span></a><span class="sd">    Fruit, Ronan, Matteo Pirotta, and Alessandro Lazaric. &quot;Improved analysis of ucrl2 with empirical bernstein inequality.&quot;</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-43"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-43"><span class="linenos"> 43</span></a><span class="sd">    arXiv preprint arXiv:2007.05456 (2020).</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-44"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-44"><span class="linenos"> 44</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-45"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-45"><span class="linenos"> 45</span></a>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-46"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-46"><span class="linenos"> 46</span></a>    <span class="nd">@staticmethod</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-47"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-47"><span class="linenos"> 47</span></a>    <span class="k">def</span> <span class="nf">is_emission_map_accepted</span><span class="p">(</span><span class="n">emission_map</span><span class="p">:</span> <span class="s2">&quot;EmissionMap&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-48"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-48"><span class="linenos"> 48</span></a>        <span class="k">return</span> <span class="n">emission_map</span><span class="o">.</span><span class="n">is_tabular</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-49"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-49"><span class="linenos"> 49</span></a>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-50"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-50"><span class="linenos"> 50</span></a>    <span class="nd">@staticmethod</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-51"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-51"><span class="linenos"> 51</span></a>    <span class="k">def</span> <span class="nf">produce_gin_file_from_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-52"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-52"><span class="linenos"> 52</span></a>        <span class="n">string</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;prms_</span><span class="si">{</span><span class="n">index</span><span class="si">}</span><span class="s2">/UCRL2Continuous.bound_type_p=&#39;bernstein&#39;</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-53"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-53"><span class="linenos"> 53</span></a>        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">parameters</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-54"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-54"><span class="linenos"> 54</span></a>            <span class="n">string</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;prms_</span><span class="si">{</span><span class="n">index</span><span class="si">}</span><span class="s2">/UCRL2Continuous.</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-55"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-55"><span class="linenos"> 55</span></a>        <span class="k">return</span> <span class="n">string</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-56"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-56"><span class="linenos"> 56</span></a>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-57"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-57"><span class="linenos"> 57</span></a>    <span class="nd">@staticmethod</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-58"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-58"><span class="linenos"> 58</span></a>    <span class="k">def</span> <span class="nf">is_episodic</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-59"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-59"><span class="linenos"> 59</span></a>        <span class="k">return</span> <span class="kc">False</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-60"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-60"><span class="linenos"> 60</span></a>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-61"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-61"><span class="linenos"> 61</span></a>    <span class="nd">@staticmethod</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-62"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-62"><span class="linenos"> 62</span></a>    <span class="k">def</span> <span class="nf">get_hyperparameters_search_spaces</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">tune</span><span class="o">.</span><span class="n">sample</span><span class="o">.</span><span class="n">Domain</span><span class="p">]:</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-63"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-63"><span class="linenos"> 63</span></a>        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;alpha_p&quot;</span><span class="p">:</span> <span class="n">tune</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="s2">&quot;alpha_r&quot;</span><span class="p">:</span> <span class="n">tune</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)}</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-64"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-64"><span class="linenos"> 64</span></a>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-65"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-65"><span class="linenos"> 65</span></a>    <span class="nd">@staticmethod</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-66"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-66"><span class="linenos"> 66</span></a>    <span class="k">def</span> <span class="nf">get_agent_instance_from_parameters</span><span class="p">(</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-67"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-67"><span class="linenos"> 67</span></a>        <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-68"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-68"><span class="linenos"> 68</span></a>        <span class="n">optimization_horizon</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-69"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-69"><span class="linenos"> 69</span></a>        <span class="n">mdp_specs</span><span class="p">:</span> <span class="s2">&quot;MDPSpec&quot;</span><span class="p">,</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-70"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-70"><span class="linenos"> 70</span></a>        <span class="n">parameters</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-71"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-71"><span class="linenos"> 71</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;BaseAgent&quot;</span><span class="p">:</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-72"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-72"><span class="linenos"> 72</span></a>        <span class="k">return</span> <span class="n">UCRL2Continuous</span><span class="p">(</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-73"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-73"><span class="linenos"> 73</span></a>            <span class="n">mdp_specs</span><span class="o">=</span><span class="n">mdp_specs</span><span class="p">,</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-74"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-74"><span class="linenos"> 74</span></a>            <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-75"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-75"><span class="linenos"> 75</span></a>            <span class="n">optimization_horizon</span><span class="o">=</span><span class="n">optimization_horizon</span><span class="p">,</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-76"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-76"><span class="linenos"> 76</span></a>            <span class="n">alpha_p</span><span class="o">=</span><span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;alpha_p&quot;</span><span class="p">],</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-77"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-77"><span class="linenos"> 77</span></a>            <span class="n">alpha_r</span><span class="o">=</span><span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;alpha_r&quot;</span><span class="p">],</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-78"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-78"><span class="linenos"> 78</span></a>            <span class="n">bound_type_p</span><span class="o">=</span><span class="s2">&quot;bernstein&quot;</span><span class="p">,</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-79"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-79"><span class="linenos"> 79</span></a>        <span class="p">)</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-80"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-80"><span class="linenos"> 80</span></a>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-81"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-81"><span class="linenos"> 81</span></a>    <span class="nd">@property</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-82"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-82"><span class="linenos"> 82</span></a>    <span class="k">def</span> <span class="nf">current_optimal_stochastic_policy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-83"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-83"><span class="linenos"> 83</span></a>        <span class="n">Q</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">discounted_value_iteration</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimated_rewards</span><span class="p">)</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-84"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-84"><span class="linenos"> 84</span></a>        <span class="k">return</span> <span class="n">get_policy_from_q_values</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-85"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-85"><span class="linenos"> 85</span></a>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-86"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-86"><span class="linenos"> 86</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-87"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-87"><span class="linenos"> 87</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-88"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-88"><span class="linenos"> 88</span></a>        <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-89"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-89"><span class="linenos"> 89</span></a>        <span class="n">mdp_specs</span><span class="p">:</span> <span class="s2">&quot;MDPSpec&quot;</span><span class="p">,</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-90"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-90"><span class="linenos"> 90</span></a>        <span class="n">optimization_horizon</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-91"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-91"><span class="linenos"> 91</span></a>        <span class="c1"># MDP model parameters</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-92"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-92"><span class="linenos"> 92</span></a>        <span class="n">alpha_r</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-93"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-93"><span class="linenos"> 93</span></a>        <span class="n">alpha_p</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-94"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-94"><span class="linenos"> 94</span></a>        <span class="n">bound_type_p</span><span class="o">=</span><span class="s2">&quot;_chernoff&quot;</span><span class="p">,</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-95"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-95"><span class="linenos"> 95</span></a>        <span class="n">bound_type_rew</span><span class="o">=</span><span class="s2">&quot;_chernoff&quot;</span><span class="p">,</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-96"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-96"><span class="linenos"> 96</span></a>        <span class="c1"># Actor parameters</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-97"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-97"><span class="linenos"> 97</span></a>        <span class="n">epsilon_greedy</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-98"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-98"><span class="linenos"> 98</span></a>        <span class="n">boltzmann_temperature</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-99"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-99"><span class="linenos"> 99</span></a>    <span class="p">):</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-100"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-100"><span class="linenos">100</span></a>        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-101"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-101"><span class="linenos">101</span></a><span class="sd">        Parameters</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-102"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-102"><span class="linenos">102</span></a><span class="sd">        ----------</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-103"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-103"><span class="linenos">103</span></a><span class="sd">        seed : int</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-104"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-104"><span class="linenos">104</span></a><span class="sd">            The random seed.</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-105"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-105"><span class="linenos">105</span></a><span class="sd">        mdp_specs : MDPSpec</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-106"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-106"><span class="linenos">106</span></a><span class="sd">            The full specification of the MDP.</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-107"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-107"><span class="linenos">107</span></a><span class="sd">        optimization_horizon : int</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-108"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-108"><span class="linenos">108</span></a><span class="sd">            The total number of interactions that the agent is expected to have with the MDP.</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-109"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-109"><span class="linenos">109</span></a><span class="sd">        alpha_r : float</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-110"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-110"><span class="linenos">110</span></a><span class="sd">            The :math:`\alpha` parameter for the rewards. By default, it is set to one.</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-111"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-111"><span class="linenos">111</span></a><span class="sd">        alpha_p : float</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-112"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-112"><span class="linenos">112</span></a><span class="sd">            The :math:`\alpha` parameter for the transitions. By default, it is set to one.</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-113"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-113"><span class="linenos">113</span></a><span class="sd">        bound_type_p : str</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-114"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-114"><span class="linenos">114</span></a><span class="sd">            The upper confidence bound type for the transitions. It can either be &#39;_chernoff&#39; or &#39;bernstein&#39;. By default,</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-115"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-115"><span class="linenos">115</span></a><span class="sd">            it is set to &#39;_chernoff&#39;.</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-116"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-116"><span class="linenos">116</span></a><span class="sd">        bound_type_rew : str</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-117"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-117"><span class="linenos">117</span></a><span class="sd">            The upper confidence bound type for the rewards. It can either be &#39;_chernoff&#39; or &#39;bernstein&#39;. By default,</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-118"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-118"><span class="linenos">118</span></a><span class="sd">            it is set to &#39;_chernoff&#39;.</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-119"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-119"><span class="linenos">119</span></a><span class="sd">        epsilon_greedy : Union[float, Callable], optional</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-120"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-120"><span class="linenos">120</span></a><span class="sd">            The probability of selecting an action at random. It can be provided as a float or as a function of the</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-121"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-121"><span class="linenos">121</span></a><span class="sd">            total number of interactions. By default, the probability is set to zero.</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-122"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-122"><span class="linenos">122</span></a><span class="sd">        boltzmann_temperature : Union[float, Callable], optional</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-123"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-123"><span class="linenos">123</span></a><span class="sd">            The parameter that controls the Boltzmann exploration. It can be provided as a float or as a function of</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-124"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-124"><span class="linenos">124</span></a><span class="sd">            the total number of interactions. By default, Boltzmann exploration is disabled.</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-125"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-125"><span class="linenos">125</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-126"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-126"><span class="linenos">126</span></a>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-127"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-127"><span class="linenos">127</span></a>        <span class="n">n_states</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n_states</span> <span class="o">=</span> <span class="n">mdp_specs</span><span class="o">.</span><span class="n">observations</span><span class="o">.</span><span class="n">num_values</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-128"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-128"><span class="linenos">128</span></a>        <span class="n">n_actions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n_actions</span> <span class="o">=</span> <span class="n">mdp_specs</span><span class="o">.</span><span class="n">actions</span><span class="o">.</span><span class="n">num_values</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-129"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-129"><span class="linenos">129</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">reward_range</span> <span class="o">=</span> <span class="n">mdp_specs</span><span class="o">.</span><span class="n">rewards_range</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-130"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-130"><span class="linenos">130</span></a>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-131"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-131"><span class="linenos">131</span></a>        <span class="k">assert</span> <span class="n">bound_type_p</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;_chernoff&quot;</span><span class="p">,</span> <span class="s2">&quot;bernstein&quot;</span><span class="p">]</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-132"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-132"><span class="linenos">132</span></a>        <span class="k">assert</span> <span class="n">bound_type_rew</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;_chernoff&quot;</span><span class="p">,</span> <span class="s2">&quot;bernstein&quot;</span><span class="p">]</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-133"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-133"><span class="linenos">133</span></a>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-134"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-134"><span class="linenos">134</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">alpha_p</span> <span class="o">=</span> <span class="n">alpha_p</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-135"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-135"><span class="linenos">135</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">alpha_r</span> <span class="o">=</span> <span class="n">alpha_r</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-136"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-136"><span class="linenos">136</span></a>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-137"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-137"><span class="linenos">137</span></a>        <span class="c1"># initialize matrices</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-138"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-138"><span class="linenos">138</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">policy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_states</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int_</span><span class="p">)</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-139"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-139"><span class="linenos">139</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">policy_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_states</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int_</span><span class="p">)</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-140"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-140"><span class="linenos">140</span></a>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-141"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-141"><span class="linenos">141</span></a>        <span class="c1"># initialization</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-142"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-142"><span class="linenos">142</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">iteration</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-143"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-143"><span class="linenos">143</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">episode</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-144"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-144"><span class="linenos">144</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">delta</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># confidence</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-145"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-145"><span class="linenos">145</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bound_type_p</span> <span class="o">=</span> <span class="n">bound_type_p</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-146"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-146"><span class="linenos">146</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bound_type_rew</span> <span class="o">=</span> <span class="n">bound_type_rew</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-147"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-147"><span class="linenos">147</span></a>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-148"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-148"><span class="linenos">148</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">P</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">n_states</span><span class="p">,</span> <span class="n">n_actions</span><span class="p">,</span> <span class="n">n_states</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span> <span class="o">/</span> <span class="n">n_states</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-149"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-149"><span class="linenos">149</span></a>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-150"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-150"><span class="linenos">150</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">estimated_rewards</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-151"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-151"><span class="linenos">151</span></a>            <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">n_states</span><span class="p">,</span> <span class="n">n_actions</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span> <span class="o">*</span> <span class="n">mdp_specs</span><span class="o">.</span><span class="n">rewards_range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-152"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-152"><span class="linenos">152</span></a>        <span class="p">)</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-153"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-153"><span class="linenos">153</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">variance_proxy_reward</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_states</span><span class="p">,</span> <span class="n">n_actions</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-154"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-154"><span class="linenos">154</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">estimated_holding_times</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">n_states</span><span class="p">,</span> <span class="n">n_actions</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-155"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-155"><span class="linenos">155</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">N</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_states</span><span class="p">,</span> <span class="n">n_actions</span><span class="p">,</span> <span class="n">n_states</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-156"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-156"><span class="linenos">156</span></a>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-157"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-157"><span class="linenos">157</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">current_state</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-158"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-158"><span class="linenos">158</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">artificial_episode</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-159"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-159"><span class="linenos">159</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">episode_reward_data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-160"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-160"><span class="linenos">160</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">episode_transition_data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-161"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-161"><span class="linenos">161</span></a>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-162"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-162"><span class="linenos">162</span></a>        <span class="nb">super</span><span class="p">(</span><span class="n">UCRL2Continuous</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-163"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-163"><span class="linenos">163</span></a>            <span class="n">seed</span><span class="p">,</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-164"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-164"><span class="linenos">164</span></a>            <span class="n">mdp_specs</span><span class="p">,</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-165"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-165"><span class="linenos">165</span></a>            <span class="kc">None</span><span class="p">,</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-166"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-166"><span class="linenos">166</span></a>            <span class="n">QValuesActor</span><span class="p">(</span><span class="n">seed</span><span class="p">,</span> <span class="n">mdp_specs</span><span class="p">,</span> <span class="n">epsilon_greedy</span><span class="p">,</span> <span class="n">boltzmann_temperature</span><span class="p">),</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-167"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-167"><span class="linenos">167</span></a>            <span class="n">optimization_horizon</span><span class="p">,</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-168"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-168"><span class="linenos">168</span></a>        <span class="p">)</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-169"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-169"><span class="linenos">169</span></a>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-170"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-170"><span class="linenos">170</span></a>    <span class="k">def</span> <span class="nf">is_episode_end</span><span class="p">(</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-171"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-171"><span class="linenos">171</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-172"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-172"><span class="linenos">172</span></a>        <span class="n">ts_t</span><span class="p">:</span> <span class="n">dm_env</span><span class="o">.</span><span class="n">TimeStep</span><span class="p">,</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-173"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-173"><span class="linenos">173</span></a>        <span class="n">a_t</span><span class="p">:</span> <span class="s2">&quot;ACTION_TYPE&quot;</span><span class="p">,</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-174"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-174"><span class="linenos">174</span></a>        <span class="n">ts_tp1</span><span class="p">:</span> <span class="n">dm_env</span><span class="o">.</span><span class="n">TimeStep</span><span class="p">,</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-175"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-175"><span class="linenos">175</span></a>        <span class="n">time</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-176"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-176"><span class="linenos">176</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-177"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-177"><span class="linenos">177</span></a>        <span class="n">nu_k</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">episode_transition_data</span><span class="p">[</span><span class="n">ts_t</span><span class="o">.</span><span class="n">observation</span><span class="p">,</span> <span class="n">a_t</span><span class="p">])</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-178"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-178"><span class="linenos">178</span></a>        <span class="k">return</span> <span class="n">nu_k</span> <span class="o">&gt;=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">N</span><span class="p">[</span><span class="n">ts_t</span><span class="o">.</span><span class="n">observation</span><span class="p">,</span> <span class="n">a_t</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">-</span> <span class="n">nu_k</span><span class="p">)</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-179"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-179"><span class="linenos">179</span></a>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-180"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-180"><span class="linenos">180</span></a>    <span class="k">def</span> <span class="nf">episode_end_update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-181"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-181"><span class="linenos">181</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">episode</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-182"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-182"><span class="linenos">182</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">delta</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">iteration</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-183"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-183"><span class="linenos">183</span></a>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-184"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-184"><span class="linenos">184</span></a>        <span class="n">new_sp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">solve_optimistic_model</span><span class="p">()</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-185"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-185"><span class="linenos">185</span></a>        <span class="k">if</span> <span class="n">new_sp</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-186"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-186"><span class="linenos">186</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">span_value</span> <span class="o">=</span> <span class="n">new_sp</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">reward_range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-187"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-187"><span class="linenos">187</span></a>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-188"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-188"><span class="linenos">188</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">episode_transition_data</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-189"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-189"><span class="linenos">189</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">model_update</span><span class="p">()</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-190"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-190"><span class="linenos">190</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">episode_reward_data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-191"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-191"><span class="linenos">191</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">episode_transition_data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-192"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-192"><span class="linenos">192</span></a>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-193"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-193"><span class="linenos">193</span></a>    <span class="k">def</span> <span class="nf">before_start_interacting</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-194"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-194"><span class="linenos">194</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">episode_end_update</span><span class="p">()</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-195"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-195"><span class="linenos">195</span></a>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-196"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-196"><span class="linenos">196</span></a>    <span class="k">def</span> <span class="nf">step_update</span><span class="p">(</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-197"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-197"><span class="linenos">197</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">ts_t</span><span class="p">:</span> <span class="n">dm_env</span><span class="o">.</span><span class="n">TimeStep</span><span class="p">,</span> <span class="n">a_t</span><span class="p">:</span> <span class="s2">&quot;ACTION_TYPE&quot;</span><span class="p">,</span> <span class="n">ts_tp1</span><span class="p">:</span> <span class="n">dm_env</span><span class="o">.</span><span class="n">TimeStep</span><span class="p">,</span> <span class="n">h</span><span class="p">:</span> <span class="nb">int</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-198"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-198"><span class="linenos">198</span></a>    <span class="p">):</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-199"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-199"><span class="linenos">199</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">N</span><span class="p">[</span><span class="n">ts_t</span><span class="o">.</span><span class="n">observation</span><span class="p">,</span> <span class="n">a_t</span><span class="p">,</span> <span class="n">ts_tp1</span><span class="o">.</span><span class="n">observation</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-200"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-200"><span class="linenos">200</span></a>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-201"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-201"><span class="linenos">201</span></a>        <span class="k">if</span> <span class="p">(</span><span class="n">ts_t</span><span class="o">.</span><span class="n">observation</span><span class="p">,</span> <span class="n">a_t</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">episode_reward_data</span><span class="p">:</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-202"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-202"><span class="linenos">202</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">episode_reward_data</span><span class="p">[</span><span class="n">ts_t</span><span class="o">.</span><span class="n">observation</span><span class="p">,</span> <span class="n">a_t</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ts_tp1</span><span class="o">.</span><span class="n">reward</span><span class="p">)</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-203"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-203"><span class="linenos">203</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">ts_tp1</span><span class="o">.</span><span class="n">last</span><span class="p">():</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-204"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-204"><span class="linenos">204</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">episode_transition_data</span><span class="p">[</span><span class="n">ts_t</span><span class="o">.</span><span class="n">observation</span><span class="p">,</span> <span class="n">a_t</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-205"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-205"><span class="linenos">205</span></a>                    <span class="n">ts_tp1</span><span class="o">.</span><span class="n">observation</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-206"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-206"><span class="linenos">206</span></a>                <span class="p">)</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-207"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-207"><span class="linenos">207</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-208"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-208"><span class="linenos">208</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">episode_reward_data</span><span class="p">[</span><span class="n">ts_t</span><span class="o">.</span><span class="n">observation</span><span class="p">,</span> <span class="n">a_t</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">ts_tp1</span><span class="o">.</span><span class="n">reward</span><span class="p">]</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-209"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-209"><span class="linenos">209</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">ts_tp1</span><span class="o">.</span><span class="n">last</span><span class="p">():</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-210"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-210"><span class="linenos">210</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">episode_transition_data</span><span class="p">[</span><span class="n">ts_t</span><span class="o">.</span><span class="n">observation</span><span class="p">,</span> <span class="n">a_t</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-211"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-211"><span class="linenos">211</span></a>                    <span class="n">ts_tp1</span><span class="o">.</span><span class="n">observation</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-212"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-212"><span class="linenos">212</span></a>                <span class="p">]</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-213"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-213"><span class="linenos">213</span></a>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-214"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-214"><span class="linenos">214</span></a>    <span class="k">def</span> <span class="nf">model_update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-215"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-215"><span class="linenos">215</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-216"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-216"><span class="linenos">216</span></a><span class="sd">        updates the model given the transitions obtained during the artificial episode.</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-217"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-217"><span class="linenos">217</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-218"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-218"><span class="linenos">218</span></a>        <span class="k">for</span> <span class="p">(</span><span class="n">s_tm1</span><span class="p">,</span> <span class="n">action</span><span class="p">),</span> <span class="n">r_ts</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">episode_reward_data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-219"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-219"><span class="linenos">219</span></a>            <span class="c1"># updated observations</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-220"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-220"><span class="linenos">220</span></a>            <span class="n">scale_f</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">N</span><span class="p">[</span><span class="n">s_tm1</span><span class="p">,</span> <span class="n">action</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-221"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-221"><span class="linenos">221</span></a>            <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">r_ts</span><span class="p">:</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-222"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-222"><span class="linenos">222</span></a>                <span class="c1"># update the number of total iterations</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-223"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-223"><span class="linenos">223</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">iteration</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-224"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-224"><span class="linenos">224</span></a>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-225"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-225"><span class="linenos">225</span></a>                <span class="c1"># update reward and variance estimate</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-226"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-226"><span class="linenos">226</span></a>                <span class="n">scale_f</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-227"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-227"><span class="linenos">227</span></a>                <span class="n">old_estimated_reward</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimated_rewards</span><span class="p">[</span><span class="n">s_tm1</span><span class="p">,</span> <span class="n">action</span><span class="p">]</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-228"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-228"><span class="linenos">228</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">estimated_rewards</span><span class="p">[</span><span class="n">s_tm1</span><span class="p">,</span> <span class="n">action</span><span class="p">]</span> <span class="o">*=</span> <span class="n">scale_f</span> <span class="o">/</span> <span class="p">(</span><span class="n">scale_f</span> <span class="o">+</span> <span class="mf">1.0</span><span class="p">)</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-229"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-229"><span class="linenos">229</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">estimated_rewards</span><span class="p">[</span><span class="n">s_tm1</span><span class="p">,</span> <span class="n">action</span><span class="p">]</span> <span class="o">+=</span> <span class="n">r</span> <span class="o">/</span> <span class="p">(</span><span class="n">scale_f</span> <span class="o">+</span> <span class="mf">1.0</span><span class="p">)</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-230"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-230"><span class="linenos">230</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">variance_proxy_reward</span><span class="p">[</span><span class="n">s_tm1</span><span class="p">,</span> <span class="n">action</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-231"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-231"><span class="linenos">231</span></a>                    <span class="n">r</span> <span class="o">-</span> <span class="n">old_estimated_reward</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-232"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-232"><span class="linenos">232</span></a>                <span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">r</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimated_rewards</span><span class="p">[</span><span class="n">s_tm1</span><span class="p">,</span> <span class="n">action</span><span class="p">])</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-233"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-233"><span class="linenos">233</span></a>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-234"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-234"><span class="linenos">234</span></a>                <span class="c1"># update holding time</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-235"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-235"><span class="linenos">235</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">estimated_holding_times</span><span class="p">[</span><span class="n">s_tm1</span><span class="p">,</span> <span class="n">action</span><span class="p">]</span> <span class="o">*=</span> <span class="n">scale_f</span> <span class="o">/</span> <span class="p">(</span><span class="n">scale_f</span> <span class="o">+</span> <span class="mf">1.0</span><span class="p">)</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-236"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-236"><span class="linenos">236</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">estimated_holding_times</span><span class="p">[</span><span class="n">s_tm1</span><span class="p">,</span> <span class="n">action</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="n">scale_f</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-237"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-237"><span class="linenos">237</span></a>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-238"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-238"><span class="linenos">238</span></a>        <span class="k">for</span> <span class="p">(</span><span class="n">s_tm1</span><span class="p">,</span> <span class="n">action</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">episode_transition_data</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-239"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-239"><span class="linenos">239</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="p">[</span><span class="n">s_tm1</span><span class="p">,</span> <span class="n">action</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">N</span><span class="p">[</span><span class="n">s_tm1</span><span class="p">,</span> <span class="n">action</span><span class="p">]</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">N</span><span class="p">[</span><span class="n">s_tm1</span><span class="p">,</span> <span class="n">action</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-240"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-240"><span class="linenos">240</span></a>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-241"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-241"><span class="linenos">241</span></a>    <span class="k">def</span> <span class="nf">beta_r</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nb_observations</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-242"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-242"><span class="linenos">242</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-243"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-243"><span class="linenos">243</span></a><span class="sd">        calculates the confidence bounds on the reward.</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-244"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-244"><span class="linenos">244</span></a><span class="sd">        Returns</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-245"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-245"><span class="linenos">245</span></a><span class="sd">        -------</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-246"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-246"><span class="linenos">246</span></a><span class="sd">        np.array</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-247"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-247"><span class="linenos">247</span></a><span class="sd">            The vector of confidence bounds on the reward function (|S| x |A|)</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-248"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-248"><span class="linenos">248</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-249"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-249"><span class="linenos">249</span></a>        <span class="n">S</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n_states</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-250"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-250"><span class="linenos">250</span></a>        <span class="n">A</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n_actions</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-251"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-251"><span class="linenos">251</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">bound_type_rew</span> <span class="o">!=</span> <span class="s2">&quot;bernstein&quot;</span><span class="p">:</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-252"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-252"><span class="linenos">252</span></a>            <span class="n">ci</span> <span class="o">=</span> <span class="n">_chernoff</span><span class="p">(</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-253"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-253"><span class="linenos">253</span></a>                <span class="n">it</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">iteration</span><span class="p">,</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-254"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-254"><span class="linenos">254</span></a>                <span class="n">N</span><span class="o">=</span><span class="n">nb_observations</span><span class="p">,</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-255"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-255"><span class="linenos">255</span></a>                <span class="nb">range</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">reward_range</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-256"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-256"><span class="linenos">256</span></a>                <span class="n">delta</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">delta</span><span class="p">,</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-257"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-257"><span class="linenos">257</span></a>                <span class="n">sqrt_C</span><span class="o">=</span><span class="mf">3.5</span><span class="p">,</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-258"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-258"><span class="linenos">258</span></a>                <span class="n">log_C</span><span class="o">=</span><span class="mi">2</span> <span class="o">*</span> <span class="n">S</span> <span class="o">*</span> <span class="n">A</span><span class="p">,</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-259"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-259"><span class="linenos">259</span></a>            <span class="p">)</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-260"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-260"><span class="linenos">260</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha_r</span> <span class="o">*</span> <span class="n">ci</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-261"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-261"><span class="linenos">261</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-262"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-262"><span class="linenos">262</span></a>            <span class="n">N</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">nb_observations</span><span class="p">)</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-263"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-263"><span class="linenos">263</span></a>            <span class="n">Nm1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">nb_observations</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-264"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-264"><span class="linenos">264</span></a>            <span class="n">var_r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">variance_proxy_reward</span> <span class="o">/</span> <span class="n">Nm1</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-265"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-265"><span class="linenos">265</span></a>            <span class="n">log_value</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">S</span> <span class="o">*</span> <span class="n">A</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">iteration</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">delta</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-266"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-266"><span class="linenos">266</span></a>            <span class="n">beta</span> <span class="o">=</span> <span class="n">bernstein</span><span class="p">(</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-267"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-267"><span class="linenos">267</span></a>                <span class="n">scale_a</span><span class="o">=</span><span class="mi">14</span> <span class="o">*</span> <span class="n">var_r</span> <span class="o">/</span> <span class="n">N</span><span class="p">,</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-268"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-268"><span class="linenos">268</span></a>                <span class="n">log_scale_a</span><span class="o">=</span><span class="n">log_value</span><span class="p">,</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-269"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-269"><span class="linenos">269</span></a>                <span class="n">scale_b</span><span class="o">=</span><span class="mf">49.0</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">r_max</span> <span class="o">/</span> <span class="p">(</span><span class="mf">3.0</span> <span class="o">*</span> <span class="n">Nm1</span><span class="p">),</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-270"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-270"><span class="linenos">270</span></a>                <span class="n">log_scale_b</span><span class="o">=</span><span class="n">log_value</span><span class="p">,</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-271"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-271"><span class="linenos">271</span></a>                <span class="n">alpha_1</span><span class="o">=</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alpha_r</span><span class="p">),</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-272"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-272"><span class="linenos">272</span></a>                <span class="n">alpha_2</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">alpha_r</span><span class="p">,</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-273"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-273"><span class="linenos">273</span></a>            <span class="p">)</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-274"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-274"><span class="linenos">274</span></a>            <span class="k">return</span> <span class="n">beta</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-275"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-275"><span class="linenos">275</span></a>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-276"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-276"><span class="linenos">276</span></a>    <span class="k">def</span> <span class="nf">beta_p</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nb_observations</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-277"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-277"><span class="linenos">277</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-278"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-278"><span class="linenos">278</span></a><span class="sd">        calculates the confidence bounds on the transition probabilities.</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-279"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-279"><span class="linenos">279</span></a><span class="sd">        Returns</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-280"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-280"><span class="linenos">280</span></a><span class="sd">        -------</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-281"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-281"><span class="linenos">281</span></a><span class="sd">        np.array</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-282"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-282"><span class="linenos">282</span></a><span class="sd">            The vector of confidence bounds on the reward function (|S| x |A|)</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-283"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-283"><span class="linenos">283</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-284"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-284"><span class="linenos">284</span></a>        <span class="n">S</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n_states</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-285"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-285"><span class="linenos">285</span></a>        <span class="n">A</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n_actions</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-286"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-286"><span class="linenos">286</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">bound_type_p</span> <span class="o">!=</span> <span class="s2">&quot;bernstein&quot;</span><span class="p">:</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-287"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-287"><span class="linenos">287</span></a>            <span class="n">beta</span> <span class="o">=</span> <span class="n">_chernoff</span><span class="p">(</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-288"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-288"><span class="linenos">288</span></a>                <span class="n">it</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">iteration</span><span class="p">,</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-289"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-289"><span class="linenos">289</span></a>                <span class="n">N</span><span class="o">=</span><span class="n">nb_observations</span><span class="p">,</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-290"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-290"><span class="linenos">290</span></a>                <span class="nb">range</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-291"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-291"><span class="linenos">291</span></a>                <span class="n">delta</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">delta</span><span class="p">,</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-292"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-292"><span class="linenos">292</span></a>                <span class="n">sqrt_C</span><span class="o">=</span><span class="mi">14</span> <span class="o">*</span> <span class="n">S</span><span class="p">,</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-293"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-293"><span class="linenos">293</span></a>                <span class="n">log_C</span><span class="o">=</span><span class="mi">2</span> <span class="o">*</span> <span class="n">A</span><span class="p">,</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-294"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-294"><span class="linenos">294</span></a>            <span class="p">)</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-295"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-295"><span class="linenos">295</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha_p</span> <span class="o">*</span> <span class="n">beta</span><span class="o">.</span><span class="n">reshape</span><span class="p">([</span><span class="n">S</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-296"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-296"><span class="linenos">296</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-297"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-297"><span class="linenos">297</span></a>            <span class="n">N</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">nb_observations</span><span class="p">)</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-298"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-298"><span class="linenos">298</span></a>            <span class="n">Nm1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">nb_observations</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-299"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-299"><span class="linenos">299</span></a>            <span class="n">var_p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">P</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="p">)</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-300"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-300"><span class="linenos">300</span></a>            <span class="n">log_value</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">S</span> <span class="o">*</span> <span class="n">A</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">iteration</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">delta</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-301"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-301"><span class="linenos">301</span></a>            <span class="n">beta</span> <span class="o">=</span> <span class="n">bernstein</span><span class="p">(</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-302"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-302"><span class="linenos">302</span></a>                <span class="n">scale_a</span><span class="o">=</span><span class="mi">14</span> <span class="o">*</span> <span class="n">var_p</span> <span class="o">/</span> <span class="n">N</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">],</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-303"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-303"><span class="linenos">303</span></a>                <span class="n">log_scale_a</span><span class="o">=</span><span class="n">log_value</span><span class="p">,</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-304"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-304"><span class="linenos">304</span></a>                <span class="n">scale_b</span><span class="o">=</span><span class="mf">49.0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">3.0</span> <span class="o">*</span> <span class="n">Nm1</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]),</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-305"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-305"><span class="linenos">305</span></a>                <span class="n">log_scale_b</span><span class="o">=</span><span class="n">log_value</span><span class="p">,</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-306"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-306"><span class="linenos">306</span></a>                <span class="n">alpha_1</span><span class="o">=</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alpha_p</span><span class="p">),</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-307"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-307"><span class="linenos">307</span></a>                <span class="n">alpha_2</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">alpha_p</span><span class="p">,</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-308"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-308"><span class="linenos">308</span></a>            <span class="p">)</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-309"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-309"><span class="linenos">309</span></a>            <span class="k">return</span> <span class="n">beta</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-310"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-310"><span class="linenos">310</span></a>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-311"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-311"><span class="linenos">311</span></a>    <span class="k">def</span> <span class="nf">solve_optimistic_model</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-312"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-312"><span class="linenos">312</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-313"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-313"><span class="linenos">313</span></a><span class="sd">        solves the optimistic value iteration.</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-314"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-314"><span class="linenos">314</span></a><span class="sd">        Returns</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-315"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-315"><span class="linenos">315</span></a><span class="sd">        -------</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-316"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-316"><span class="linenos">316</span></a><span class="sd">        Union[None, float]</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-317"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-317"><span class="linenos">317</span></a><span class="sd">            The span value of the estimates from the optimistic value iteration or None if no solution has been found.</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-318"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-318"><span class="linenos">318</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-319"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-319"><span class="linenos">319</span></a>        <span class="n">nb_observations</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">N</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-320"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-320"><span class="linenos">320</span></a>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-321"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-321"><span class="linenos">321</span></a>        <span class="n">beta_r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">beta_r</span><span class="p">(</span><span class="n">nb_observations</span><span class="p">)</span>  <span class="c1"># confidence bounds on rewards</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-322"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-322"><span class="linenos">322</span></a>        <span class="n">beta_p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">beta_p</span><span class="p">(</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-323"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-323"><span class="linenos">323</span></a>            <span class="n">nb_observations</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-324"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-324"><span class="linenos">324</span></a>        <span class="p">)</span>  <span class="c1"># confidence bounds on transition probabilities</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-325"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-325"><span class="linenos">325</span></a>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-326"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-326"><span class="linenos">326</span></a>        <span class="n">T</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">P</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-327"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-327"><span class="linenos">327</span></a>        <span class="n">estimated_rewards</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimated_rewards</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-328"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-328"><span class="linenos">328</span></a>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-329"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-329"><span class="linenos">329</span></a>        <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">T</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="mf">1.0</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-330"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-330"><span class="linenos">330</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-331"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-331"><span class="linenos">331</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="n">extended_value_iteration</span><span class="p">(</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-332"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-332"><span class="linenos">332</span></a>                <span class="n">T</span><span class="p">,</span> <span class="n">estimated_rewards</span><span class="p">,</span> <span class="n">beta_r</span><span class="p">,</span> <span class="n">beta_p</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">reward_range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-333"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-333"><span class="linenos">333</span></a>            <span class="p">)</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-334"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-334"><span class="linenos">334</span></a>        <span class="k">except</span> <span class="ne">SystemError</span><span class="p">:</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-335"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-335"><span class="linenos">335</span></a>            <span class="c1"># Debug logs if the optimistic value iteration fails</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-336"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-336"><span class="linenos">336</span></a>            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;tmp</span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="si">}</span><span class="s2">error_ext_vi&quot;</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-337"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-337"><span class="linenos">337</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-338"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-338"><span class="linenos">338</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;tmp</span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="si">}</span><span class="s2">error_ext_vi</span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="si">}</span><span class="s2">T</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">.npy&quot;</span><span class="p">):</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-339"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-339"><span class="linenos">339</span></a>                    <span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;tmp</span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="si">}</span><span class="s2">error_ext_vi</span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="si">}</span><span class="s2">T</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">.npy&quot;</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-340"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-340"><span class="linenos">340</span></a>                    <span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-341"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-341"><span class="linenos">341</span></a>                        <span class="sa">f</span><span class="s2">&quot;tmp</span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="si">}</span><span class="s2">error_ext_vi</span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="si">}</span><span class="s2">estimated_rewards</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">.npy&quot;</span><span class="p">,</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-342"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-342"><span class="linenos">342</span></a>                        <span class="n">estimated_rewards</span><span class="p">,</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-343"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-343"><span class="linenos">343</span></a>                    <span class="p">)</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-344"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-344"><span class="linenos">344</span></a>                    <span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;tmp</span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="si">}</span><span class="s2">error_ext_vi</span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="si">}</span><span class="s2">beta_r.npy</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">beta_r</span><span class="p">)</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-345"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-345"><span class="linenos">345</span></a>                    <span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;tmp</span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="si">}</span><span class="s2">error_ext_vi</span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="si">}</span><span class="s2">beta_p.npy</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">beta_p</span><span class="p">)</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-346"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-346"><span class="linenos">346</span></a>                    <span class="k">break</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-347"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-347"><span class="linenos">347</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-348"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-348"><span class="linenos">348</span></a>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-349"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-349"><span class="linenos">349</span></a>        <span class="k">if</span> <span class="n">res</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-350"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-350"><span class="linenos">350</span></a>            <span class="n">span_value_new</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Q</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">V</span> <span class="o">=</span> <span class="n">res</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-351"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-351"><span class="linenos">351</span></a>            <span class="n">span_value</span> <span class="o">=</span> <span class="n">span_value_new</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-352"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-352"><span class="linenos">352</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_actor</span><span class="o">.</span><span class="n">set_q_values</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Q</span><span class="p">)</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-353"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-353"><span class="linenos">353</span></a>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-354"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-354"><span class="linenos">354</span></a>            <span class="k">assert</span> <span class="n">span_value</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;The span value cannot be lower than zero&quot;</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-355"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-355"><span class="linenos">355</span></a>            <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">span_value</span> <span class="o">-</span> <span class="n">span_value_new</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1e-8</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-356"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-356"><span class="linenos">356</span></a>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-357"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-357"><span class="linenos">357</span></a>            <span class="k">return</span> <span class="n">span_value</span>
</span><span id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-358"><a href="#SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class-358"><span class="linenos">358</span></a>        <span class="k">return</span> <span class="kc">None</span>
</span></pre></div>


            <div class="docstring"><p>The class of the near optimal agent for the continuous setting. By default, it is <code>UCRL2Continuous</code>.</p>
</div>


                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="../agent/agents/infinite_horizon/ucrl2.html#UCRL2Continuous">colosseum.agent.agents.infinite_horizon.ucrl2.UCRL2Continuous</a></dt>
                                <dd id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class.__init__" class="function"><a href="../agent/agents/infinite_horizon/ucrl2.html#UCRL2Continuous.__init__">UCRL2Continuous</a></dd>
                <dd id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class.is_emission_map_accepted" class="function"><a href="../agent/agents/infinite_horizon/ucrl2.html#UCRL2Continuous.is_emission_map_accepted">is_emission_map_accepted</a></dd>
                <dd id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class.produce_gin_file_from_parameters" class="function"><a href="../agent/agents/infinite_horizon/ucrl2.html#UCRL2Continuous.produce_gin_file_from_parameters">produce_gin_file_from_parameters</a></dd>
                <dd id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class.is_episodic" class="function"><a href="../agent/agents/infinite_horizon/ucrl2.html#UCRL2Continuous.is_episodic">is_episodic</a></dd>
                <dd id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class.get_hyperparameters_search_spaces" class="function"><a href="../agent/agents/infinite_horizon/ucrl2.html#UCRL2Continuous.get_hyperparameters_search_spaces">get_hyperparameters_search_spaces</a></dd>
                <dd id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class.get_agent_instance_from_parameters" class="function"><a href="../agent/agents/infinite_horizon/ucrl2.html#UCRL2Continuous.get_agent_instance_from_parameters">get_agent_instance_from_parameters</a></dd>
                <dd id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class.current_optimal_stochastic_policy" class="variable"><a href="../agent/agents/infinite_horizon/ucrl2.html#UCRL2Continuous.current_optimal_stochastic_policy">current_optimal_stochastic_policy</a></dd>
                <dd id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class.is_episode_end" class="function"><a href="../agent/agents/infinite_horizon/ucrl2.html#UCRL2Continuous.is_episode_end">is_episode_end</a></dd>
                <dd id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class.episode_end_update" class="function"><a href="../agent/agents/infinite_horizon/ucrl2.html#UCRL2Continuous.episode_end_update">episode_end_update</a></dd>
                <dd id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class.before_start_interacting" class="function"><a href="../agent/agents/infinite_horizon/ucrl2.html#UCRL2Continuous.before_start_interacting">before_start_interacting</a></dd>
                <dd id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class.step_update" class="function"><a href="../agent/agents/infinite_horizon/ucrl2.html#UCRL2Continuous.step_update">step_update</a></dd>
                <dd id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class.model_update" class="function"><a href="../agent/agents/infinite_horizon/ucrl2.html#UCRL2Continuous.model_update">model_update</a></dd>
                <dd id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class.beta_r" class="function"><a href="../agent/agents/infinite_horizon/ucrl2.html#UCRL2Continuous.beta_r">beta_r</a></dd>
                <dd id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class.beta_p" class="function"><a href="../agent/agents/infinite_horizon/ucrl2.html#UCRL2Continuous.beta_p">beta_p</a></dd>
                <dd id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class.solve_optimistic_model" class="function"><a href="../agent/agents/infinite_horizon/ucrl2.html#UCRL2Continuous.solve_optimistic_model">solve_optimistic_model</a></dd>

            </div>
            <div><dt><a href="../agent/agents/base.html#BaseAgent">colosseum.agent.agents.base.BaseAgent</a></dt>
                                <dd id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class.select_action" class="function"><a href="../agent/agents/base.html#BaseAgent.select_action">select_action</a></dd>
                <dd id="SingleInstanceHyperOptConfig.continuous_near_optimal_agent_class.agent_logs" class="function"><a href="../agent/agents/base.html#BaseAgent.agent_logs">agent_logs</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="HardnessAnalysisParams">
                            <input id="HardnessAnalysisParams-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator">@dataclass()</div>

    <span class="def">class</span>
    <span class="name">HardnessAnalysisParams</span>:

                <label class="view-source-button" for="HardnessAnalysisParams-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#HardnessAnalysisParams"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="HardnessAnalysisParams-55"><a href="#HardnessAnalysisParams-55"><span class="linenos">55</span></a><span class="nd">@dataclass</span><span class="p">()</span>
</span><span id="HardnessAnalysisParams-56"><a href="#HardnessAnalysisParams-56"><span class="linenos">56</span></a><span class="k">class</span> <span class="nc">HardnessAnalysisParams</span><span class="p">:</span>
</span><span id="HardnessAnalysisParams-57"><a href="#HardnessAnalysisParams-57"><span class="linenos">57</span></a>    <span class="n">mdp_class</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="s2">&quot;BaseMDP&quot;</span><span class="p">]</span>
</span><span id="HardnessAnalysisParams-58"><a href="#HardnessAnalysisParams-58"><span class="linenos">58</span></a>    <span class="sd">&quot;&quot;&quot;The class of the MDP whose hardness we are studying.&quot;&quot;&quot;</span>
</span><span id="HardnessAnalysisParams-59"><a href="#HardnessAnalysisParams-59"><span class="linenos">59</span></a>    <span class="n">varying_params_name</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="HardnessAnalysisParams-60"><a href="#HardnessAnalysisParams-60"><span class="linenos">60</span></a>    <span class="sd">&quot;&quot;&quot;The name of the parameter being varied.&quot;&quot;&quot;</span>
</span><span id="HardnessAnalysisParams-61"><a href="#HardnessAnalysisParams-61"><span class="linenos">61</span></a>    <span class="n">varying_params_values</span><span class="p">:</span> <span class="n">Iterable</span>
</span><span id="HardnessAnalysisParams-62"><a href="#HardnessAnalysisParams-62"><span class="linenos">62</span></a>    <span class="sd">&quot;&quot;&quot;The values of the parameter being varied.&quot;&quot;&quot;</span>
</span><span id="HardnessAnalysisParams-63"><a href="#HardnessAnalysisParams-63"><span class="linenos">63</span></a>    <span class="n">fixed_params</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
</span><span id="HardnessAnalysisParams-64"><a href="#HardnessAnalysisParams-64"><span class="linenos">64</span></a>    <span class="sd">&quot;&quot;&quot;The dictionary containing the names and values for the parameters being kept fixed.&quot;&quot;&quot;</span>
</span><span id="HardnessAnalysisParams-65"><a href="#HardnessAnalysisParams-65"><span class="linenos">65</span></a>    <span class="n">n_seeds_mdp</span><span class="p">:</span> <span class="nb">int</span>
</span><span id="HardnessAnalysisParams-66"><a href="#HardnessAnalysisParams-66"><span class="linenos">66</span></a>    <span class="sd">&quot;&quot;&quot;The number of seeds used when instantiating the MDP.&quot;&quot;&quot;</span>
</span><span id="HardnessAnalysisParams-67"><a href="#HardnessAnalysisParams-67"><span class="linenos">67</span></a>    <span class="n">hardness_measures</span><span class="p">:</span> <span class="n">Collection</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Type</span><span class="p">[</span><span class="s2">&quot;BaseMDP&quot;</span><span class="p">]],</span> <span class="nb">float</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="HardnessAnalysisParams-68"><a href="#HardnessAnalysisParams-68"><span class="linenos">68</span></a>        <span class="s2">&quot;diameter&quot;</span><span class="p">,</span>
</span><span id="HardnessAnalysisParams-69"><a href="#HardnessAnalysisParams-69"><span class="linenos">69</span></a>        <span class="s2">&quot;value_norm&quot;</span><span class="p">,</span>
</span><span id="HardnessAnalysisParams-70"><a href="#HardnessAnalysisParams-70"><span class="linenos">70</span></a>    <span class="p">)</span>
</span><span id="HardnessAnalysisParams-71"><a href="#HardnessAnalysisParams-71"><span class="linenos">71</span></a>    <span class="sd">&quot;&quot;&quot;An iterable containing either the code name of an available measure of hardness or a function that takes an MDP</span>
</span><span id="HardnessAnalysisParams-72"><a href="#HardnessAnalysisParams-72"><span class="linenos">72</span></a><span class="sd">    object as input and returns a value.&quot;&quot;&quot;</span>
</span><span id="HardnessAnalysisParams-73"><a href="#HardnessAnalysisParams-73"><span class="linenos">73</span></a>    <span class="n">near_optimal_agent_hyperopt_config</span><span class="p">:</span> <span class="n">SingleInstanceHyperOptConfig</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="HardnessAnalysisParams-74"><a href="#HardnessAnalysisParams-74"><span class="linenos">74</span></a>    <span class="sd">&quot;&quot;&quot;The parameters optimization configuration for the near optimal agent. By default, it is None, which means</span>
</span><span id="HardnessAnalysisParams-75"><a href="#HardnessAnalysisParams-75"><span class="linenos">75</span></a><span class="sd">    that the regret of the near optimal agent with tuned parameters is not computed and used as proxy for a </span>
</span><span id="HardnessAnalysisParams-76"><a href="#HardnessAnalysisParams-76"><span class="linenos">76</span></a><span class="sd">    complete measure of hardness.&quot;&quot;&quot;</span>
</span><span id="HardnessAnalysisParams-77"><a href="#HardnessAnalysisParams-77"><span class="linenos">77</span></a>    <span class="n">varying_params_name_clean</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="HardnessAnalysisParams-78"><a href="#HardnessAnalysisParams-78"><span class="linenos">78</span></a>    <span class="sd">&quot;&quot;&quot;The name of the parameter being varied in a clean format.&quot;&quot;&quot;</span>
</span><span id="HardnessAnalysisParams-79"><a href="#HardnessAnalysisParams-79"><span class="linenos">79</span></a>    <span class="n">retrieve_from_cache</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="HardnessAnalysisParams-80"><a href="#HardnessAnalysisParams-80"><span class="linenos">80</span></a>    <span class="sd">&quot;&quot;&quot;If ture, the ``config.get_hardness_measures_cache_folder()`` is searched for a cached value of the measure.</span>
</span><span id="HardnessAnalysisParams-81"><a href="#HardnessAnalysisParams-81"><span class="linenos">81</span></a><span class="sd">    By default, it is True.&quot;&quot;&quot;</span>
</span><span id="HardnessAnalysisParams-82"><a href="#HardnessAnalysisParams-82"><span class="linenos">82</span></a>
</span><span id="HardnessAnalysisParams-83"><a href="#HardnessAnalysisParams-83"><span class="linenos">83</span></a>    <span class="nd">@property</span>
</span><span id="HardnessAnalysisParams-84"><a href="#HardnessAnalysisParams-84"><span class="linenos">84</span></a>    <span class="k">def</span> <span class="nf">clean_varying_prm_name</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="HardnessAnalysisParams-85"><a href="#HardnessAnalysisParams-85"><span class="linenos">85</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="HardnessAnalysisParams-86"><a href="#HardnessAnalysisParams-86"><span class="linenos">86</span></a><span class="sd">        Returns</span>
</span><span id="HardnessAnalysisParams-87"><a href="#HardnessAnalysisParams-87"><span class="linenos">87</span></a><span class="sd">        -------</span>
</span><span id="HardnessAnalysisParams-88"><a href="#HardnessAnalysisParams-88"><span class="linenos">88</span></a><span class="sd">        str</span>
</span><span id="HardnessAnalysisParams-89"><a href="#HardnessAnalysisParams-89"><span class="linenos">89</span></a><span class="sd">            A nicely formatted name for the varying parameter.</span>
</span><span id="HardnessAnalysisParams-90"><a href="#HardnessAnalysisParams-90"><span class="linenos">90</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="HardnessAnalysisParams-91"><a href="#HardnessAnalysisParams-91"><span class="linenos">91</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">varying_params_name_clean</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="HardnessAnalysisParams-92"><a href="#HardnessAnalysisParams-92"><span class="linenos">92</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">varying_params_name</span>
</span><span id="HardnessAnalysisParams-93"><a href="#HardnessAnalysisParams-93"><span class="linenos">93</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">varying_params_name_clean</span>
</span></pre></div>


    

                            <div id="HardnessAnalysisParams.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">HardnessAnalysisParams</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">mdp_class</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n"><a href="../mdp/base.html#BaseMDP">colosseum.mdp.base.BaseMDP</a></span><span class="p">]</span>,</span><span class="param">	<span class="n">varying_params_name</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">varying_params_values</span><span class="p">:</span> <span class="n">Iterable</span>,</span><span class="param">	<span class="n">fixed_params</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>,</span><span class="param">	<span class="n">n_seeds_mdp</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">hardness_measures</span><span class="p">:</span> <span class="n">Collection</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Type</span><span class="p">[</span><span class="n"><a href="../mdp/base.html#BaseMDP">colosseum.mdp.base.BaseMDP</a></span><span class="p">]],</span> <span class="nb">float</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;diameter&#39;</span><span class="p">,</span> <span class="s1">&#39;value_norm&#39;</span><span class="p">)</span>,</span><span class="param">	<span class="n">near_optimal_agent_hyperopt_config</span><span class="p">:</span> <span class="n"><a href="#SingleInstanceHyperOptConfig">colosseum.hardness.analysis.SingleInstanceHyperOptConfig</a></span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">varying_params_name_clean</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">retrieve_from_cache</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#HardnessAnalysisParams.__init__"></a>
    
    

                            </div>
                            <div id="HardnessAnalysisParams.mdp_class" class="classattr">
                                <div class="attr variable">
            <span class="name">mdp_class</span><span class="annotation">: Type[<a href="../mdp/base.html#BaseMDP">colosseum.mdp.base.BaseMDP</a>]</span>

        
    </div>
    <a class="headerlink" href="#HardnessAnalysisParams.mdp_class"></a>
    
            <div class="docstring"><p>The class of the MDP whose hardness we are studying.</p>
</div>


                            </div>
                            <div id="HardnessAnalysisParams.varying_params_name" class="classattr">
                                <div class="attr variable">
            <span class="name">varying_params_name</span><span class="annotation">: str</span>

        
    </div>
    <a class="headerlink" href="#HardnessAnalysisParams.varying_params_name"></a>
    
            <div class="docstring"><p>The name of the parameter being varied.</p>
</div>


                            </div>
                            <div id="HardnessAnalysisParams.varying_params_values" class="classattr">
                                <div class="attr variable">
            <span class="name">varying_params_values</span><span class="annotation">: Iterable</span>

        
    </div>
    <a class="headerlink" href="#HardnessAnalysisParams.varying_params_values"></a>
    
            <div class="docstring"><p>The values of the parameter being varied.</p>
</div>


                            </div>
                            <div id="HardnessAnalysisParams.fixed_params" class="classattr">
                                <div class="attr variable">
            <span class="name">fixed_params</span><span class="annotation">: Dict[str, Any]</span>

        
    </div>
    <a class="headerlink" href="#HardnessAnalysisParams.fixed_params"></a>
    
            <div class="docstring"><p>The dictionary containing the names and values for the parameters being kept fixed.</p>
</div>


                            </div>
                            <div id="HardnessAnalysisParams.n_seeds_mdp" class="classattr">
                                <div class="attr variable">
            <span class="name">n_seeds_mdp</span><span class="annotation">: int</span>

        
    </div>
    <a class="headerlink" href="#HardnessAnalysisParams.n_seeds_mdp"></a>
    
            <div class="docstring"><p>The number of seeds used when instantiating the MDP.</p>
</div>


                            </div>
                            <div id="HardnessAnalysisParams.hardness_measures" class="classattr">
                                <div class="attr variable">
            <span class="name">hardness_measures</span><span class="annotation">: Collection[Union[str, Callable[[Type[<a href="../mdp/base.html#BaseMDP">colosseum.mdp.base.BaseMDP</a>]], float]]]</span><span class="default_value"> = (&#39;diameter&#39;, &#39;value_norm&#39;)</span>

        
    </div>
    <a class="headerlink" href="#HardnessAnalysisParams.hardness_measures"></a>
    
            <div class="docstring"><p>An iterable containing either the code name of an available measure of hardness or a function that takes an MDP
object as input and returns a value.</p>
</div>


                            </div>
                            <div id="HardnessAnalysisParams.near_optimal_agent_hyperopt_config" class="classattr">
                                <div class="attr variable">
            <span class="name">near_optimal_agent_hyperopt_config</span><span class="annotation">: <a href="#SingleInstanceHyperOptConfig">colosseum.hardness.analysis.SingleInstanceHyperOptConfig</a></span><span class="default_value"> = None</span>

        
    </div>
    <a class="headerlink" href="#HardnessAnalysisParams.near_optimal_agent_hyperopt_config"></a>
    
            <div class="docstring"><p>The parameters optimization configuration for the near optimal agent. By default, it is None, which means
that the regret of the near optimal agent with tuned parameters is not computed and used as proxy for a 
complete measure of hardness.</p>
</div>


                            </div>
                            <div id="HardnessAnalysisParams.varying_params_name_clean" class="classattr">
                                <div class="attr variable">
            <span class="name">varying_params_name_clean</span><span class="annotation">: str</span><span class="default_value"> = None</span>

        
    </div>
    <a class="headerlink" href="#HardnessAnalysisParams.varying_params_name_clean"></a>
    
            <div class="docstring"><p>The name of the parameter being varied in a clean format.</p>
</div>


                            </div>
                            <div id="HardnessAnalysisParams.retrieve_from_cache" class="classattr">
                                <div class="attr variable">
            <span class="name">retrieve_from_cache</span><span class="annotation">: bool</span><span class="default_value"> = True</span>

        
    </div>
    <a class="headerlink" href="#HardnessAnalysisParams.retrieve_from_cache"></a>
    
            <div class="docstring"><p>If ture, the <code>config.get_hardness_measures_cache_folder()</code> is searched for a cached value of the measure.
By default, it is True.</p>
</div>


                            </div>
                            <div id="HardnessAnalysisParams.clean_varying_prm_name" class="classattr">
                                <div class="attr variable">
            <span class="name">clean_varying_prm_name</span><span class="annotation">: str</span>

        
    </div>
    <a class="headerlink" href="#HardnessAnalysisParams.clean_varying_prm_name"></a>
    
            <div class="docstring"><h6 id="returns">Returns</h6>

<ul>
<li><strong>str</strong>: A nicely formatted name for the varying parameter.</li>
</ul>
</div>


                            </div>
                </section>
                <section id="run_scenario_analysis">
                            <input id="run_scenario_analysis-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">run_scenario_analysis</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">hap</span><span class="p">:</span> <span class="n"><a href="#HardnessAnalysisParams">colosseum.hardness.analysis.HardnessAnalysisParams</a></span>, </span><span class="param"><span class="n">ax</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="run_scenario_analysis-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#run_scenario_analysis"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="run_scenario_analysis-96"><a href="#run_scenario_analysis-96"><span class="linenos"> 96</span></a><span class="k">def</span> <span class="nf">run_scenario_analysis</span><span class="p">(</span>
</span><span id="run_scenario_analysis-97"><a href="#run_scenario_analysis-97"><span class="linenos"> 97</span></a>    <span class="n">hap</span><span class="p">:</span> <span class="n">HardnessAnalysisParams</span><span class="p">,</span>
</span><span id="run_scenario_analysis-98"><a href="#run_scenario_analysis-98"><span class="linenos"> 98</span></a>    <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="run_scenario_analysis-99"><a href="#run_scenario_analysis-99"><span class="linenos"> 99</span></a><span class="p">):</span>
</span><span id="run_scenario_analysis-100"><a href="#run_scenario_analysis-100"><span class="linenos">100</span></a>    <span class="sd">&quot;&quot;&quot;</span>
</span><span id="run_scenario_analysis-101"><a href="#run_scenario_analysis-101"><span class="linenos">101</span></a><span class="sd">    runs a hardness analysis scenario.</span>
</span><span id="run_scenario_analysis-102"><a href="#run_scenario_analysis-102"><span class="linenos">102</span></a>
</span><span id="run_scenario_analysis-103"><a href="#run_scenario_analysis-103"><span class="linenos">103</span></a><span class="sd">    Parameters</span>
</span><span id="run_scenario_analysis-104"><a href="#run_scenario_analysis-104"><span class="linenos">104</span></a><span class="sd">    ----------</span>
</span><span id="run_scenario_analysis-105"><a href="#run_scenario_analysis-105"><span class="linenos">105</span></a><span class="sd">    hap : HardnessAnalysisParams</span>
</span><span id="run_scenario_analysis-106"><a href="#run_scenario_analysis-106"><span class="linenos">106</span></a><span class="sd">        The hardness analysis scenario to run.</span>
</span><span id="run_scenario_analysis-107"><a href="#run_scenario_analysis-107"><span class="linenos">107</span></a><span class="sd">    ax : plt.Axes</span>
</span><span id="run_scenario_analysis-108"><a href="#run_scenario_analysis-108"><span class="linenos">108</span></a><span class="sd">        The ax object where the plot will be put. By default, a new axis is created.</span>
</span><span id="run_scenario_analysis-109"><a href="#run_scenario_analysis-109"><span class="linenos">109</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="run_scenario_analysis-110"><a href="#run_scenario_analysis-110"><span class="linenos">110</span></a>
</span><span id="run_scenario_analysis-111"><a href="#run_scenario_analysis-111"><span class="linenos">111</span></a>    <span class="n">show</span> <span class="o">=</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span>
</span><span id="run_scenario_analysis-112"><a href="#run_scenario_analysis-112"><span class="linenos">112</span></a>    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="run_scenario_analysis-113"><a href="#run_scenario_analysis-113"><span class="linenos">113</span></a>        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
</span><span id="run_scenario_analysis-114"><a href="#run_scenario_analysis-114"><span class="linenos">114</span></a>
</span><span id="run_scenario_analysis-115"><a href="#run_scenario_analysis-115"><span class="linenos">115</span></a>    <span class="n">dfs</span> <span class="o">=</span> <span class="n">get_varying_parameter_dfs</span><span class="p">(</span><span class="n">hap</span><span class="p">,</span> <span class="n">normalize_measures</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="run_scenario_analysis-116"><a href="#run_scenario_analysis-116"><span class="linenos">116</span></a>
</span><span id="run_scenario_analysis-117"><a href="#run_scenario_analysis-117"><span class="linenos">117</span></a>    <span class="k">for</span> <span class="n">measure_name</span><span class="p">,</span> <span class="n">df</span> <span class="ow">in</span> <span class="n">dfs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="run_scenario_analysis-118"><a href="#run_scenario_analysis-118"><span class="linenos">118</span></a>        <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span>
</span><span id="run_scenario_analysis-119"><a href="#run_scenario_analysis-119"><span class="linenos">119</span></a>            <span class="n">x</span><span class="o">=</span><span class="n">hap</span><span class="o">.</span><span class="n">clean_varying_prm_name</span><span class="p">,</span>
</span><span id="run_scenario_analysis-120"><a href="#run_scenario_analysis-120"><span class="linenos">120</span></a>            <span class="n">y</span><span class="o">=</span><span class="n">measure_name</span><span class="p">,</span>
</span><span id="run_scenario_analysis-121"><a href="#run_scenario_analysis-121"><span class="linenos">121</span></a>            <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
</span><span id="run_scenario_analysis-122"><a href="#run_scenario_analysis-122"><span class="linenos">122</span></a>            <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
</span><span id="run_scenario_analysis-123"><a href="#run_scenario_analysis-123"><span class="linenos">123</span></a>            <span class="n">label</span><span class="o">=</span><span class="n">measure_name</span><span class="p">,</span>
</span><span id="run_scenario_analysis-124"><a href="#run_scenario_analysis-124"><span class="linenos">124</span></a>        <span class="p">)</span>
</span><span id="run_scenario_analysis-125"><a href="#run_scenario_analysis-125"><span class="linenos">125</span></a>    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Hardness measure value&quot;</span><span class="p">)</span>
</span><span id="run_scenario_analysis-126"><a href="#run_scenario_analysis-126"><span class="linenos">126</span></a>    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</span><span id="run_scenario_analysis-127"><a href="#run_scenario_analysis-127"><span class="linenos">127</span></a>
</span><span id="run_scenario_analysis-128"><a href="#run_scenario_analysis-128"><span class="linenos">128</span></a>    <span class="k">if</span> <span class="n">show</span><span class="p">:</span>
</span><span id="run_scenario_analysis-129"><a href="#run_scenario_analysis-129"><span class="linenos">129</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>runs a hardness analysis scenario.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>hap</strong> (HardnessAnalysisParams):
The hardness analysis scenario to run.</li>
<li><strong>ax</strong> (plt.Axes):
The ax object where the plot will be put. By default, a new axis is created.</li>
</ul>
</div>


                </section>
                <section id="get_varying_parameter_dfs">
                            <input id="get_varying_parameter_dfs-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_varying_parameter_dfs</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">hap</span><span class="p">:</span> <span class="n"><a href="#HardnessAnalysisParams">colosseum.hardness.analysis.HardnessAnalysisParams</a></span>,</span><span class="param">	<span class="n">normalize_measures</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span><span class="return-annotation">) -> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="get_varying_parameter_dfs-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#get_varying_parameter_dfs"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="get_varying_parameter_dfs-132"><a href="#get_varying_parameter_dfs-132"><span class="linenos">132</span></a><span class="k">def</span> <span class="nf">get_varying_parameter_dfs</span><span class="p">(</span>
</span><span id="get_varying_parameter_dfs-133"><a href="#get_varying_parameter_dfs-133"><span class="linenos">133</span></a>    <span class="n">hap</span><span class="p">:</span> <span class="n">HardnessAnalysisParams</span><span class="p">,</span>
</span><span id="get_varying_parameter_dfs-134"><a href="#get_varying_parameter_dfs-134"><span class="linenos">134</span></a>    <span class="n">normalize_measures</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="get_varying_parameter_dfs-135"><a href="#get_varying_parameter_dfs-135"><span class="linenos">135</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]:</span>
</span><span id="get_varying_parameter_dfs-136"><a href="#get_varying_parameter_dfs-136"><span class="linenos">136</span></a>    <span class="sd">&quot;&quot;&quot;</span>
</span><span id="get_varying_parameter_dfs-137"><a href="#get_varying_parameter_dfs-137"><span class="linenos">137</span></a><span class="sd">    computes the hardness measures for the scenarios and stored them in a `pd.DataFrame`s.</span>
</span><span id="get_varying_parameter_dfs-138"><a href="#get_varying_parameter_dfs-138"><span class="linenos">138</span></a>
</span><span id="get_varying_parameter_dfs-139"><a href="#get_varying_parameter_dfs-139"><span class="linenos">139</span></a><span class="sd">    Parameters</span>
</span><span id="get_varying_parameter_dfs-140"><a href="#get_varying_parameter_dfs-140"><span class="linenos">140</span></a><span class="sd">    ----------</span>
</span><span id="get_varying_parameter_dfs-141"><a href="#get_varying_parameter_dfs-141"><span class="linenos">141</span></a><span class="sd">    hap : HardnessAnalysisParams</span>
</span><span id="get_varying_parameter_dfs-142"><a href="#get_varying_parameter_dfs-142"><span class="linenos">142</span></a><span class="sd">        The hardness analysis scenario to run.</span>
</span><span id="get_varying_parameter_dfs-143"><a href="#get_varying_parameter_dfs-143"><span class="linenos">143</span></a><span class="sd">    normalize_measures : bool</span>
</span><span id="get_varying_parameter_dfs-144"><a href="#get_varying_parameter_dfs-144"><span class="linenos">144</span></a><span class="sd">        If True, the values of the hardness measures are normalized.</span>
</span><span id="get_varying_parameter_dfs-145"><a href="#get_varying_parameter_dfs-145"><span class="linenos">145</span></a>
</span><span id="get_varying_parameter_dfs-146"><a href="#get_varying_parameter_dfs-146"><span class="linenos">146</span></a><span class="sd">    Returns</span>
</span><span id="get_varying_parameter_dfs-147"><a href="#get_varying_parameter_dfs-147"><span class="linenos">147</span></a><span class="sd">    -------</span>
</span><span id="get_varying_parameter_dfs-148"><a href="#get_varying_parameter_dfs-148"><span class="linenos">148</span></a><span class="sd">    Dict[str, pd.DataFrame]</span>
</span><span id="get_varying_parameter_dfs-149"><a href="#get_varying_parameter_dfs-149"><span class="linenos">149</span></a><span class="sd">        A dictionary that associated the name of a hardness measure to its corresponding pd.DataFrame.</span>
</span><span id="get_varying_parameter_dfs-150"><a href="#get_varying_parameter_dfs-150"><span class="linenos">150</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="get_varying_parameter_dfs-151"><a href="#get_varying_parameter_dfs-151"><span class="linenos">151</span></a>
</span><span id="get_varying_parameter_dfs-152"><a href="#get_varying_parameter_dfs-152"><span class="linenos">152</span></a>    <span class="k">if</span> <span class="n">hap</span><span class="o">.</span><span class="n">near_optimal_agent_hyperopt_config</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="get_varying_parameter_dfs-153"><a href="#get_varying_parameter_dfs-153"><span class="linenos">153</span></a>        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
</span><span id="get_varying_parameter_dfs-154"><a href="#get_varying_parameter_dfs-154"><span class="linenos">154</span></a>            <span class="s2">&quot;The computation of the regret of the near optimal agent as a proxy for a complete measure of hardness is &quot;</span>
</span><span id="get_varying_parameter_dfs-155"><a href="#get_varying_parameter_dfs-155"><span class="linenos">155</span></a>            <span class="s2">&quot;being refactored at the moment.&quot;</span>
</span><span id="get_varying_parameter_dfs-156"><a href="#get_varying_parameter_dfs-156"><span class="linenos">156</span></a>        <span class="p">)</span>
</span><span id="get_varying_parameter_dfs-157"><a href="#get_varying_parameter_dfs-157"><span class="linenos">157</span></a>
</span><span id="get_varying_parameter_dfs-158"><a href="#get_varying_parameter_dfs-158"><span class="linenos">158</span></a>    <span class="n">measure_results</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</span><span id="get_varying_parameter_dfs-159"><a href="#get_varying_parameter_dfs-159"><span class="linenos">159</span></a>    <span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">get_available_cores</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="get_varying_parameter_dfs-160"><a href="#get_varying_parameter_dfs-160"><span class="linenos">160</span></a>        <span class="n">inputs</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="get_varying_parameter_dfs-161"><a href="#get_varying_parameter_dfs-161"><span class="linenos">161</span></a>            <span class="p">(</span>
</span><span id="get_varying_parameter_dfs-162"><a href="#get_varying_parameter_dfs-162"><span class="linenos">162</span></a>                <span class="n">hap</span><span class="o">.</span><span class="n">mdp_class</span><span class="p">,</span>
</span><span id="get_varying_parameter_dfs-163"><a href="#get_varying_parameter_dfs-163"><span class="linenos">163</span></a>                <span class="n">hap</span><span class="o">.</span><span class="n">fixed_params</span><span class="p">,</span>
</span><span id="get_varying_parameter_dfs-164"><a href="#get_varying_parameter_dfs-164"><span class="linenos">164</span></a>                <span class="n">hap</span><span class="o">.</span><span class="n">varying_params_name</span><span class="p">,</span>
</span><span id="get_varying_parameter_dfs-165"><a href="#get_varying_parameter_dfs-165"><span class="linenos">165</span></a>                <span class="n">varying_value</span><span class="p">,</span>
</span><span id="get_varying_parameter_dfs-166"><a href="#get_varying_parameter_dfs-166"><span class="linenos">166</span></a>                <span class="n">seed</span><span class="p">,</span>
</span><span id="get_varying_parameter_dfs-167"><a href="#get_varying_parameter_dfs-167"><span class="linenos">167</span></a>                <span class="n">measure</span><span class="p">,</span>
</span><span id="get_varying_parameter_dfs-168"><a href="#get_varying_parameter_dfs-168"><span class="linenos">168</span></a>                <span class="n">hap</span><span class="o">.</span><span class="n">retrieve_from_cache</span><span class="p">,</span>
</span><span id="get_varying_parameter_dfs-169"><a href="#get_varying_parameter_dfs-169"><span class="linenos">169</span></a>            <span class="p">)</span>
</span><span id="get_varying_parameter_dfs-170"><a href="#get_varying_parameter_dfs-170"><span class="linenos">170</span></a>            <span class="k">for</span> <span class="n">varying_value</span> <span class="ow">in</span> <span class="n">hap</span><span class="o">.</span><span class="n">varying_params_values</span>
</span><span id="get_varying_parameter_dfs-171"><a href="#get_varying_parameter_dfs-171"><span class="linenos">171</span></a>            <span class="k">for</span> <span class="n">measure</span> <span class="ow">in</span> <span class="n">hap</span><span class="o">.</span><span class="n">hardness_measures</span>
</span><span id="get_varying_parameter_dfs-172"><a href="#get_varying_parameter_dfs-172"><span class="linenos">172</span></a>            <span class="k">for</span> <span class="n">seed</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">hap</span><span class="o">.</span><span class="n">n_seeds_mdp</span><span class="p">)</span>
</span><span id="get_varying_parameter_dfs-173"><a href="#get_varying_parameter_dfs-173"><span class="linenos">173</span></a>        <span class="p">]</span>
</span><span id="get_varying_parameter_dfs-174"><a href="#get_varying_parameter_dfs-174"><span class="linenos">174</span></a>
</span><span id="get_varying_parameter_dfs-175"><a href="#get_varying_parameter_dfs-175"><span class="linenos">175</span></a>        <span class="k">with</span> <span class="n">Pool</span><span class="p">(</span><span class="n">processes</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">get_available_cores</span><span class="p">())</span> <span class="k">as</span> <span class="n">p</span><span class="p">:</span>
</span><span id="get_varying_parameter_dfs-176"><a href="#get_varying_parameter_dfs-176"><span class="linenos">176</span></a>            <span class="k">for</span> <span class="n">measure_name</span><span class="p">,</span> <span class="n">varying_value</span><span class="p">,</span> <span class="n">seed</span><span class="p">,</span> <span class="n">measure_value</span> <span class="ow">in</span> <span class="n">p</span><span class="o">.</span><span class="n">starmap_async</span><span class="p">(</span>
</span><span id="get_varying_parameter_dfs-177"><a href="#get_varying_parameter_dfs-177"><span class="linenos">177</span></a>                <span class="n">_compute_hardness_measure</span><span class="p">,</span> <span class="n">inputs</span>
</span><span id="get_varying_parameter_dfs-178"><a href="#get_varying_parameter_dfs-178"><span class="linenos">178</span></a>            <span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
</span><span id="get_varying_parameter_dfs-179"><a href="#get_varying_parameter_dfs-179"><span class="linenos">179</span></a>                <span class="n">_add_result</span><span class="p">(</span>
</span><span id="get_varying_parameter_dfs-180"><a href="#get_varying_parameter_dfs-180"><span class="linenos">180</span></a>                    <span class="n">measure_results</span><span class="p">,</span> <span class="n">measure_name</span><span class="p">,</span> <span class="n">varying_value</span><span class="p">,</span> <span class="n">seed</span><span class="p">,</span> <span class="n">measure_value</span>
</span><span id="get_varying_parameter_dfs-181"><a href="#get_varying_parameter_dfs-181"><span class="linenos">181</span></a>                <span class="p">)</span>
</span><span id="get_varying_parameter_dfs-182"><a href="#get_varying_parameter_dfs-182"><span class="linenos">182</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="get_varying_parameter_dfs-183"><a href="#get_varying_parameter_dfs-183"><span class="linenos">183</span></a>        <span class="k">for</span> <span class="n">seed</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">hap</span><span class="o">.</span><span class="n">n_seeds_mdp</span><span class="p">):</span>
</span><span id="get_varying_parameter_dfs-184"><a href="#get_varying_parameter_dfs-184"><span class="linenos">184</span></a>            <span class="k">for</span> <span class="n">measure</span> <span class="ow">in</span> <span class="n">hap</span><span class="o">.</span><span class="n">hardness_measures</span><span class="p">:</span>
</span><span id="get_varying_parameter_dfs-185"><a href="#get_varying_parameter_dfs-185"><span class="linenos">185</span></a>                <span class="k">for</span> <span class="n">varying_value</span> <span class="ow">in</span> <span class="n">hap</span><span class="o">.</span><span class="n">varying_params_values</span><span class="p">:</span>
</span><span id="get_varying_parameter_dfs-186"><a href="#get_varying_parameter_dfs-186"><span class="linenos">186</span></a>                    <span class="n">out</span> <span class="o">=</span> <span class="n">compute_hardness_measure_for_varying_prm</span><span class="p">(</span>
</span><span id="get_varying_parameter_dfs-187"><a href="#get_varying_parameter_dfs-187"><span class="linenos">187</span></a>                        <span class="n">hap</span><span class="o">.</span><span class="n">mdp_class</span><span class="p">,</span>
</span><span id="get_varying_parameter_dfs-188"><a href="#get_varying_parameter_dfs-188"><span class="linenos">188</span></a>                        <span class="n">hap</span><span class="o">.</span><span class="n">fixed_params</span><span class="p">,</span>
</span><span id="get_varying_parameter_dfs-189"><a href="#get_varying_parameter_dfs-189"><span class="linenos">189</span></a>                        <span class="n">hap</span><span class="o">.</span><span class="n">varying_params_name</span><span class="p">,</span>
</span><span id="get_varying_parameter_dfs-190"><a href="#get_varying_parameter_dfs-190"><span class="linenos">190</span></a>                        <span class="n">varying_value</span><span class="p">,</span>
</span><span id="get_varying_parameter_dfs-191"><a href="#get_varying_parameter_dfs-191"><span class="linenos">191</span></a>                        <span class="n">seed</span><span class="p">,</span>
</span><span id="get_varying_parameter_dfs-192"><a href="#get_varying_parameter_dfs-192"><span class="linenos">192</span></a>                        <span class="n">measure</span><span class="p">,</span>
</span><span id="get_varying_parameter_dfs-193"><a href="#get_varying_parameter_dfs-193"><span class="linenos">193</span></a>                        <span class="n">force_single_core</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="get_varying_parameter_dfs-194"><a href="#get_varying_parameter_dfs-194"><span class="linenos">194</span></a>                        <span class="n">retrieve_from_cache</span><span class="o">=</span><span class="n">hap</span><span class="o">.</span><span class="n">retrieve_from_cache</span><span class="p">,</span>
</span><span id="get_varying_parameter_dfs-195"><a href="#get_varying_parameter_dfs-195"><span class="linenos">195</span></a>                        <span class="n">return_n_states</span><span class="o">=</span><span class="n">hap</span><span class="o">.</span><span class="n">varying_params_name</span> <span class="o">==</span> <span class="s2">&quot;size&quot;</span><span class="p">,</span>
</span><span id="get_varying_parameter_dfs-196"><a href="#get_varying_parameter_dfs-196"><span class="linenos">196</span></a>                    <span class="p">)</span>
</span><span id="get_varying_parameter_dfs-197"><a href="#get_varying_parameter_dfs-197"><span class="linenos">197</span></a>                    <span class="k">if</span> <span class="n">hap</span><span class="o">.</span><span class="n">varying_params_name</span> <span class="o">==</span> <span class="s2">&quot;size&quot;</span><span class="p">:</span>
</span><span id="get_varying_parameter_dfs-198"><a href="#get_varying_parameter_dfs-198"><span class="linenos">198</span></a>                        <span class="n">measure_name</span><span class="p">,</span> <span class="n">measure_value</span><span class="p">,</span> <span class="n">n_states</span> <span class="o">=</span> <span class="n">out</span>
</span><span id="get_varying_parameter_dfs-199"><a href="#get_varying_parameter_dfs-199"><span class="linenos">199</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="get_varying_parameter_dfs-200"><a href="#get_varying_parameter_dfs-200"><span class="linenos">200</span></a>                        <span class="n">measure_name</span><span class="p">,</span> <span class="n">measure_value</span> <span class="o">=</span> <span class="n">out</span>
</span><span id="get_varying_parameter_dfs-201"><a href="#get_varying_parameter_dfs-201"><span class="linenos">201</span></a>
</span><span id="get_varying_parameter_dfs-202"><a href="#get_varying_parameter_dfs-202"><span class="linenos">202</span></a>                    <span class="n">_add_result</span><span class="p">(</span>
</span><span id="get_varying_parameter_dfs-203"><a href="#get_varying_parameter_dfs-203"><span class="linenos">203</span></a>                        <span class="n">measure_results</span><span class="p">,</span>
</span><span id="get_varying_parameter_dfs-204"><a href="#get_varying_parameter_dfs-204"><span class="linenos">204</span></a>                        <span class="n">measure_name</span><span class="p">,</span>
</span><span id="get_varying_parameter_dfs-205"><a href="#get_varying_parameter_dfs-205"><span class="linenos">205</span></a>                        <span class="n">varying_value</span>
</span><span id="get_varying_parameter_dfs-206"><a href="#get_varying_parameter_dfs-206"><span class="linenos">206</span></a>                        <span class="k">if</span> <span class="n">hap</span><span class="o">.</span><span class="n">varying_params_name</span> <span class="o">!=</span> <span class="s2">&quot;size&quot;</span>
</span><span id="get_varying_parameter_dfs-207"><a href="#get_varying_parameter_dfs-207"><span class="linenos">207</span></a>                        <span class="k">else</span> <span class="n">n_states</span><span class="p">,</span>
</span><span id="get_varying_parameter_dfs-208"><a href="#get_varying_parameter_dfs-208"><span class="linenos">208</span></a>                        <span class="n">seed</span><span class="p">,</span>
</span><span id="get_varying_parameter_dfs-209"><a href="#get_varying_parameter_dfs-209"><span class="linenos">209</span></a>                        <span class="n">measure_value</span><span class="p">,</span>
</span><span id="get_varying_parameter_dfs-210"><a href="#get_varying_parameter_dfs-210"><span class="linenos">210</span></a>                    <span class="p">)</span>
</span><span id="get_varying_parameter_dfs-211"><a href="#get_varying_parameter_dfs-211"><span class="linenos">211</span></a>
</span><span id="get_varying_parameter_dfs-212"><a href="#get_varying_parameter_dfs-212"><span class="linenos">212</span></a>    <span class="k">for</span> <span class="n">measure_name</span> <span class="ow">in</span> <span class="n">measure_results</span><span class="p">:</span>
</span><span id="get_varying_parameter_dfs-213"><a href="#get_varying_parameter_dfs-213"><span class="linenos">213</span></a>        <span class="c1"># Create a Pandas DataFrame</span>
</span><span id="get_varying_parameter_dfs-214"><a href="#get_varying_parameter_dfs-214"><span class="linenos">214</span></a>        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">measure_results</span><span class="p">[</span><span class="n">measure_name</span><span class="p">])</span>
</span><span id="get_varying_parameter_dfs-215"><a href="#get_varying_parameter_dfs-215"><span class="linenos">215</span></a>
</span><span id="get_varying_parameter_dfs-216"><a href="#get_varying_parameter_dfs-216"><span class="linenos">216</span></a>        <span class="c1"># Normalize the values if required</span>
</span><span id="get_varying_parameter_dfs-217"><a href="#get_varying_parameter_dfs-217"><span class="linenos">217</span></a>        <span class="k">if</span> <span class="n">normalize_measures</span><span class="p">:</span>
</span><span id="get_varying_parameter_dfs-218"><a href="#get_varying_parameter_dfs-218"><span class="linenos">218</span></a>            <span class="n">min_value</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">measure_name</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
</span><span id="get_varying_parameter_dfs-219"><a href="#get_varying_parameter_dfs-219"><span class="linenos">219</span></a>            <span class="n">max_value</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">measure_name</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</span><span id="get_varying_parameter_dfs-220"><a href="#get_varying_parameter_dfs-220"><span class="linenos">220</span></a>            <span class="k">if</span> <span class="n">max_value</span> <span class="o">&gt;</span> <span class="n">min_value</span> <span class="o">+</span> <span class="mf">1e-4</span><span class="p">:</span>
</span><span id="get_varying_parameter_dfs-221"><a href="#get_varying_parameter_dfs-221"><span class="linenos">221</span></a>                <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">measure_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">measure_name</span><span class="p">]</span> <span class="o">-</span> <span class="n">min_value</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span>
</span><span id="get_varying_parameter_dfs-222"><a href="#get_varying_parameter_dfs-222"><span class="linenos">222</span></a>                    <span class="n">max_value</span> <span class="o">-</span> <span class="n">min_value</span>
</span><span id="get_varying_parameter_dfs-223"><a href="#get_varying_parameter_dfs-223"><span class="linenos">223</span></a>                <span class="p">)</span>
</span><span id="get_varying_parameter_dfs-224"><a href="#get_varying_parameter_dfs-224"><span class="linenos">224</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="get_varying_parameter_dfs-225"><a href="#get_varying_parameter_dfs-225"><span class="linenos">225</span></a>                <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">measure_name</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span>
</span><span id="get_varying_parameter_dfs-226"><a href="#get_varying_parameter_dfs-226"><span class="linenos">226</span></a>
</span><span id="get_varying_parameter_dfs-227"><a href="#get_varying_parameter_dfs-227"><span class="linenos">227</span></a>        <span class="c1"># Clean the varying parameter name</span>
</span><span id="get_varying_parameter_dfs-228"><a href="#get_varying_parameter_dfs-228"><span class="linenos">228</span></a>        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Varying value&quot;</span><span class="p">:</span> <span class="n">hap</span><span class="o">.</span><span class="n">clean_varying_prm_name</span><span class="p">})</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span>
</span><span id="get_varying_parameter_dfs-229"><a href="#get_varying_parameter_dfs-229"><span class="linenos">229</span></a>            <span class="n">hap</span><span class="o">.</span><span class="n">clean_varying_prm_name</span>
</span><span id="get_varying_parameter_dfs-230"><a href="#get_varying_parameter_dfs-230"><span class="linenos">230</span></a>        <span class="p">)</span>
</span><span id="get_varying_parameter_dfs-231"><a href="#get_varying_parameter_dfs-231"><span class="linenos">231</span></a>
</span><span id="get_varying_parameter_dfs-232"><a href="#get_varying_parameter_dfs-232"><span class="linenos">232</span></a>        <span class="n">measure_results</span><span class="p">[</span><span class="n">measure_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span>
</span><span id="get_varying_parameter_dfs-233"><a href="#get_varying_parameter_dfs-233"><span class="linenos">233</span></a>
</span><span id="get_varying_parameter_dfs-234"><a href="#get_varying_parameter_dfs-234"><span class="linenos">234</span></a>    <span class="k">return</span> <span class="n">measure_results</span>
</span></pre></div>


            <div class="docstring"><p>computes the hardness measures for the scenarios and stored them in a <code>pd.DataFrame</code>s.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>hap</strong> (HardnessAnalysisParams):
The hardness analysis scenario to run.</li>
<li><strong>normalize_measures</strong> (bool):
If True, the values of the hardness measures are normalized.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>Dict[str, pd.DataFrame]</strong>: A dictionary that associated the name of a hardness measure to its corresponding pd.DataFrame.</li>
</ul>
</div>


                </section>
                <section id="compute_hardness_measure_for_varying_prm">
                            <input id="compute_hardness_measure_for_varying_prm-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">compute_hardness_measure_for_varying_prm</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">mdp_class</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n"><a href="../mdp/base.html#BaseMDP">colosseum.mdp.base.BaseMDP</a></span><span class="p">]</span>,</span><span class="param">	<span class="n">fixed_params</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>,</span><span class="param">	<span class="n">varying_params_name</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">varying_value</span><span class="p">:</span> <span class="n">Any</span>,</span><span class="param">	<span class="n">seed</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">measure</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">[[</span><span class="n"><a href="../mdp/base.html#BaseMDP">colosseum.mdp.base.BaseMDP</a></span><span class="p">],</span> <span class="nb">float</span><span class="p">]]</span>,</span><span class="param">	<span class="n">force_single_core</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">retrieve_from_cache</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="n">folder</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">return_n_states</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span><span class="return-annotation">) -> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="compute_hardness_measure_for_varying_prm-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#compute_hardness_measure_for_varying_prm"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="compute_hardness_measure_for_varying_prm-260"><a href="#compute_hardness_measure_for_varying_prm-260"><span class="linenos">260</span></a><span class="k">def</span> <span class="nf">compute_hardness_measure_for_varying_prm</span><span class="p">(</span>
</span><span id="compute_hardness_measure_for_varying_prm-261"><a href="#compute_hardness_measure_for_varying_prm-261"><span class="linenos">261</span></a>    <span class="n">mdp_class</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="s2">&quot;BaseMDP&quot;</span><span class="p">],</span>
</span><span id="compute_hardness_measure_for_varying_prm-262"><a href="#compute_hardness_measure_for_varying_prm-262"><span class="linenos">262</span></a>    <span class="n">fixed_params</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
</span><span id="compute_hardness_measure_for_varying_prm-263"><a href="#compute_hardness_measure_for_varying_prm-263"><span class="linenos">263</span></a>    <span class="n">varying_params_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="compute_hardness_measure_for_varying_prm-264"><a href="#compute_hardness_measure_for_varying_prm-264"><span class="linenos">264</span></a>    <span class="n">varying_value</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
</span><span id="compute_hardness_measure_for_varying_prm-265"><a href="#compute_hardness_measure_for_varying_prm-265"><span class="linenos">265</span></a>    <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="compute_hardness_measure_for_varying_prm-266"><a href="#compute_hardness_measure_for_varying_prm-266"><span class="linenos">266</span></a>    <span class="n">measure</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">BaseMDP</span><span class="p">],</span> <span class="nb">float</span><span class="p">]],</span>
</span><span id="compute_hardness_measure_for_varying_prm-267"><a href="#compute_hardness_measure_for_varying_prm-267"><span class="linenos">267</span></a>    <span class="n">force_single_core</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="compute_hardness_measure_for_varying_prm-268"><a href="#compute_hardness_measure_for_varying_prm-268"><span class="linenos">268</span></a>    <span class="n">retrieve_from_cache</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="compute_hardness_measure_for_varying_prm-269"><a href="#compute_hardness_measure_for_varying_prm-269"><span class="linenos">269</span></a>    <span class="n">folder</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="compute_hardness_measure_for_varying_prm-270"><a href="#compute_hardness_measure_for_varying_prm-270"><span class="linenos">270</span></a>    <span class="n">return_n_states</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="compute_hardness_measure_for_varying_prm-271"><a href="#compute_hardness_measure_for_varying_prm-271"><span class="linenos">271</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
</span><span id="compute_hardness_measure_for_varying_prm-272"><a href="#compute_hardness_measure_for_varying_prm-272"><span class="linenos">272</span></a>    <span class="sd">&quot;&quot;&quot;</span>
</span><span id="compute_hardness_measure_for_varying_prm-273"><a href="#compute_hardness_measure_for_varying_prm-273"><span class="linenos">273</span></a><span class="sd">    computes the hardness measure for varying values of the parameter.</span>
</span><span id="compute_hardness_measure_for_varying_prm-274"><a href="#compute_hardness_measure_for_varying_prm-274"><span class="linenos">274</span></a>
</span><span id="compute_hardness_measure_for_varying_prm-275"><a href="#compute_hardness_measure_for_varying_prm-275"><span class="linenos">275</span></a><span class="sd">    Parameters</span>
</span><span id="compute_hardness_measure_for_varying_prm-276"><a href="#compute_hardness_measure_for_varying_prm-276"><span class="linenos">276</span></a><span class="sd">    ----------</span>
</span><span id="compute_hardness_measure_for_varying_prm-277"><a href="#compute_hardness_measure_for_varying_prm-277"><span class="linenos">277</span></a><span class="sd">    mdp_class : Type[&quot;BaseMDP&quot;]</span>
</span><span id="compute_hardness_measure_for_varying_prm-278"><a href="#compute_hardness_measure_for_varying_prm-278"><span class="linenos">278</span></a><span class="sd">        The MDP class for which the measures will be computed.</span>
</span><span id="compute_hardness_measure_for_varying_prm-279"><a href="#compute_hardness_measure_for_varying_prm-279"><span class="linenos">279</span></a><span class="sd">    fixed_params : Dict[str, Any]</span>
</span><span id="compute_hardness_measure_for_varying_prm-280"><a href="#compute_hardness_measure_for_varying_prm-280"><span class="linenos">280</span></a><span class="sd">        The parameters of the MDP that are being kept fixed.</span>
</span><span id="compute_hardness_measure_for_varying_prm-281"><a href="#compute_hardness_measure_for_varying_prm-281"><span class="linenos">281</span></a><span class="sd">    varying_params_name : str</span>
</span><span id="compute_hardness_measure_for_varying_prm-282"><a href="#compute_hardness_measure_for_varying_prm-282"><span class="linenos">282</span></a><span class="sd">        The name of the varying parameter.</span>
</span><span id="compute_hardness_measure_for_varying_prm-283"><a href="#compute_hardness_measure_for_varying_prm-283"><span class="linenos">283</span></a><span class="sd">    varying_value : Any</span>
</span><span id="compute_hardness_measure_for_varying_prm-284"><a href="#compute_hardness_measure_for_varying_prm-284"><span class="linenos">284</span></a><span class="sd">        The value of the parameter that is varying.</span>
</span><span id="compute_hardness_measure_for_varying_prm-285"><a href="#compute_hardness_measure_for_varying_prm-285"><span class="linenos">285</span></a><span class="sd">    seed : int</span>
</span><span id="compute_hardness_measure_for_varying_prm-286"><a href="#compute_hardness_measure_for_varying_prm-286"><span class="linenos">286</span></a><span class="sd">        The random seed.</span>
</span><span id="compute_hardness_measure_for_varying_prm-287"><a href="#compute_hardness_measure_for_varying_prm-287"><span class="linenos">287</span></a><span class="sd">    measure : Union[str, Callable[[BaseMDP], float]]</span>
</span><span id="compute_hardness_measure_for_varying_prm-288"><a href="#compute_hardness_measure_for_varying_prm-288"><span class="linenos">288</span></a><span class="sd">        The measure to be computed. It can be given as a function from MDP instances to float or as a string. If given</span>
</span><span id="compute_hardness_measure_for_varying_prm-289"><a href="#compute_hardness_measure_for_varying_prm-289"><span class="linenos">289</span></a><span class="sd">        as a string, it will be looked for in the ones available in the package</span>
</span><span id="compute_hardness_measure_for_varying_prm-290"><a href="#compute_hardness_measure_for_varying_prm-290"><span class="linenos">290</span></a><span class="sd">    force_single_core : bool</span>
</span><span id="compute_hardness_measure_for_varying_prm-291"><a href="#compute_hardness_measure_for_varying_prm-291"><span class="linenos">291</span></a><span class="sd">        If True, the computation of the measure is forced to use only a single core. Note that this is not enforced when</span>
</span><span id="compute_hardness_measure_for_varying_prm-292"><a href="#compute_hardness_measure_for_varying_prm-292"><span class="linenos">292</span></a><span class="sd">        the measure is given as a function. By default, single processing is not enforced.</span>
</span><span id="compute_hardness_measure_for_varying_prm-293"><a href="#compute_hardness_measure_for_varying_prm-293"><span class="linenos">293</span></a><span class="sd">    retrieve_from_cache : bool</span>
</span><span id="compute_hardness_measure_for_varying_prm-294"><a href="#compute_hardness_measure_for_varying_prm-294"><span class="linenos">294</span></a><span class="sd">        If True, the function will look for cached values of the measure. Note that this also hold if the measure is</span>
</span><span id="compute_hardness_measure_for_varying_prm-295"><a href="#compute_hardness_measure_for_varying_prm-295"><span class="linenos">295</span></a><span class="sd">        given as a function.</span>
</span><span id="compute_hardness_measure_for_varying_prm-296"><a href="#compute_hardness_measure_for_varying_prm-296"><span class="linenos">296</span></a><span class="sd">    folder : str</span>
</span><span id="compute_hardness_measure_for_varying_prm-297"><a href="#compute_hardness_measure_for_varying_prm-297"><span class="linenos">297</span></a><span class="sd">        The folder where cached values are looked for. By default, it is the `config.get_hardness_measures_cache_folder()`.</span>
</span><span id="compute_hardness_measure_for_varying_prm-298"><a href="#compute_hardness_measure_for_varying_prm-298"><span class="linenos">298</span></a><span class="sd">    return_n_states : bool</span>
</span><span id="compute_hardness_measure_for_varying_prm-299"><a href="#compute_hardness_measure_for_varying_prm-299"><span class="linenos">299</span></a><span class="sd">        If True, the number of states is returned.</span>
</span><span id="compute_hardness_measure_for_varying_prm-300"><a href="#compute_hardness_measure_for_varying_prm-300"><span class="linenos">300</span></a>
</span><span id="compute_hardness_measure_for_varying_prm-301"><a href="#compute_hardness_measure_for_varying_prm-301"><span class="linenos">301</span></a><span class="sd">    Returns</span>
</span><span id="compute_hardness_measure_for_varying_prm-302"><a href="#compute_hardness_measure_for_varying_prm-302"><span class="linenos">302</span></a><span class="sd">    -------</span>
</span><span id="compute_hardness_measure_for_varying_prm-303"><a href="#compute_hardness_measure_for_varying_prm-303"><span class="linenos">303</span></a><span class="sd">    str</span>
</span><span id="compute_hardness_measure_for_varying_prm-304"><a href="#compute_hardness_measure_for_varying_prm-304"><span class="linenos">304</span></a><span class="sd">        The nicely formatted name of the measure.</span>
</span><span id="compute_hardness_measure_for_varying_prm-305"><a href="#compute_hardness_measure_for_varying_prm-305"><span class="linenos">305</span></a><span class="sd">    float</span>
</span><span id="compute_hardness_measure_for_varying_prm-306"><a href="#compute_hardness_measure_for_varying_prm-306"><span class="linenos">306</span></a><span class="sd">        The value of the measure.</span>
</span><span id="compute_hardness_measure_for_varying_prm-307"><a href="#compute_hardness_measure_for_varying_prm-307"><span class="linenos">307</span></a><span class="sd">    int, optional</span>
</span><span id="compute_hardness_measure_for_varying_prm-308"><a href="#compute_hardness_measure_for_varying_prm-308"><span class="linenos">308</span></a><span class="sd">        The number of states.</span>
</span><span id="compute_hardness_measure_for_varying_prm-309"><a href="#compute_hardness_measure_for_varying_prm-309"><span class="linenos">309</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="compute_hardness_measure_for_varying_prm-310"><a href="#compute_hardness_measure_for_varying_prm-310"><span class="linenos">310</span></a>
</span><span id="compute_hardness_measure_for_varying_prm-311"><a href="#compute_hardness_measure_for_varying_prm-311"><span class="linenos">311</span></a>    <span class="c1"># Instantiate the MDP parameters</span>
</span><span id="compute_hardness_measure_for_varying_prm-312"><a href="#compute_hardness_measure_for_varying_prm-312"><span class="linenos">312</span></a>    <span class="n">mdp_kwargs</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">fixed_params</span><span class="p">)</span>
</span><span id="compute_hardness_measure_for_varying_prm-313"><a href="#compute_hardness_measure_for_varying_prm-313"><span class="linenos">313</span></a>    <span class="n">mdp_kwargs</span><span class="p">[</span><span class="s2">&quot;seed&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">seed</span>
</span><span id="compute_hardness_measure_for_varying_prm-314"><a href="#compute_hardness_measure_for_varying_prm-314"><span class="linenos">314</span></a>    <span class="n">mdp_kwargs</span><span class="p">[</span><span class="n">varying_params_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">varying_value</span>
</span><span id="compute_hardness_measure_for_varying_prm-315"><a href="#compute_hardness_measure_for_varying_prm-315"><span class="linenos">315</span></a>
</span><span id="compute_hardness_measure_for_varying_prm-316"><a href="#compute_hardness_measure_for_varying_prm-316"><span class="linenos">316</span></a>    <span class="k">return</span> <span class="n">compute_hardness_measure</span><span class="p">(</span>
</span><span id="compute_hardness_measure_for_varying_prm-317"><a href="#compute_hardness_measure_for_varying_prm-317"><span class="linenos">317</span></a>        <span class="n">mdp_class</span><span class="p">,</span>
</span><span id="compute_hardness_measure_for_varying_prm-318"><a href="#compute_hardness_measure_for_varying_prm-318"><span class="linenos">318</span></a>        <span class="n">mdp_kwargs</span><span class="p">,</span>
</span><span id="compute_hardness_measure_for_varying_prm-319"><a href="#compute_hardness_measure_for_varying_prm-319"><span class="linenos">319</span></a>        <span class="n">measure</span><span class="p">,</span>
</span><span id="compute_hardness_measure_for_varying_prm-320"><a href="#compute_hardness_measure_for_varying_prm-320"><span class="linenos">320</span></a>        <span class="n">force_single_core</span><span class="p">,</span>
</span><span id="compute_hardness_measure_for_varying_prm-321"><a href="#compute_hardness_measure_for_varying_prm-321"><span class="linenos">321</span></a>        <span class="n">retrieve_from_cache</span><span class="p">,</span>
</span><span id="compute_hardness_measure_for_varying_prm-322"><a href="#compute_hardness_measure_for_varying_prm-322"><span class="linenos">322</span></a>        <span class="n">folder</span><span class="p">,</span>
</span><span id="compute_hardness_measure_for_varying_prm-323"><a href="#compute_hardness_measure_for_varying_prm-323"><span class="linenos">323</span></a>        <span class="kc">True</span><span class="p">,</span>
</span><span id="compute_hardness_measure_for_varying_prm-324"><a href="#compute_hardness_measure_for_varying_prm-324"><span class="linenos">324</span></a>        <span class="n">return_n_states</span><span class="p">,</span>
</span><span id="compute_hardness_measure_for_varying_prm-325"><a href="#compute_hardness_measure_for_varying_prm-325"><span class="linenos">325</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>computes the hardness measure for varying values of the parameter.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>mdp_class</strong> (Type["BaseMDP"]):
The MDP class for which the measures will be computed.</li>
<li><strong>fixed_params</strong> (Dict[str, Any]):
The parameters of the MDP that are being kept fixed.</li>
<li><strong>varying_params_name</strong> (str):
The name of the varying parameter.</li>
<li><strong>varying_value</strong> (Any):
The value of the parameter that is varying.</li>
<li><strong>seed</strong> (int):
The random seed.</li>
<li><strong>measure</strong> (Union[str, Callable[[BaseMDP], float]]):
The measure to be computed. It can be given as a function from MDP instances to float or as a string. If given
as a string, it will be looked for in the ones available in the package</li>
<li><strong>force_single_core</strong> (bool):
If True, the computation of the measure is forced to use only a single core. Note that this is not enforced when
the measure is given as a function. By default, single processing is not enforced.</li>
<li><strong>retrieve_from_cache</strong> (bool):
If True, the function will look for cached values of the measure. Note that this also hold if the measure is
given as a function.</li>
<li><strong>folder</strong> (str):
The folder where cached values are looked for. By default, it is the <code>config.get_hardness_measures_cache_folder()</code>.</li>
<li><strong>return_n_states</strong> (bool):
If True, the number of states is returned.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>str</strong>: The nicely formatted name of the measure.</li>
<li><strong>float</strong>: The value of the measure.</li>
<li><strong>int, optional</strong>: The number of states.</li>
</ul>
</div>


                </section>
                <section id="compute_hardness_measure">
                            <input id="compute_hardness_measure-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">compute_hardness_measure</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">mdp_class</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n"><a href="../mdp/base.html#BaseMDP">colosseum.mdp.base.BaseMDP</a></span><span class="p">]</span>,</span><span class="param">	<span class="n">mdp_params</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>,</span><span class="param">	<span class="n">measure</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">[[</span><span class="n"><a href="../mdp/base.html#BaseMDP">colosseum.mdp.base.BaseMDP</a></span><span class="p">],</span> <span class="nb">float</span><span class="p">]]</span>,</span><span class="param">	<span class="n">force_single_core</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">retrieve_from_cache</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="n">folder</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">return_measure_name</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">return_n_states</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span><span class="return-annotation">) -> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="compute_hardness_measure-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#compute_hardness_measure"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="compute_hardness_measure-328"><a href="#compute_hardness_measure-328"><span class="linenos">328</span></a><span class="k">def</span> <span class="nf">compute_hardness_measure</span><span class="p">(</span>
</span><span id="compute_hardness_measure-329"><a href="#compute_hardness_measure-329"><span class="linenos">329</span></a>    <span class="n">mdp_class</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="s2">&quot;BaseMDP&quot;</span><span class="p">],</span>
</span><span id="compute_hardness_measure-330"><a href="#compute_hardness_measure-330"><span class="linenos">330</span></a>    <span class="n">mdp_params</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
</span><span id="compute_hardness_measure-331"><a href="#compute_hardness_measure-331"><span class="linenos">331</span></a>    <span class="n">measure</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">BaseMDP</span><span class="p">],</span> <span class="nb">float</span><span class="p">]],</span>
</span><span id="compute_hardness_measure-332"><a href="#compute_hardness_measure-332"><span class="linenos">332</span></a>    <span class="n">force_single_core</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="compute_hardness_measure-333"><a href="#compute_hardness_measure-333"><span class="linenos">333</span></a>    <span class="n">retrieve_from_cache</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="compute_hardness_measure-334"><a href="#compute_hardness_measure-334"><span class="linenos">334</span></a>    <span class="n">folder</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="compute_hardness_measure-335"><a href="#compute_hardness_measure-335"><span class="linenos">335</span></a>    <span class="n">return_measure_name</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="compute_hardness_measure-336"><a href="#compute_hardness_measure-336"><span class="linenos">336</span></a>    <span class="n">return_n_states</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="compute_hardness_measure-337"><a href="#compute_hardness_measure-337"><span class="linenos">337</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]:</span>
</span><span id="compute_hardness_measure-338"><a href="#compute_hardness_measure-338"><span class="linenos">338</span></a>    <span class="sd">&quot;&quot;&quot;</span>
</span><span id="compute_hardness_measure-339"><a href="#compute_hardness_measure-339"><span class="linenos">339</span></a>
</span><span id="compute_hardness_measure-340"><a href="#compute_hardness_measure-340"><span class="linenos">340</span></a><span class="sd">    Parameters</span>
</span><span id="compute_hardness_measure-341"><a href="#compute_hardness_measure-341"><span class="linenos">341</span></a><span class="sd">    ----------</span>
</span><span id="compute_hardness_measure-342"><a href="#compute_hardness_measure-342"><span class="linenos">342</span></a><span class="sd">    mdp_class : Type[&quot;BaseMDP&quot;]</span>
</span><span id="compute_hardness_measure-343"><a href="#compute_hardness_measure-343"><span class="linenos">343</span></a><span class="sd">        The MDP class for which the measures will be computed.</span>
</span><span id="compute_hardness_measure-344"><a href="#compute_hardness_measure-344"><span class="linenos">344</span></a><span class="sd">    mdp_params : Dict[str, Any]</span>
</span><span id="compute_hardness_measure-345"><a href="#compute_hardness_measure-345"><span class="linenos">345</span></a><span class="sd">        The parameters for the MDP.</span>
</span><span id="compute_hardness_measure-346"><a href="#compute_hardness_measure-346"><span class="linenos">346</span></a><span class="sd">    measure : Union[str, Callable[[BaseMDP], float]]</span>
</span><span id="compute_hardness_measure-347"><a href="#compute_hardness_measure-347"><span class="linenos">347</span></a><span class="sd">        The measure to be computed. It can be given as a function from MDP instances to float or as a string. If given</span>
</span><span id="compute_hardness_measure-348"><a href="#compute_hardness_measure-348"><span class="linenos">348</span></a><span class="sd">        as a string, it will be looked for in the ones available in the package</span>
</span><span id="compute_hardness_measure-349"><a href="#compute_hardness_measure-349"><span class="linenos">349</span></a><span class="sd">    force_single_core : bool</span>
</span><span id="compute_hardness_measure-350"><a href="#compute_hardness_measure-350"><span class="linenos">350</span></a><span class="sd">        If True, the computation of the measure is forced to use only a single core. Note that this is not enforced when</span>
</span><span id="compute_hardness_measure-351"><a href="#compute_hardness_measure-351"><span class="linenos">351</span></a><span class="sd">        the measure is given as a function. By default, single processing is not enforced.</span>
</span><span id="compute_hardness_measure-352"><a href="#compute_hardness_measure-352"><span class="linenos">352</span></a><span class="sd">    retrieve_from_cache : bool</span>
</span><span id="compute_hardness_measure-353"><a href="#compute_hardness_measure-353"><span class="linenos">353</span></a><span class="sd">        If True, the function will look for cached values of the measure. Note that this also hold if the measure is</span>
</span><span id="compute_hardness_measure-354"><a href="#compute_hardness_measure-354"><span class="linenos">354</span></a><span class="sd">        given as a function.</span>
</span><span id="compute_hardness_measure-355"><a href="#compute_hardness_measure-355"><span class="linenos">355</span></a><span class="sd">    folder : str</span>
</span><span id="compute_hardness_measure-356"><a href="#compute_hardness_measure-356"><span class="linenos">356</span></a><span class="sd">        The folder where cached values are looked for. By default, it is the `config.get_hardness_measures_cache_folder()`.</span>
</span><span id="compute_hardness_measure-357"><a href="#compute_hardness_measure-357"><span class="linenos">357</span></a><span class="sd">    return_measure_name : bool</span>
</span><span id="compute_hardness_measure-358"><a href="#compute_hardness_measure-358"><span class="linenos">358</span></a><span class="sd">        If True, a nicely formatted name for the measure is returned.</span>
</span><span id="compute_hardness_measure-359"><a href="#compute_hardness_measure-359"><span class="linenos">359</span></a><span class="sd">    return_n_states : bool</span>
</span><span id="compute_hardness_measure-360"><a href="#compute_hardness_measure-360"><span class="linenos">360</span></a><span class="sd">        If True, the number of states is returned.</span>
</span><span id="compute_hardness_measure-361"><a href="#compute_hardness_measure-361"><span class="linenos">361</span></a>
</span><span id="compute_hardness_measure-362"><a href="#compute_hardness_measure-362"><span class="linenos">362</span></a><span class="sd">    Returns</span>
</span><span id="compute_hardness_measure-363"><a href="#compute_hardness_measure-363"><span class="linenos">363</span></a><span class="sd">    -------</span>
</span><span id="compute_hardness_measure-364"><a href="#compute_hardness_measure-364"><span class="linenos">364</span></a><span class="sd">    str, optional</span>
</span><span id="compute_hardness_measure-365"><a href="#compute_hardness_measure-365"><span class="linenos">365</span></a><span class="sd">        The nicely formatted name of the measure.</span>
</span><span id="compute_hardness_measure-366"><a href="#compute_hardness_measure-366"><span class="linenos">366</span></a><span class="sd">    float</span>
</span><span id="compute_hardness_measure-367"><a href="#compute_hardness_measure-367"><span class="linenos">367</span></a><span class="sd">        The value of the measure.</span>
</span><span id="compute_hardness_measure-368"><a href="#compute_hardness_measure-368"><span class="linenos">368</span></a><span class="sd">    int, optional</span>
</span><span id="compute_hardness_measure-369"><a href="#compute_hardness_measure-369"><span class="linenos">369</span></a><span class="sd">        The number of states.</span>
</span><span id="compute_hardness_measure-370"><a href="#compute_hardness_measure-370"><span class="linenos">370</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="compute_hardness_measure-371"><a href="#compute_hardness_measure-371"><span class="linenos">371</span></a>
</span><span id="compute_hardness_measure-372"><a href="#compute_hardness_measure-372"><span class="linenos">372</span></a>    <span class="c1"># Obtain the name of the measure and the function to compute it</span>
</span><span id="compute_hardness_measure-373"><a href="#compute_hardness_measure-373"><span class="linenos">373</span></a>    <span class="n">measure_name</span><span class="p">,</span> <span class="n">measure_f</span> <span class="o">=</span> <span class="n">_process_measure</span><span class="p">(</span><span class="n">measure</span><span class="p">)</span>
</span><span id="compute_hardness_measure-374"><a href="#compute_hardness_measure-374"><span class="linenos">374</span></a>
</span><span id="compute_hardness_measure-375"><a href="#compute_hardness_measure-375"><span class="linenos">375</span></a>    <span class="c1"># Check if the measure has already been computed</span>
</span><span id="compute_hardness_measure-376"><a href="#compute_hardness_measure-376"><span class="linenos">376</span></a>    <span class="k">if</span> <span class="n">retrieve_from_cache</span><span class="p">:</span>
</span><span id="compute_hardness_measure-377"><a href="#compute_hardness_measure-377"><span class="linenos">377</span></a>        <span class="n">mdp_shell</span> <span class="o">=</span> <span class="n">mdp_class</span><span class="p">(</span>
</span><span id="compute_hardness_measure-378"><a href="#compute_hardness_measure-378"><span class="linenos">378</span></a>            <span class="o">**</span><span class="n">mdp_params</span><span class="p">,</span> <span class="n">instantiate_mdp</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">exclude_horizon_from_parameters</span><span class="o">=</span><span class="kc">True</span>
</span><span id="compute_hardness_measure-379"><a href="#compute_hardness_measure-379"><span class="linenos">379</span></a>        <span class="p">)</span>
</span><span id="compute_hardness_measure-380"><a href="#compute_hardness_measure-380"><span class="linenos">380</span></a>        <span class="k">if</span> <span class="n">folder</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="compute_hardness_measure-381"><a href="#compute_hardness_measure-381"><span class="linenos">381</span></a>            <span class="n">folder</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="compute_hardness_measure-382"><a href="#compute_hardness_measure-382"><span class="linenos">382</span></a>                <span class="n">config</span><span class="o">.</span><span class="n">get_hardness_measures_cache_folder</span><span class="p">()</span>
</span><span id="compute_hardness_measure-383"><a href="#compute_hardness_measure-383"><span class="linenos">383</span></a>                <span class="o">+</span> <span class="n">mdp_class</span><span class="o">.</span><span class="vm">__name__</span>
</span><span id="compute_hardness_measure-384"><a href="#compute_hardness_measure-384"><span class="linenos">384</span></a>                <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span>
</span><span id="compute_hardness_measure-385"><a href="#compute_hardness_measure-385"><span class="linenos">385</span></a>            <span class="p">)</span>
</span><span id="compute_hardness_measure-386"><a href="#compute_hardness_measure-386"><span class="linenos">386</span></a>
</span><span id="compute_hardness_measure-387"><a href="#compute_hardness_measure-387"><span class="linenos">387</span></a>        <span class="n">measure_file_path</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">folder</span><span class="si">}{</span><span class="n">measure_name</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">mdp_shell</span><span class="o">.</span><span class="n">hash</span><span class="si">}</span><span class="s2">.txt&quot;</span>
</span><span id="compute_hardness_measure-388"><a href="#compute_hardness_measure-388"><span class="linenos">388</span></a>        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">measure_file_path</span><span class="p">):</span>
</span><span id="compute_hardness_measure-389"><a href="#compute_hardness_measure-389"><span class="linenos">389</span></a>            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">measure_file_path</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="compute_hardness_measure-390"><a href="#compute_hardness_measure-390"><span class="linenos">390</span></a>                <span class="n">measure_value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
</span><span id="compute_hardness_measure-391"><a href="#compute_hardness_measure-391"><span class="linenos">391</span></a>
</span><span id="compute_hardness_measure-392"><a href="#compute_hardness_measure-392"><span class="linenos">392</span></a>            <span class="n">out</span> <span class="o">=</span> <span class="p">[</span><span class="n">measure_value</span><span class="p">]</span>
</span><span id="compute_hardness_measure-393"><a href="#compute_hardness_measure-393"><span class="linenos">393</span></a>            <span class="k">if</span> <span class="n">return_measure_name</span><span class="p">:</span>
</span><span id="compute_hardness_measure-394"><a href="#compute_hardness_measure-394"><span class="linenos">394</span></a>                <span class="n">out</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">measure_name</span><span class="p">)</span>
</span><span id="compute_hardness_measure-395"><a href="#compute_hardness_measure-395"><span class="linenos">395</span></a>            <span class="k">if</span> <span class="n">return_n_states</span><span class="p">:</span>
</span><span id="compute_hardness_measure-396"><a href="#compute_hardness_measure-396"><span class="linenos">396</span></a>                <span class="n">mdp_shell</span><span class="o">.</span><span class="n">instantiate_MDP</span><span class="p">()</span>
</span><span id="compute_hardness_measure-397"><a href="#compute_hardness_measure-397"><span class="linenos">397</span></a>                <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mdp_shell</span><span class="o">.</span><span class="n">n_states</span><span class="p">)</span>
</span><span id="compute_hardness_measure-398"><a href="#compute_hardness_measure-398"><span class="linenos">398</span></a>            <span class="k">return</span> <span class="n">out</span>
</span><span id="compute_hardness_measure-399"><a href="#compute_hardness_measure-399"><span class="linenos">399</span></a>
</span><span id="compute_hardness_measure-400"><a href="#compute_hardness_measure-400"><span class="linenos">400</span></a>    <span class="c1"># Possible forcing the computation to avoid using multiple cores</span>
</span><span id="compute_hardness_measure-401"><a href="#compute_hardness_measure-401"><span class="linenos">401</span></a>    <span class="k">if</span> <span class="n">force_single_core</span> <span class="ow">and</span> <span class="n">config</span><span class="o">.</span><span class="n">get_available_cores</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="compute_hardness_measure-402"><a href="#compute_hardness_measure-402"><span class="linenos">402</span></a>        <span class="n">available_cores</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get_available_cores</span><span class="p">()</span>
</span><span id="compute_hardness_measure-403"><a href="#compute_hardness_measure-403"><span class="linenos">403</span></a>        <span class="n">config</span><span class="o">.</span><span class="n">disable_multiprocessing</span><span class="p">()</span>
</span><span id="compute_hardness_measure-404"><a href="#compute_hardness_measure-404"><span class="linenos">404</span></a>        <span class="n">mdp</span> <span class="o">=</span> <span class="n">mdp_class</span><span class="p">(</span><span class="o">**</span><span class="n">mdp_params</span><span class="p">)</span>
</span><span id="compute_hardness_measure-405"><a href="#compute_hardness_measure-405"><span class="linenos">405</span></a>        <span class="n">measure_value</span> <span class="o">=</span> <span class="n">measure_f</span><span class="p">(</span><span class="n">mdp</span><span class="p">)</span>
</span><span id="compute_hardness_measure-406"><a href="#compute_hardness_measure-406"><span class="linenos">406</span></a>        <span class="n">config</span><span class="o">.</span><span class="n">set_available_cores</span><span class="p">(</span><span class="n">available_cores</span><span class="p">)</span>
</span><span id="compute_hardness_measure-407"><a href="#compute_hardness_measure-407"><span class="linenos">407</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="compute_hardness_measure-408"><a href="#compute_hardness_measure-408"><span class="linenos">408</span></a>        <span class="n">mdp</span> <span class="o">=</span> <span class="n">mdp_class</span><span class="p">(</span><span class="o">**</span><span class="n">mdp_params</span><span class="p">)</span>
</span><span id="compute_hardness_measure-409"><a href="#compute_hardness_measure-409"><span class="linenos">409</span></a>        <span class="n">measure_value</span> <span class="o">=</span> <span class="n">measure_f</span><span class="p">(</span><span class="n">mdp</span><span class="p">)</span>
</span><span id="compute_hardness_measure-410"><a href="#compute_hardness_measure-410"><span class="linenos">410</span></a>
</span><span id="compute_hardness_measure-411"><a href="#compute_hardness_measure-411"><span class="linenos">411</span></a>    <span class="c1"># Caching the value of the measure (only in case we were supposed to look for it in the first place)</span>
</span><span id="compute_hardness_measure-412"><a href="#compute_hardness_measure-412"><span class="linenos">412</span></a>    <span class="k">if</span> <span class="n">retrieve_from_cache</span><span class="p">:</span>
</span><span id="compute_hardness_measure-413"><a href="#compute_hardness_measure-413"><span class="linenos">413</span></a>        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">measure_file_path</span><span class="p">),</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="compute_hardness_measure-414"><a href="#compute_hardness_measure-414"><span class="linenos">414</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">measure_file_path</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="compute_hardness_measure-415"><a href="#compute_hardness_measure-415"><span class="linenos">415</span></a>            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">measure_value</span><span class="p">))</span>
</span><span id="compute_hardness_measure-416"><a href="#compute_hardness_measure-416"><span class="linenos">416</span></a>
</span><span id="compute_hardness_measure-417"><a href="#compute_hardness_measure-417"><span class="linenos">417</span></a>    <span class="n">out</span> <span class="o">=</span> <span class="p">[</span><span class="n">measure_value</span><span class="p">]</span>
</span><span id="compute_hardness_measure-418"><a href="#compute_hardness_measure-418"><span class="linenos">418</span></a>    <span class="k">if</span> <span class="n">return_measure_name</span><span class="p">:</span>
</span><span id="compute_hardness_measure-419"><a href="#compute_hardness_measure-419"><span class="linenos">419</span></a>        <span class="n">out</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">measure_name</span><span class="p">)</span>
</span><span id="compute_hardness_measure-420"><a href="#compute_hardness_measure-420"><span class="linenos">420</span></a>    <span class="k">if</span> <span class="n">return_n_states</span><span class="p">:</span>
</span><span id="compute_hardness_measure-421"><a href="#compute_hardness_measure-421"><span class="linenos">421</span></a>        <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mdp</span><span class="o">.</span><span class="n">n_states</span><span class="p">)</span>
</span><span id="compute_hardness_measure-422"><a href="#compute_hardness_measure-422"><span class="linenos">422</span></a>    <span class="k">return</span> <span class="n">out</span>
</span></pre></div>


            <div class="docstring"><h6 id="parameters">Parameters</h6>

<ul>
<li><strong>mdp_class</strong> (Type["BaseMDP"]):
The MDP class for which the measures will be computed.</li>
<li><strong>mdp_params</strong> (Dict[str, Any]):
The parameters for the MDP.</li>
<li><strong>measure</strong> (Union[str, Callable[[BaseMDP], float]]):
The measure to be computed. It can be given as a function from MDP instances to float or as a string. If given
as a string, it will be looked for in the ones available in the package</li>
<li><strong>force_single_core</strong> (bool):
If True, the computation of the measure is forced to use only a single core. Note that this is not enforced when
the measure is given as a function. By default, single processing is not enforced.</li>
<li><strong>retrieve_from_cache</strong> (bool):
If True, the function will look for cached values of the measure. Note that this also hold if the measure is
given as a function.</li>
<li><strong>folder</strong> (str):
The folder where cached values are looked for. By default, it is the <code>config.get_hardness_measures_cache_folder()</code>.</li>
<li><strong>return_measure_name</strong> (bool):
If True, a nicely formatted name for the measure is returned.</li>
<li><strong>return_n_states</strong> (bool):
If True, the number of states is returned.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>str, optional</strong>: The nicely formatted name of the measure.</li>
<li><strong>float</strong>: The value of the measure.</li>
<li><strong>int, optional</strong>: The number of states.</li>
</ul>
</div>


                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.type) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value">${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.type}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>